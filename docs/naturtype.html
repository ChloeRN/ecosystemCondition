<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 5 Nature types | Indicators for Ecosystem Condition in Norway</title>
<meta name="author" content="Anders L. Kolstad">
<meta name="description" content="On the application of the nature type dataset Data exploration and an analyses of thematic coverage Author: Anders L. Kolstad Date: 2023-03-07 Here I will investigate a specific data set,...">
<meta name="generator" content="bookdown 0.27 with bs4_book()">
<meta property="og:title" content="Chapter 5 Nature types | Indicators for Ecosystem Condition in Norway">
<meta property="og:type" content="book">
<meta property="og:url" content="https://ninanor.github.io/ecosystemCondition/index.html/naturtype.html">
<meta property="og:description" content="On the application of the nature type dataset Data exploration and an analyses of thematic coverage Author: Anders L. Kolstad Date: 2023-03-07 Here I will investigate a specific data set,...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 5 Nature types | Indicators for Ecosystem Condition in Norway">
<meta name="twitter:description" content="On the application of the nature type dataset Data exploration and an analyses of thematic coverage Author: Anders L. Kolstad Date: 2023-03-07 Here I will investigate a specific data set,...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.20/datatables.js"></script><link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Indicators for Ecosystem Condition in Norway</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">About </a></li>
<li><a class="" href="overview-of-indicators.html">Overview of indicators</a></li>
<li class="book-part">INDICATORS FROM THE ALPINE ASSESSMENT</li>
<li><a class="" href="areal-av-isbreer.html"><span class="header-section-number">1</span> Areal av isbreer</a></li>
<li class="book-part">INDICATORS</li>
<li><a class="" href="slitasje-og-kj%C3%B8respor.html"><span class="header-section-number">2</span> Slitasje og kjørespor</a></li>
<li><a class="" href="climate-indicators.html"><span class="header-section-number">3</span> Climate indicators</a></li>
<li class="book-part">DEPRECATED</li>
<li><a class="" href="areal-uten-d%C3%B8d-eller-skadet-r%C3%B8sslyng-i-kystlynghei.html"><span class="header-section-number">4</span> Areal uten død eller skadet røsslyng i kystlynghei</a></li>
<li class="book-part">GENERAL TOPICS</li>
<li><a class="active" href="naturtype.html"><span class="header-section-number">5</span> Nature types</a></li>
<li><a class="" href="scaling-functions.html"><span class="header-section-number">6</span> Scaling functions</a></li>
<li><a class="" href="homogeneous-impact-areas.html"><span class="header-section-number">7</span> Homogeneous Impact Areas</a></li>
<li><a class="" href="master-grid.html"><span class="header-section-number">8</span> Master grid</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/NINAnor/ecosystemCondition">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="naturtype" class="section level1" number="5">
<h1>
<span class="header-section-number">5</span> Nature types<a class="anchor" aria-label="anchor" href="#naturtype"><i class="fas fa-link"></i></a>
</h1>
<p><strong>On the application of the nature type dataset</strong></p>
<p><em>Data exploration and an analyses of thematic coverage</em></p>
<p><br></p>
<p>Author: Anders L. Kolstad</p>
<p>Date: 2023-03-07</p>
<p><br></p>
<p>Here I will investigate a specific data set, <a href="https://kartkatalog.geonorge.no/metadata/naturtyper-miljoedirektoratets-instruks/eb48dd19-03da-41e1-afd9-7ebc3079265c">Naturtyper - Miljødirektoratets instruks</a> and try to evaluate its usability for designing indicators for ecosystem condition. This involves assessing both the spatial and temporal representation, as well as conceptual alignment with the <a href="https://www.regjeringen.no/no/dokumenter/fagsystem-for-fastsetting-av-god-okologisk-tilstand/id2558481/">Norwegian system for ecosystem condition assessments</a>.</p>
<p>The precision in field mapping will not be assess in itself. We assume some, or even considerable, sampling error, but this is inherent to all field data.</p>
<p>The first part of this analysis is simply to get an overview of the data, making it ready for part 2 where we look at the thematic coverage of nature types and how the NiN variables are used.</p>
<div id="import-data-and-general-summary-statistics" class="section level2" number="5.1">
<h2>
<span class="header-section-number">5.1</span> Import data and general summary statistics<a class="anchor" aria-label="anchor" href="#import-data-and-general-summary-statistics"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb226"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># local path</span>
<span class="co">#path &lt;- "data/R:/GeoSpatialData/Habitats_biotopes/Norway_Miljodirektoratet_Naturtyper_nin/Original/Natur_Naturtyper_NiN_norge_med_svalbard_25833.gdb"</span>

<span class="co"># server path</span>
<span class="va">path</span> <span class="op">&lt;-</span> <span class="st">"/data/P-Prosjekter2/41201785_okologisk_tilstand_2022_2023/data/Natur_Naturtyper_NiN_norge_med_svalbard_25833.gdb"</span>

<span class="co"># temporary path </span>
<span class="co">#path &lt;- "/data/Egenutvikling/41001581_egenutvikling_anders_kolstad/data/Natur_Naturtyper_NiN_norge_med_svalbard_25833.g#db"</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span>dsn <span class="op">=</span> <span class="va">path</span><span class="op">)</span></code></pre></div>
<p>Fix non-valid polygons:</p>
<div class="sourceCode" id="cb227"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/valid.html">st_make_valid</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></code></pre></div>
<p>The dataset has 95k polygons, each with 36 variables:</p>
<div class="sourceCode" id="cb228"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>
<span class="co">#&gt; [1] 95469    36</span></code></pre></div>
<p>It therefore takes a little minute to render a plot, but this is the code to do it:</p>
<div class="sourceCode" id="cb229"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nor</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">read_sf</a></span><span class="op">(</span><span class="st">"data/outlineOfNorway_EPSG25833.shp"</span><span class="op">)</span>
<span class="fu">tmap_mode</span><span class="op">(</span><span class="st">"view"</span><span class="op">)</span>
<span class="fu">tm_shape</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">tm_polygons</span><span class="op">(</span>col<span class="op">=</span><span class="st">"tilstand"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">tm_shape</span><span class="op">(</span><span class="va">nor</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">tm_polygons</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0</span>,border.col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></code></pre></div>
</div>
<div id="area" class="section level2" number="5.2">
<h2>
<span class="header-section-number">5.2</span> Area<a class="anchor" aria-label="anchor" href="#area"><i class="fas fa-link"></i></a>
</h2>
<p>Calculating the area for each polygon/locality</p>
<div class="sourceCode" id="cb230"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span><span class="op">$</span><span class="va">area</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html">st_area</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">area</span><span class="op">)</span>
<span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="co">#&gt;      20     722    2891   17677    9026 8532702</span></code></pre></div>
<p>The smallest polygons are 20 m2, and the biggest is 8.5 km2.</p>
<p>The largest polygon is a</p>
<pre><code>#&gt; [1] "Boreal hei"</code></pre>
<p>The smallest polygon is a</p>
<pre><code>#&gt; [1] "Sørlig kaldkilde"</code></pre>
<p>Sum of mapped area divided by Norwegian mainland area:</p>
<div class="sourceCode" id="cb233"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Import outline of mainland Norway</span>
<span class="va">nor</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">read_sf</a></span><span class="op">(</span><span class="st">"data/outlineOfNorway_EPSG25833.shp"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">area</span><span class="op">)</span><span class="op">/</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html">st_area</a></span><span class="op">(</span><span class="va">nor</span><span class="op">)</span>
<span class="co">#&gt; 0.005181438 [1]</span></code></pre></div>
<p>About 0.5% of Norway has been mapped (note that a bigger area than this has been surveyed, but only a small fraction is delineated). It is therefore essential that these 0.5% are representative.</p>
</div>
<div id="temporal-trend" class="section level2" number="5.3">
<h2>
<span class="header-section-number">5.3</span> Temporal trend<a class="anchor" aria-label="anchor" href="#temporal-trend"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb234"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span><span class="op">$</span><span class="va">kartleggingsår</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">kartleggingsår</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb235"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">area_year</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">area</span>, <span class="va">dat</span><span class="op">$</span><span class="va">kartleggingsår</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">area_year</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"area"</span>
<span class="va">area_year</span><span class="op">$</span><span class="va">year</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">area_year</span><span class="op">)</span>
<span class="va">area_year</span><span class="op">$</span><span class="va">area_km2</span> <span class="op">&lt;-</span> <span class="va">area_year</span><span class="op">$</span><span class="va">area</span><span class="op">/</span><span class="fl">10</span><span class="op">^</span><span class="fl">6</span></code></pre></div>
<div class="sourceCode" id="cb236"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">area_year</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_bar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">area_km2</span><span class="op">)</span>,
           stat <span class="op">=</span> <span class="st">"identity"</span>,
           fill <span class="op">=</span> <span class="st">"grey"</span>,
           colour<span class="op">=</span><span class="st">"black"</span>,
           size <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Year"</span>, y <span class="op">=</span> <span class="st">"Total mapped area (km/2)"</span><span class="op">)</span>
<span class="co">#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2</span>
<span class="co">#&gt; 3.4.0.</span>
<span class="co">#&gt; ℹ Please use `linewidth` instead.</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-11"></span>
<img src="naturtype_files/figure-html/unnamed-chunk-11-1.png" alt="Temproal trend in nature type mapping using Miljødirektoratets Instruks" width="672"><p class="caption">
Figure 2.1: Temproal trend in nature type mapping using Miljødirektoratets Instruks
</p>
</div>
<p>The rate of nature type mapping is strongly positive last three years. There are some differences in the field mapping instructions between the years. I will need to decide whether to include all years, or to perhaps exclude the first year.</p>
</div>
<div id="condition" class="section level2" number="5.4">
<h2>
<span class="header-section-number">5.4</span> Condition<a class="anchor" aria-label="anchor" href="#condition"><i class="fas fa-link"></i></a>
</h2>
<p>A quick overview of the condition scores</p>
<div class="sourceCode" id="cb237"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">area</span><span class="op">/</span><span class="fl">10</span><span class="op">^</span><span class="fl">6</span>, <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">tilstand</span><span class="op">)</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-12"></span>
<img src="naturtype_files/figure-html/unnamed-chunk-12-1.png" alt="The overal distribution of condition scores" width="672"><p class="caption">
Figure 5.1: The overal distribution of condition scores
</p>
</div>
<p>Most sites/polygons are in either good or moderately good condition. I’m not sure what the first class represents. It seems like some polygons don’t have a condition score. Looking at just the data set, and also the online <em>faktaark</em> for some of these localities, does not give the answer:</p>
<div class="sourceCode" id="cb238"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/View.html">View</a></span><span class="op">(</span><span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">tilstand</span><span class="op">==</span><span class="st">""</span>,<span class="op">]</span><span class="op">)</span></code></pre></div>
<p>This figure show that these cases are not restricted to just one field season.</p>
<div class="sourceCode" id="cb239"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">kartleggingsår</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">tilstand</span><span class="op">==</span><span class="st">""</span><span class="op">]</span><span class="op">)</span>, 
        ylab<span class="op">=</span><span class="st">"Number of localities without condition scores"</span>,
        xlab<span class="op">=</span><span class="st">"Year"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-14"></span>
<img src="naturtype_files/figure-html/unnamed-chunk-14-1.png" alt="Temporal trend in localities without condition scores." width="672"><p class="caption">
Figure 5.2: Temporal trend in localities without condition scores.
</p>
</div>
<div class="sourceCode" id="cb240"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">20</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">hovedøkosystem</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">tilstand</span><span class="op">==</span><span class="st">""</span><span class="op">]</span><span class="op">)</span>,
        horiz <span class="op">=</span> <span class="cn">T</span>, las<span class="op">=</span><span class="fl">2</span>,
        xlab<span class="op">=</span><span class="st">"Number of localities without condition scores"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-15"></span>
<img src="naturtype_files/figure-html/unnamed-chunk-15-1.png" alt="Main ecosystems with localities missing condition scores." width="672"><p class="caption">
Figure 5.3: Main ecosystems with localities missing condition scores.
</p>
</div>
<p>These cases are restricted to two main ecosystems, and one class where the main ecosystem is not recorded. Looking at some of those cases it is clear that they are not relevant for our work here, I and I don’t know why they are in the data set to begin with.</p>
<div class="sourceCode" id="cb241"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">20</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">naturtype</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">tilstand</span><span class="op">==</span><span class="st">""</span><span class="op">]</span><span class="op">)</span>,
        horiz <span class="op">=</span> <span class="cn">T</span>, las<span class="op">=</span><span class="fl">2</span>,
        xlab<span class="op">=</span><span class="st">"Number of localities without condition scores"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-16"></span>
<img src="naturtype_files/figure-html/unnamed-chunk-16-1.png" alt="Nature types with localities missing condition scores." width="672"><p class="caption">
Figure 5.4: Nature types with localities missing condition scores.
</p>
</div>
<p>There are only six nature types (if you exclude those that are not mapped) that don’t have a condition score.</p>
<p><code>Snøleieblokkmark</code> and <code>rabbeblokkmark</code> do not have a protocol for assessing condition status. <code>Leirskredgrop</code>, <code>leirravine</code> and <code>grotte</code> were nature types in 2018 (not mapped in 2021), and was similarly not assessed for condition scores. <code>Isinnfrysingsmark</code> is assessed for condition now, but not in 2018. We can therefore exclude these localities from our data set:</p>
<div class="sourceCode" id="cb242"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_rm</span> <span class="op">&lt;-</span> <span class="va">dat</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat_rm</span><span class="op">[</span><span class="va">dat_rm</span><span class="op">$</span><span class="va">tilstand</span><span class="op">!=</span><span class="st">""</span>,<span class="op">]</span></code></pre></div>
<p>This resulted in the deletion of 270 rows, or 0.28 % of the data.</p>
</div>
<div id="mosaic-types" class="section level2" number="5.5">
<h2>
<span class="header-section-number">5.5</span> Mosaic types<a class="anchor" aria-label="anchor" href="#mosaic-types"><i class="fas fa-link"></i></a>
</h2>
<p>The field mapping instruction include and option for delineating mosaic types. Let’s investigate these cases.</p>
<p>When an area displays a repeating pattern of mixed nature types that each are smaller than the minimum mapping unit MMU, these are grouped into as many overlapping polygons as there are unique nature types. Within the nature type polygons, these will have the same distribution of NiN-grunntyper (online you can see the percentage distribution, but our data set only has the presence/absence data) but be assigned different nature types (nature types is the Environmental agencies classification). The condition scoring can be unique to each overlapping nature type in the mosaic. But we don’t know the precise location of the NiN-grunntyper that are part of mosaic nature types.</p>
<div class="sourceCode" id="cb243"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">mosaikk</span><span class="op">)</span>,
        xlab <span class="op">=</span> <span class="st">"Mosaic"</span>, ylab<span class="op">=</span><span class="st">"Number of localities"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-19"></span>
<img src="naturtype_files/figure-html/unnamed-chunk-19-1.png" alt="The number of mosaic localities is relatively small." width="672"><p class="caption">
Figure 5.5: The number of mosaic localities is relatively small.
</p>
</div>
<p>Mosaic localities occur in many main ecosystems (and many nature types therein).</p>
<div class="sourceCode" id="cb244"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Fix duplicated `hovedøkosystem`</span>
<span class="co">#unique(dat$hovedøkosystem)</span>
<span class="va">dat</span><span class="op">$</span><span class="va">hovedøkosystem</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">hovedøkosystem</span><span class="op">==</span><span class="st">"Naturlig åpne områder i lavlandet"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Naturlig åpne områder under skoggrensa"</span></code></pre></div>
<div class="sourceCode" id="cb245"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">20</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">hovedøkosystem</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">mosaikk</span><span class="op">==</span><span class="st">"Ja"</span><span class="op">]</span><span class="op">)</span>,
        horiz <span class="op">=</span> <span class="cn">T</span>, las<span class="op">=</span><span class="fl">2</span>,
        xlab<span class="op">=</span><span class="st">"Number of mosaic localities"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-21"></span>
<img src="naturtype_files/figure-html/unnamed-chunk-21-1.png" alt="Distribution of mosaic nature types across hovedøkosystem" width="672"><p class="caption">
Figure 5.6: Distribution of mosaic nature types across hovedøkosystem
</p>
</div>
<p>Some conclusion here could be that</p>
<ol style="list-style-type: decimal">
<li>Mosaic localities CANNOT be used to pin-point NiN grunntyper (e.g. for remote sensing purposes).</li>
<li>Mosaic localities CAN be used to extract condition scores for nature types, but these should not be tied to all the <em>NiN grunntype</em> listed in that polygon, because that will include some that belong to the other part(s) of the mosaic.</li>
</ol>
</div>
<div id="nin-types-across-main-ecosystems" class="section level2" number="5.6">
<h2>
<span class="header-section-number">5.6</span> NiN types across main ecosystems<a class="anchor" aria-label="anchor" href="#nin-types-across-main-ecosystems"><i class="fas fa-link"></i></a>
</h2>
<p>The NiN main types can be extracted from the column <code>ninkartleggingsenheter</code>. This is the mapping NiN mapping units recorded in the field. The NiN main type makes up the first part of this mapping unit code. The variable is oddly concatenated. Let’s tease it apart.</p>
<div class="sourceCode" id="cb246"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#dat$ninkartleggingsenheter[1:10]</span>
<span class="va">dat</span><span class="op">$</span><span class="va">ninkartleggingsenheter2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"NA_"</span>, <span class="va">dat</span><span class="op">$</span><span class="va">ninkartleggingsenheter</span>, replacement <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="co">#dat$ninkartleggingsenheter2[1:30]</span>
<span class="va">dat</span><span class="op">$</span><span class="va">ninkartleggingsenheter2</span> <span class="op">&lt;-</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">ninkartleggingsenheter2</span>, <span class="st">".[CE].[\\d]{1,}"</span>, replacement <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="co">#dat$ninkartleggingsenheter2[1:30]</span>
<span class="va">dat</span><span class="op">$</span><span class="va">ninkartleggingsenheter2</span> <span class="op">&lt;-</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">ninkartleggingsenheter2</span>, <span class="st">"-."</span>, replacement <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="va">uni</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">","</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">","</span><span class="op">)</span><span class="op">}</span>
<span class="va">dat</span><span class="op">$</span><span class="va">ninkartleggingsenheter3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">ninkartleggingsenheter2</span>, <span class="va">uni</span><span class="op">)</span>
<span class="va">n_uni</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">","</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">}</span>
<span class="va">dat</span><span class="op">$</span><span class="va">n_ninkartleggingsenheter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">ninkartleggingsenheter2</span>, <span class="va">n_uni</span><span class="op">)</span>
<span class="va">dat</span><span class="op">$</span><span class="va">n_ninkartleggingsenheter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">n_ninkartleggingsenheter</span><span class="op">)</span> 

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">n_ninkartleggingsenheter</span><span class="op">)</span>,
        xlab <span class="op">=</span> <span class="st">"Number of NiN main types"</span>,
        ylab <span class="op">=</span> <span class="st">"Number of localities"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">n_ninkartleggingsenheter</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">mosaikk</span><span class="op">==</span><span class="st">"Nei"</span><span class="op">]</span><span class="op">)</span>,
        xlab <span class="op">=</span> <span class="st">"Number of NiN main types\n(Mosaic localities excluded)"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">n_ninkartleggingsenheter</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">mosaikk</span><span class="op">==</span><span class="st">"Ja"</span><span class="op">]</span><span class="op">)</span>,
        xlab <span class="op">=</span> <span class="st">"Number of NiN main types\n(Mosaic localities only)"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-22"></span>
<img src="naturtype_files/figure-html/unnamed-chunk-22-1.png" alt="The number of NiN main types within one locality should normally be one, except for mosaic localities." width="672"><p class="caption">
Figure 5.7: The number of NiN main types within one locality should normally be one, except for mosaic localities.
</p>
</div>
<p>Mosaic localities (right pane) have a much higher likelihood of including multiple NiN main types, but it also occurs in non-mosaic localities (about 8000 cases). Most, if not all, nature types are defined within a single NiN main type, so we need to see whats going on there.</p>
<p>First I need to melt the data frame in order to tally the number of NiN min types within each <code>hovedøkosystem</code>.</p>
<div class="sourceCode" id="cb247"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_melt</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate_rows.html">separate_rows</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">ninkartleggingsenheter3</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb248"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat_melt</span><span class="op">[</span><span class="va">dat_melt</span><span class="op">$</span><span class="va">mosaikk</span><span class="op">!=</span><span class="st">"Ja"</span>,<span class="op">]</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_bar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">ninkartleggingsenheter3</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="st">"hovedøkosystem"</span>,
             scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-24"></span>
<img src="naturtype_files/figure-html/unnamed-chunk-24-1.png" alt="Figure showing the number of localities for each NiN main type. One locality can have more than one NiN main type. Mosaic localities are excluded in this figure." width="672"><p class="caption">
Figure 3.2: Figure showing the number of localities for each NiN main type. One locality can have more than one NiN main type. Mosaic localities are excluded in this figure.
</p>
</div>
<p>There is a lot of miss-match between NiN main types and <em>hovedøkosystem</em>.
Taking one example: T2 (åpen grunnledt mark) is not found in mountains, but there is one case where this occurs. If I view that case</p>
<div class="sourceCode" id="cb249"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/View.html">View</a></span><span class="op">(</span><span class="va">dat_melt</span><span class="op">[</span><span class="va">dat_melt</span><span class="op">$</span><span class="va">mosaikk</span><span class="op">!=</span><span class="st">"Ja"</span> <span class="op">&amp;</span> <span class="va">dat_melt</span><span class="op">$</span><span class="va">hovedøkosystem</span><span class="op">==</span><span class="st">"Fjell"</span> <span class="op">&amp;</span> <span class="va">dat_melt</span><span class="op">$</span><span class="va">ninkartleggingsenheter3</span><span class="op">==</span><span class="st">"T2"</span>,<span class="op">]</span><span class="op">)</span></code></pre></div>
<p>.. and find the online fact sheet for that locality, I see that it is actually NOT a mosaic. It is a nature type called <em>Kalkfattig og intermediær fjellhei, leside og tundra</em> which is defined as strictly T3, but the field surveyor has recorded lots of NiN mapping units (and hence, main NiN types) in addition. This is a mistake. Online I can see that the locality is 50% T3, but this information is not in the data set that we have available. Miljødirektoratet could consider adding this information to the downloadable dataset. The order of the NiN types in the <code>ninkartleggingsenheter</code> column is not reflecting the commonness of the types ether.</p>
<p>If there was a way to extract the defining NiN type from the <code>naturtype</code> column, that would be nice. Miljødirektoratet may consider adding this as well. If we exclude all localities that are not mosaics, but that have multiple NiN main types, we first need to know if there are not any <code>naturtype</code> which allow for multiple NiN main types.</p>
<p>As this next figure show, these cases are not restricted to mapping year, and hence to any changes in the field protocol. Rather this phenomenon is increasing in commonness.</p>
<div class="sourceCode" id="cb250"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">6</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">n_ninkartleggingsenheter</span><span class="op">&gt;</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">dat</span><span class="op">$</span><span class="va">mosaikk</span><span class="op">!=</span><span class="st">"Ja"</span>,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">temp</span><span class="op">$</span><span class="va">kartleggingsår</span><span class="op">)</span>, ylab<span class="op">=</span><span class="st">"Number of localities with more than one NiN main type\n(mosaic localitie excluded) "</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-26"></span>
<img src="naturtype_files/figure-html/unnamed-chunk-26-1.png" alt="Temporal trend in the recording of non-mosaic localities that are recorded as consisting of multiple NiN mapping units from different NiN main types." width="672"><p class="caption">
Figure 5.8: Temporal trend in the recording of non-mosaic localities that are recorded as consisting of multiple NiN mapping units from different NiN main types.
</p>
</div>
<p>Lets look at the most common nature types that are recorded this way.</p>
<div class="sourceCode" id="cb251"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">temp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">temp</span><span class="op">$</span><span class="va">naturtype</span>, <span class="va">temp</span><span class="op">$</span><span class="va">n_ninkartleggingsenheter</span><span class="op">)</span><span class="op">)</span>
<span class="va">temp2</span> <span class="op">&lt;-</span> <span class="va">temp2</span><span class="op">[</span><span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">temp2</span><span class="op">$</span><span class="va">Freq</span>, decreasing <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,<span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">20</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">temp2</span><span class="op">$</span><span class="va">Freq</span>, names.arg <span class="op">=</span> <span class="va">temp2</span><span class="op">$</span><span class="va">Var1</span>, las<span class="op">=</span><span class="fl">2</span>,
        horiz <span class="op">=</span> <span class="cn">T</span>, xlab <span class="op">=</span> <span class="st">"Number of localities with &gt;1 NiN main type"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-27"></span>
<img src="naturtype_files/figure-html/unnamed-chunk-27-1.png" alt="The ten most common nature types and the number of localities with with multiple NiN main types" width="672"><p class="caption">
Figure 5.9: The ten most common nature types and the number of localities with with multiple NiN main types
</p>
</div>
<p>‘Hule eiker’ is a special case because these are recorded as points and not polygons, and they can be found in any NiN main type and any <em>hovedøkosystem</em>.</p>
<div class="sourceCode" id="cb252"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span>
  <span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">naturtype</span><span class="op">==</span><span class="st">"Hule eiker"</span>,<span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"naturtype"</span>, <span class="st">"hovedøkosystem"</span>, <span class="st">"ninkartleggingsenheter"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-af32169c9cc822a968cb" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-af32169c9cc822a968cb">{"x":{"filter":"none","vertical":false,"data":[["3","8","19","33","38"],["Hule eiker","Hule eiker","Hule eiker","Hule eiker","Hule eiker"],["Semi-naturlig mark","Skog","Skog","Semi-naturlig mark","Skog"],["NA_T4-C-3","NA_T43-C-1","NA_T35-C-2,NA_T4-C-7","NA_T4-C-2","NA_T4-C-7"],[{"type":"MultiPolygon","coordinates":[[[[257373.1209,6576294.7663],[257373.089,6576293.79],[257372.9932,6576292.8179],[257372.8341,6576291.8541],[257372.6123,6576290.9029],[257372.3288,6576289.9681],[257371.9847,6576289.0539],[257371.5816,6576288.1642],[257371.1211,6576287.3027],[257370.6053,6576286.4732],[257370.0363,6576285.6793],[257369.4166,6576284.9242],[257368.7489,6576284.2112],[257368.036,6576283.5435],[257367.2809,6576282.9238],[257366.4869,6576282.3549],[257365.6574,6576281.8391],[257364.796,6576281.3786],[257363.9062,6576280.9755],[257362.992,6576280.6314],[257362.0573,6576280.3478],[257361.106,6576280.126],[257360.1423,6576279.9669],[257359.1702,6576279.8712],[257358.1939,6576279.8392],[257357.2176,6576279.8712],[257356.2455,6576279.9669],[257355.2818,6576280.126],[257354.3305,6576280.3478],[257353.3957,6576280.6314],[257352.4816,6576280.9755],[257351.5918,6576281.3786],[257350.7304,6576281.8391],[257349.9009,6576282.3549],[257349.1069,6576282.9238],[257348.3518,6576283.5435],[257347.6389,6576284.2112],[257346.9711,6576284.9242],[257346.3515,6576285.6793],[257345.7825,6576286.4732],[257345.2667,6576287.3027],[257344.8062,6576288.1642],[257344.4031,6576289.0539],[257344.059,6576289.9681],[257343.7755,6576290.9029],[257343.5537,6576291.8541],[257343.3945,6576292.8179],[257343.2988,6576293.79],[257343.2668,6576294.7663],[257343.2988,6576295.7425],[257343.3945,6576296.7146],[257343.5537,6576297.6784],[257343.7755,6576298.6297],[257344.059,6576299.5644],[257344.4031,6576300.4786],[257344.8062,6576301.3683],[257345.2667,6576302.2298],[257345.7825,6576303.0593],[257346.3515,6576303.8533],[257346.9711,6576304.6084],[257347.6389,6576305.3213],[257348.3518,6576305.989],[257349.1069,6576306.6087],[257349.9009,6576307.1777],[257350.7304,6576307.6935],[257351.5918,6576308.1539],[257352.4816,6576308.5571],[257353.3957,6576308.9011],[257354.3305,6576309.1847],[257355.2818,6576309.4065],[257356.2455,6576309.5656],[257357.2176,6576309.6614],[257358.1939,6576309.6933],[257359.1702,6576309.6614],[257360.1423,6576309.5656],[257361.106,6576309.4065],[257362.0573,6576309.1847],[257362.992,6576308.9011],[257363.9062,6576308.5571],[257364.796,6576308.1539],[257365.6574,6576307.6935],[257366.4869,6576307.1777],[257367.2809,6576306.6087],[257368.036,6576305.989],[257368.7489,6576305.3213],[257369.4166,6576304.6084],[257370.0363,6576303.8533],[257370.6053,6576303.0593],[257371.1211,6576302.2298],[257371.5816,6576301.3683],[257371.9847,6576300.4786],[257372.3288,6576299.5644],[257372.6123,6576298.6297],[257372.8341,6576297.6784],[257372.9932,6576296.7146],[257373.089,6576295.7425],[257373.1209,6576294.7663]]]]},{"type":"MultiPolygon","coordinates":[[[[230205.4737,6612351.6694],[230205.4418,6612350.6931],[230205.346,6612349.721],[230205.1869,6612348.7573],[230204.9651,6612347.806],[230204.6815,6612346.8713],[230204.3375,6612345.9571],[230203.9343,6612345.0673],[230203.4739,6612344.2059],[230202.9581,6612343.3764],[230202.3891,6612342.5824],[230201.7694,6612341.8273],[230201.1017,6612341.1144],[230200.3888,6612340.4467],[230199.6337,6612339.827],[230198.8397,6612339.258],[230198.0102,6612338.7422],[230197.1487,6612338.2817],[230196.259,6612337.8786],[230195.3448,6612337.5345],[230194.4101,6612337.251],[230193.4588,6612337.0292],[230192.495,6612336.8701],[230191.5229,6612336.7743],[230190.5467,6612336.7424],[230189.5704,6612336.7743],[230188.5983,6612336.8701],[230187.6345,6612337.0292],[230186.6833,6612337.251],[230185.7485,6612337.5345],[230184.8343,6612337.8786],[230183.9446,6612338.2817],[230183.0831,6612338.7422],[230182.2536,6612339.258],[230181.4597,6612339.827],[230180.7046,6612340.4467],[230179.9917,6612341.1144],[230179.3239,6612341.8273],[230178.7042,6612342.5824],[230178.1353,6612343.3764],[230177.6195,6612344.2059],[230177.159,6612345.0673],[230176.7559,6612345.9571],[230176.4118,6612346.8713],[230176.1282,6612347.806],[230175.9064,6612348.7573],[230175.7473,6612349.721],[230175.6516,6612350.6931],[230175.6196,6612351.6694],[230175.6516,6612352.6457],[230175.7473,6612353.6178],[230175.9064,6612354.5815],[230176.1282,6612355.5328],[230176.4118,6612356.4676],[230176.7559,6612357.3817],[230177.159,6612358.2715],[230177.6195,6612359.1329],[230178.1353,6612359.9624],[230178.7042,6612360.7564],[230179.3239,6612361.5115],[230179.9917,6612362.2244],[230180.7046,6612362.8922],[230181.4597,6612363.5118],[230182.2536,6612364.0808],[230183.0831,6612364.5966],[230183.9446,6612365.0571],[230184.8343,6612365.4602],[230185.7485,6612365.8043],[230186.6833,6612366.0878],[230187.6345,6612366.3096],[230188.5983,6612366.4688],[230189.5704,6612366.5645],[230190.5467,6612366.5965],[230191.5229,6612366.5645],[230192.495,6612366.4688],[230193.4588,6612366.3096],[230194.4101,6612366.0878],[230195.3448,6612365.8043],[230196.259,6612365.4602],[230197.1487,6612365.0571],[230198.0102,6612364.5966],[230198.8397,6612364.0808],[230199.6337,6612363.5118],[230200.3888,6612362.8922],[230201.1017,6612362.2244],[230201.7694,6612361.5115],[230202.3891,6612360.7564],[230202.9581,6612359.9624],[230203.4739,6612359.1329],[230203.9343,6612358.2715],[230204.3375,6612357.3817],[230204.6815,6612356.4676],[230204.9651,6612355.5328],[230205.1869,6612354.5815],[230205.346,6612353.6178],[230205.4418,6612352.6457],[230205.4737,6612351.6694]]]]},{"type":"MultiPolygon","coordinates":[[[[234886.4963,6595819.1304],[234886.4644,6595818.1541],[234886.3686,6595817.1821],[234886.2095,6595816.2183],[234885.9877,6595815.267],[234885.7041,6595814.3323],[234885.3601,6595813.4181],[234884.9569,6595812.5284],[234884.4965,6595811.6669],[234883.9807,6595810.8374],[234883.4117,6595810.0434],[234882.792,6595809.2883],[234882.1243,6595808.5754],[234881.4114,6595807.9077],[234880.6563,6595807.288],[234879.8623,6595806.719],[234879.0328,6595806.2032],[234878.1713,6595805.7428],[234877.2816,6595805.3396],[234876.3674,6595804.9955],[234875.4327,6595804.712],[234874.4814,6595804.4902],[234873.5176,6595804.3311],[234872.5455,6595804.2353],[234871.5693,6595804.2034],[234870.593,6595804.2353],[234869.6209,6595804.3311],[234868.6571,6595804.4902],[234867.7059,6595804.712],[234866.7711,6595804.9955],[234865.8569,6595805.3396],[234864.9672,6595805.7428],[234864.1057,6595806.2032],[234863.2762,6595806.719],[234862.4822,6595807.288],[234861.7272,6595807.9077],[234861.0142,6595808.5754],[234860.3465,6595809.2883],[234859.7268,6595810.0434],[234859.1579,6595810.8374],[234858.6421,6595811.6669],[234858.1816,6595812.5284],[234857.7785,6595813.4181],[234857.4344,6595814.3323],[234857.1508,6595815.267],[234856.929,6595816.2183],[234856.7699,6595817.1821],[234856.6742,6595818.1541],[234856.6422,6595819.1304],[234856.6742,6595820.1067],[234856.7699,6595821.0788],[234856.929,6595822.0425],[234857.1508,6595822.9938],[234857.4344,6595823.9286],[234857.7785,6595824.8428],[234858.1816,6595825.7325],[234858.6421,6595826.594],[234859.1579,6595827.4235],[234859.7268,6595828.2174],[234860.3465,6595828.9725],[234861.0142,6595829.6854],[234861.7272,6595830.3532],[234862.4822,6595830.9729],[234863.2762,6595831.5418],[234864.1057,6595832.0576],[234864.9672,6595832.5181],[234865.8569,6595832.9212],[234866.7711,6595833.2653],[234867.7059,6595833.5489],[234868.6571,6595833.7707],[234869.6209,6595833.9298],[234870.593,6595834.0255],[234871.5693,6595834.0575],[234872.5455,6595834.0255],[234873.5176,6595833.9298],[234874.4814,6595833.7707],[234875.4327,6595833.5489],[234876.3674,6595833.2653],[234877.2816,6595832.9212],[234878.1713,6595832.5181],[234879.0328,6595832.0576],[234879.8623,6595831.5418],[234880.6563,6595830.9729],[234881.4114,6595830.3532],[234882.1243,6595829.6854],[234882.792,6595828.9725],[234883.4117,6595828.2174],[234883.9807,6595827.4235],[234884.4965,6595826.594],[234884.9569,6595825.7325],[234885.3601,6595824.8428],[234885.7041,6595823.9286],[234885.9877,6595822.9938],[234886.2095,6595822.0425],[234886.3686,6595821.0788],[234886.4644,6595820.1067],[234886.4963,6595819.1304]]]]},{"type":"MultiPolygon","coordinates":[[[[246942.6116,6656594.3792],[246942.5796,6656593.403],[246942.4839,6656592.4309],[246942.3248,6656591.4671],[246942.1029,6656590.5158],[246941.8194,6656589.5811],[246941.4753,6656588.6669],[246941.0722,6656587.7772],[246940.6117,6656586.9157],[246940.0959,6656586.0862],[246939.5269,6656585.2922],[246938.9073,6656584.5372],[246938.2395,6656583.8242],[246937.5266,6656583.1565],[246936.7715,6656582.5368],[246935.9775,6656581.9679],[246935.148,6656581.452],[246934.2866,6656580.9916],[246933.3969,6656580.5884],[246932.4827,6656580.2444],[246931.5479,6656579.9608],[246930.5966,6656579.739],[246929.6329,6656579.5799],[246928.6608,6656579.4842],[246927.6845,6656579.4522],[246926.7082,6656579.4842],[246925.7361,6656579.5799],[246924.7724,6656579.739],[246923.8211,6656579.9608],[246922.8864,6656580.2444],[246921.9722,6656580.5884],[246921.0825,6656580.9916],[246920.221,6656581.452],[246919.3915,6656581.9679],[246918.5975,6656582.5368],[246917.8424,6656583.1565],[246917.1295,6656583.8242],[246916.4618,6656584.5372],[246915.8421,6656585.2922],[246915.2731,6656586.0862],[246914.7573,6656586.9157],[246914.2969,6656587.7772],[246913.8937,6656588.6669],[246913.5496,6656589.5811],[246913.2661,6656590.5158],[246913.0443,6656591.4671],[246912.8852,6656592.4309],[246912.7894,6656593.403],[246912.7575,6656594.3792],[246912.7894,6656595.3555],[246912.8852,6656596.3276],[246913.0443,6656597.2914],[246913.2661,6656598.2427],[246913.5496,6656599.1774],[246913.8937,6656600.0916],[246914.2969,6656600.9813],[246914.7573,6656601.8428],[246915.2731,6656602.6723],[246915.8421,6656603.4663],[246916.4618,6656604.2213],[246917.1295,6656604.9343],[246917.8424,6656605.602],[246918.5975,6656606.2217],[246919.3915,6656606.7906],[246920.221,6656607.3065],[246921.0825,6656607.7669],[246921.9722,6656608.17],[246922.8864,6656608.5141],[246923.8211,6656608.7977],[246924.7724,6656609.0195],[246925.7361,6656609.1786],[246926.7082,6656609.2743],[246927.6845,6656609.3063],[246928.6608,6656609.2743],[246929.6329,6656609.1786],[246930.5966,6656609.0195],[246931.5479,6656608.7977],[246932.4827,6656608.5141],[246933.3969,6656608.17],[246934.2866,6656607.7669],[246935.148,6656607.3065],[246935.9775,6656606.7906],[246936.7715,6656606.2217],[246937.5266,6656605.602],[246938.2395,6656604.9343],[246938.9073,6656604.2213],[246939.5269,6656603.4663],[246940.0959,6656602.6723],[246940.6117,6656601.8428],[246941.0722,6656600.9813],[246941.4753,6656600.0916],[246941.8194,6656599.1774],[246942.1029,6656598.2427],[246942.3248,6656597.2914],[246942.4839,6656596.3276],[246942.5796,6656595.3555],[246942.6116,6656594.3792]]]]},{"type":"MultiPolygon","coordinates":[[[[34307.7715999996,6459711.1272],[34307.7396999998,6459710.151],[34307.6438999996,6459709.1789],[34307.4847999997,6459708.2151],[34307.2630000003,6459707.2638],[34306.9793999996,6459706.3291],[34306.6354,6459705.4149],[34306.2322000004,6459704.5252],[34305.7718000002,6459703.6637],[34305.2560000001,6459702.8342],[34304.6869999999,6459702.0402],[34304.0673000002,6459701.2852],[34303.3996000001,6459700.5722],[34302.6867000004,6459699.9045],[34301.9315999998,6459699.2848],[34301.1376,6459698.7159],[34300.3081,6459698.2],[34299.4466000004,6459697.7396],[34298.5569000002,6459697.3364],[34297.6426999997,6459696.9924],[34296.7079999996,6459696.7088],[34295.7566999998,6459696.487],[34294.7928999998,6459696.3279],[34293.8207999999,6459696.2322],[34292.8446000004,6459696.2002],[34291.8683000002,6459696.2322],[34290.8962000003,6459696.3279],[34289.9324000003,6459696.487],[34288.9812000003,6459696.7088],[34288.0464000003,6459696.9924],[34287.1321999999,6459697.3364],[34286.2424999997,6459697.7396],[34285.3810000001,6459698.2],[34284.5515000001,6459698.7159],[34283.7576000001,6459699.2848],[34283.0025000004,6459699.9045],[34282.2895,6459700.5722],[34281.6217999998,6459701.2852],[34281.0021000002,6459702.0402],[34280.4331999999,6459702.8342],[34279.9173999997,6459703.6637],[34279.4568999996,6459704.5252],[34279.0537999999,6459705.4149],[34278.7096999995,6459706.3291],[34278.4260999998,6459707.2638],[34278.2043000003,6459708.2151],[34278.0451999996,6459709.1789],[34277.9495000001,6459710.151],[34277.9175000004,6459711.1272],[34277.9495000001,6459712.1035],[34278.0451999996,6459713.0756],[34278.2043000003,6459714.0394],[34278.4260999998,6459714.9907],[34278.7096999995,6459715.9254],[34279.0537999999,6459716.8396],[34279.4568999996,6459717.7293],[34279.9173999997,6459718.5908],[34280.4331999999,6459719.4203],[34281.0021000002,6459720.2143],[34281.6217999998,6459720.9693],[34282.2895,6459721.6823],[34283.0025000004,6459722.35],[34283.7576000001,6459722.9697],[34284.5515000001,6459723.5386],[34285.3810000001,6459724.0545],[34286.2424999997,6459724.5149],[34287.1321999999,6459724.918],[34288.0464000003,6459725.2621],[34288.9812000003,6459725.5457],[34289.9324000003,6459725.7675],[34290.8962000003,6459725.9266],[34291.8683000002,6459726.0223],[34292.8446000004,6459726.0543],[34293.8207999999,6459726.0223],[34294.7928999998,6459725.9266],[34295.7566999998,6459725.7675],[34296.7079999996,6459725.5457],[34297.6426999997,6459725.2621],[34298.5569000002,6459724.918],[34299.4466000004,6459724.5149],[34300.3081,6459724.0545],[34301.1376,6459723.5386],[34301.9315999998,6459722.9697],[34302.6867000004,6459722.35],[34303.3996000001,6459721.6823],[34304.0673000002,6459720.9693],[34304.6869999999,6459720.2143],[34305.2560000001,6459719.4203],[34305.7718000002,6459718.5908],[34306.2322000004,6459717.7293],[34306.6354,6459716.8396],[34306.9793999996,6459715.9254],[34307.2630000003,6459714.9907],[34307.4847999997,6459714.0394],[34307.6438999996,6459713.0756],[34307.7396999998,6459712.1035],[34307.7715999996,6459711.1272]]]]}]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>naturtype<\/th>\n      <th>hovedøkosystem<\/th>\n      <th>ninkartleggingsenheter<\/th>\n      <th>SHAPE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}]}},"evals":[],"jsHooks":[]}</script><p><em>Kystlynghei</em> often occurs as a mosaic, but figure <a href="#fig:multipleNiN"><strong>??</strong></a> has excluded the mosaic localities, and then <em>kystlynghei</em> is strictly defined to T34.
The same is true for <em>naturbeitemark</em> which is restricted to T32.
Maybe these localities should all have been recorded as mosaic localities. In any case, we cannot automatically extract the main NiN type from these rows now.</p>
<p>The remaining option is to manually assign the defining NiN main type to each nature type. This data is not included in the data set, and would need to be sourced from the mapping protocols for all the different field seasons.</p>
<p>For a deeper analyses into the causes for localities being mapped to NiN main types outside the definition of the nature type, see <a href="naturtype.html#appendix-1">Appendix 1</a>.</p>
</div>
<div id="assigning-nin-main-types-to-nature-types" class="section level2" number="5.7">
<h2>
<span class="header-section-number">5.7</span> Assigning NiN main types to Nature types<a class="anchor" aria-label="anchor" href="#assigning-nin-main-types-to-nature-types"><i class="fas fa-link"></i></a>
</h2>
<p>The NiN main types need to be added manually to the nature types, as the field recorded data is error prone, and the defining NiN units for each nature type is not included in the data set.</p>
<p>I will start by excluding all but the three target ecosystems.</p>
<div class="sourceCode" id="cb253"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">target</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Semi-naturlig mark"</span>,<span class="st">"Våtmark"</span>,<span class="st">"Naturlig åpne områder under skoggrensa"</span><span class="op">)</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">hovedøkosystem</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">target</span>,<span class="op">]</span></code></pre></div>
<p>I will also exclude <code>Hule eiker</code>, as this nature type is not easy to tie to a single main ecosystem</p>
<div class="sourceCode" id="cb254"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">naturtype</span> <span class="op">!=</span> <span class="st">"Hule eiker"</span>,<span class="op">]</span></code></pre></div>
<p>Get the unique nature types</p>
<div class="sourceCode" id="cb255"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ntyp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">naturtype</span><span class="op">)</span></code></pre></div>
<p>Extract the year when these were mapped</p>
<div class="sourceCode" id="cb256"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">years</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ntyp</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
<span class="va">years</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">kartleggingsår</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">naturtype</span> <span class="op">==</span> <span class="va">ntyp</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Extract the associated ecosystem</p>
<div class="sourceCode" id="cb257"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">eco</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ntyp</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
<span class="va">eco</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">hovedøkosystem</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">naturtype</span> <span class="op">==</span> <span class="va">ntyp</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Combine into one data frame</p>
<div class="sourceCode" id="cb258"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ntypDF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  <span class="st">"Nature_type"</span> <span class="op">=</span> <span class="va">ntyp</span>,
  <span class="st">"Year"</span>        <span class="op">=</span> <span class="va">years</span>,
  <span class="st">"Ecosystem"</span>   <span class="op">=</span> <span class="va">eco</span>
<span class="op">)</span></code></pre></div>
<p>We have 66 nature types to consider. Some of the wetland types can actually be excluded because of the way we limited this ecosystem to mean <em>open</em> wetland.</p>
<div class="sourceCode" id="cb259"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">excl_nt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Kalkrik myr- og sumpskogsmark"</span>,
             <span class="co">#"Flommyr, myrkant og myrskogsmark",  # Only V9 is relevant. This type also includes V2 and V8</span>
             <span class="st">"Gammel fattig sumpskog"</span>,
             <span class="st">"Rik gransumpskog"</span>,
             <span class="st">"Grankildeskog"</span>,
             <span class="st">"Rik svartorsumpskog"</span>,
             <span class="st">"Rik gråorsumpskog"</span>,
             <span class="st">"Rik svartorstrandskog"</span>,
             <span class="st">"Saltpåvirket svartorstrandskog"</span>,
             <span class="st">"Kilde-edellauvskog"</span>,
             <span class="st">"Saltpåvirket strand- og sumpskogsmark"</span>,
             <span class="st">"Svak kilde og kildeskogsmark"</span>,
             <span class="st">"Rik vierstrandskog"</span>,
             <span class="st">"Varmekjær kildelauvskog"</span>
             <span class="op">)</span>
<span class="va">`%!in%`</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Negate</a></span><span class="op">(</span><span class="va">`%in%`</span><span class="op">)</span>
<span class="va">ntypDF</span> <span class="op">&lt;-</span> <span class="va">ntypDF</span><span class="op">[</span><span class="va">ntypDF</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">%!in%</span> <span class="va">excl_nt</span>,<span class="op">]</span></code></pre></div>
<div class="sourceCode" id="cb260"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="va">ntypDF</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-35"></span>
<div id="htmlwidget-c91d23946f000714bc5d" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-c91d23946f000714bc5d">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","23","25","28","29","30","31","33","34","35","36","38","39","40","41","42","43","44","45","46","47","48","50","51","52","53","54","58","59","60","62","63","65","66"],["Slåttemark","Kystlynghei","Naturbeitemark","Slåttemyr","Boreal hei","Åpen myrflate i boreonemoral til nordboreal sone","Semi-naturlig eng","Platåhøymyr","Strandeng","Hagemark","Semi-naturlig våteng","Eksentrisk høymyr","Rik åpen jordvannsmyr i mellomboreal sone","Sørlig slåttemyr","Terrengdekkende myr","Semi-naturlig myr","Åpen flomfastmark","Svært tørkeutsatt sørlig kalkberg","Flommyr, myrkant og myrskogsmark","Isinnfrysingsmark","Eng-aktig sterkt endret fastmark","Høgereligende og nordlig nedbørsmyr","Øyblandingsmyr","Semi-naturlig strandeng","Lauveng","Kalkrik helofyttsump","Kalkrik åpen jordvannsmyr i boreonemoral til nordboreal sone","Sørlig nedbørsmyr","Rik åpen sørlig jordvannsmyr","Fossepåvirket berg","Aktiv skredmark","Palsmyr","Silt og leirskred","Nakent tørkeutsatt kalkberg","Sørlig kaldkilde","Kystnedbørsmyr","Åpen grunnlendt kalkrik mark i boreonemoral sone","Kaldkilde under skoggrensa","Sørlig etablert sanddynemark","Atlantisk høymyr","Rik åpen jordvannsmyr i nordboreal og lavalpin sone","Sanddynemark","Åpen grunnlendt kalkrik mark i sørboreal sone","Fuglefjell-eng og fugletopp","Fosseberg","Kanthøymyr","Sentrisk høgmyr","Tørt kalkrikt berg i kontinentale områder","Fosse-eng","Sørlig strandeng","Øvre sandstrand uten pionervegetasjon","Konsentrisk høymyr","Åpen myrflate i lavalpin sone"],["2018, 2019, 2020, 2021","2018, 2019, 2020, 2021","2018, 2019, 2020, 2021","2018, 2019, 2020, 2021","2018, 2019, 2020, 2021","2018","2018, 2019, 2020, 2021","2019, 2020, 2021","2018, 2019, 2020, 2021","2018, 2019, 2020, 2021","2018, 2019, 2020, 2021","2019, 2020, 2021","2019, 2020, 2021","2019, 2020, 2021","2019, 2020, 2021","2019, 2020, 2021","2018, 2019, 2020, 2021","2019, 2020, 2021","2018","2018, 2019, 2020, 2021","2018, 2019, 2020, 2021","2019, 2020, 2021","2019, 2020, 2021","2018, 2019, 2020, 2021","2019, 2020","2019, 2020, 2021","2018","2019, 2020, 2021","2018, 2019, 2020, 2021","2019, 2020, 2021","2019, 2020, 2021","2021","2019, 2020, 2021","2018, 2019, 2020, 2021","2018, 2019, 2020, 2021","2018","2018, 2019, 2020, 2021","2018","2018, 2019, 2020, 2021","2019, 2020, 2021","2018, 2019, 2020, 2021","2018, 2019, 2020, 2021","2019, 2020, 2021","2019, 2020, 2021","2021","2019, 2020, 2021","2018","2019","2019, 2020","2018","2019, 2020, 2021","2019, 2020","2018"],["Semi-naturlig mark","Semi-naturlig mark","Semi-naturlig mark","Våtmark","Semi-naturlig mark","Våtmark","Semi-naturlig mark","Våtmark","Naturlig åpne områder under skoggrensa","Semi-naturlig mark","Våtmark","Våtmark","Våtmark","Våtmark","Våtmark","Våtmark","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Våtmark","Naturlig åpne områder under skoggrensa","Semi-naturlig mark","Våtmark","Våtmark","Semi-naturlig mark","Semi-naturlig mark","Våtmark","Våtmark","Våtmark","Våtmark","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Våtmark","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Våtmark","Våtmark","Naturlig åpne områder under skoggrensa","Våtmark","Naturlig åpne områder under skoggrensa","Våtmark","Våtmark","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Våtmark","Våtmark","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Våtmark","Våtmark"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Nature_type<\/th>\n      <th>Year<\/th>\n      <th>Ecosystem<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}]}},"evals":[],"jsHooks":[]}</script><p class="caption">
Figure 5.10: List of nature types showing the years when that nature type was mapped.
</p>
</div>
<p>I will also now exclude nature types that were only mapped in 2018 and/or 2019 and not after that. These nature types will not only not get more data in the future, but also they were mapped in a time when the methodology was quite unstable.</p>
<div class="sourceCode" id="cb261"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ntypDF2</span> <span class="op">&lt;-</span> <span class="va">ntypDF</span><span class="op">[</span><span class="va">ntypDF</span><span class="op">$</span><span class="va">Year</span> <span class="op">!=</span> <span class="st">"2018"</span> <span class="op">&amp;</span>
                  <span class="va">ntypDF</span><span class="op">$</span><span class="va">Year</span> <span class="op">!=</span> <span class="st">"2019"</span> <span class="op">&amp;</span> 
                  <span class="va">ntypDF</span><span class="op">$</span><span class="va">Year</span> <span class="op">!=</span> <span class="st">"2018, 2019"</span><span class="co"># no types were mappend in 2018 &amp; 2019 only</span>
                  ,<span class="op">]</span></code></pre></div>
<p>Next I want to add the NiN main types. I need to look at the definition of each nature type and get the NiN code from there. I could also extract the NiN sub types (grunntyper), but it would become too messy. Therefor I will create a second column with a textual/categorical description of the degree of thematic coverage.</p>
<p>I will look at the definitions of the nature type in the first and last year when that type was mapped, but not for the years in between.</p>
<div id="add-nin-main-type-and-degree-of-representativity" class="section level3" number="5.7.1">
<h3>
<span class="header-section-number">5.7.1</span> Add NiN main type and degree of representativity<a class="anchor" aria-label="anchor" href="#add-nin-main-type-and-degree-of-representativity"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb262"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Aktiv skredmark"</span>                                    <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"T17 | all (if including sub-types)"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Åpen flomfastmark"</span>                                  <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"T18 | all"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Åpen grunnlendt kalkrik mark i boreonemoral sone"</span>   <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"T2  | calcareous"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Åpen grunnlendt kalkrik mark i sørboreal sone"</span>      <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"T2  | calcareous"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Atlantisk høymyr"</span>                                   <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"V3  | all (if including sub-types)"</span> <span class="co"># can also include smaller areas of V1</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Boreal hei"</span>                                         <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"T31 | all"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Eksentrisk høymyr"</span>                                  <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"V3  | all (if including sub-types)"</span> <span class="co"># can also include smaller areas of V1</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Eng-aktig sterkt endret fastmark"</span>                   <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"T41 | all"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Fosse-eng"</span>                                          <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"T15 | all"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Fosseberg"</span>                                          <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"T1  | extra wet"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Fossepåvirket berg"</span>                                 <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"T1  | extra wet"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Fuglefjell-eng og fugletopp"</span>                        <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"T8  | all"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Hagemark"</span>                                           <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"T32 | all (if including sub-types)"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Høgereligende og nordlig nedbørsmyr"</span>                <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"V3  | all (if including sub-types)"</span> <span class="co"># torvmarksformene are excluded</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Isinnfrysingsmark"</span>                                  <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"T20 | all"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Kalkrik helofyttsump"</span>                               <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"L4 | calcareous"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Kanthøymyr"</span>                                         <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"V3  | all (if including sub-types)"</span> <span class="co"># can also include smaller areas of V1</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Konsentrisk høymyr"</span>                                 <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"V3  | all (if including sub-types)"</span> <span class="co"># can also include smaller areas of V1</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Kystlynghei"</span>                                        <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"T34 | all"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Lauveng"</span>                                            <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"T32 | all (if including sub-types)"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Nakent tørkeutsatt kalkberg"</span>                        <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"T1  | calcareous and dry"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Naturbeitemark"</span>                                     <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"T32 | all (if including sub-types)"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Øvre sandstrand uten pionervegetasjon"</span>              <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"T29 | sandy and vegetated"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Øyblandingsmyr"</span>                                     <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"V1  | partial"</span> <span class="co"># also includes V3</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Palsmyr"</span>                                            <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"V3  | all (if including sub-types)"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Platåhøymyr"</span>                                        <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"V3  | all (if including sub-types)"</span> <span class="co"># can also include smaller areas of V1</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Rik åpen jordvannsmyr i mellomboreal sone"</span>          <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"V1  | calcareous"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Rik åpen jordvannsmyr i nordboreal og lavalpin sone"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"V1  | calcareous"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Rik åpen sørlig jordvannsmyr"</span>                       <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"V1  | calcareous"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Sanddynemark"</span>                                       <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"T21 | all (if including sub-types)"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Semi-naturlig eng"</span>                                  <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"T32 | all (if including sub-types)"</span>
<span class="co"># This might be called Kulturmarkseng in the 2018 protocol, but Semi-naturlig eng in the data set. </span>
<span class="co"># Kulturmarkseng also includes V10</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Semi-naturlig myr"</span>                                  <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"V9  | all (if including sub-types)"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Semi-naturlig strandeng"</span>                            <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"T33 | all (-2018)"</span> <span class="co"># could perhaps be used in 2018, but it's defined awkwardly</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Semi-naturlig våteng"</span>                               <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"V10 | all (-2018)"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Silt og leirskred"</span>                                  <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"T17 | all (if including sub-types)"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Slåttemark"</span>                                         <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"T32 | all (if including sub-types)"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Slåttemyr"</span>                                          <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"V9  | all (if including sub-types)"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Sørlig etablert sanddynemark"</span>                       <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"T21 | all (if including sub-types)"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Sørlig kaldkilde"</span>                                   <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"V4  | southern"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Sørlig nedbørsmyr"</span>                                  <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"V3  | all (if including sub-types)"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Sørlig slåttemyr"</span>                                   <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"V9  | all (if including sub-types)"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Strandeng"</span>                                          <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"T12 | all (-2018)"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Svært tørkeutsatt sørlig kalkberg"</span>                  <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"T1  | calcareous and dry"</span>
<span class="va">ntypDF2</span><span class="op">$</span><span class="va">hovedgruppe</span><span class="op">[</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op">==</span> <span class="st">"Terrengdekkende myr"</span>                                <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"V3  | all (if including sub-types)"</span></code></pre></div>
<p>Split this new column in two.</p>
<div class="sourceCode" id="cb263"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ntypDF2</span> <span class="op">&lt;-</span> <span class="va">ntypDF2</span> <span class="op">%&gt;%</span>
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">hovedgruppe</span>,
                  into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NiN_mainType"</span>, <span class="st">"NiN_mainTypeCoverage"</span><span class="op">)</span>,
                  <span class="co">#sep = "|",</span>
                  remove<span class="op">=</span><span class="cn">T</span>,
                  extra <span class="op">=</span> <span class="st">"merge"</span>
              <span class="op">)</span></code></pre></div>
</div>
</div>
<div id="add-nin-variables" class="section level2" number="5.8">
<h2>
<span class="header-section-number">5.8</span> Add NiN variables<a class="anchor" aria-label="anchor" href="#add-nin-variables"><i class="fas fa-link"></i></a>
</h2>
<p>Preparing the data:</p>
<div class="sourceCode" id="cb264"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Exclude non-relevant forest wetland types</span>
<span class="va">dat2</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">naturtype</span> <span class="op">%!in%</span> <span class="va">excl_nt</span>,<span class="op">]</span>

<span class="co"># Melt data</span>
<span class="va">dat2L</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate_rows.html">separate_rows</a></span><span class="op">(</span><span class="va">dat2</span>, <span class="va">ninbeskrivelsesvariabler</span>, sep<span class="op">=</span><span class="st">","</span><span class="op">)</span>

<span class="co"># Split the code and the value into separate columns</span>
<span class="va">dat2L</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span><span class="op">(</span><span class="va">dat2L</span>, 
                              col <span class="op">=</span> <span class="va">ninbeskrivelsesvariabler</span>,
                              into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NiN_variable_code"</span>, <span class="st">"NiN_variable_value"</span><span class="op">)</span>,
                              sep <span class="op">=</span> <span class="st">"_"</span>,
                              remove<span class="op">=</span><span class="cn">F</span>
                              <span class="op">)</span>
<span class="co">#&gt; Warning: Expected 2 pieces. Missing pieces filled with `NA` in 1</span>
<span class="co">#&gt; rows [319462].</span>
<span class="co"># One NA produced here, but I check it, and it's fine.</span>

<span class="co"># Convert values to numeric. This causes some NA's which I will go through below</span>
<span class="va">dat2L</span><span class="op">$</span><span class="va">NiN_variable_value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">dat2L</span><span class="op">$</span><span class="va">NiN_variable_value</span><span class="op">)</span>
<span class="co">#&gt; Warning: NAs introduced by coercion</span></code></pre></div>
<p>Here are all the NiN variable codes:</p>
<div class="sourceCode" id="cb265"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">dat2L</span><span class="op">$</span><span class="va">NiN_variable_code</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;  [1] "1AG-A-0"   "1AG-A-E"   "1AG-A-G"   "1AG-B"    </span>
<span class="co">#&gt;  [5] "1AG-C"     "1AR-C-L"   "3TO-BØ"    "3TO-HA"   </span>
<span class="co">#&gt;  [9] "3TO-HE"    "3TO-HK"    "3TO-HN"    "3TO-HP"   </span>
<span class="co">#&gt; [13] "3TO-PA"    "3TO-TE"    "4DL-S-0"   "4DL-SS-0" </span>
<span class="co">#&gt; [17] "4TG-BL"    "4TG-EL"    "4TG-GF"    "4TL-BS"   </span>
<span class="co">#&gt; [21] "4TL-HE"    "4TL-HL"    "4TL-RB"    "4TL-SB"   </span>
<span class="co">#&gt; [25] "5AB-0"     "5AB-DO-TT" "5BY-0"     "6SE"      </span>
<span class="co">#&gt; [29] "6SO"       "7FA"       "7GR-GI"    "7JB-BA"   </span>
<span class="co">#&gt; [33] "7JB-BT"    "7JB-GJ"    "7JB-HT-SL" "7JB-HT-ST"</span>
<span class="co">#&gt; [37] "7JB-KU-BY" "7JB-KU-DE" "7JB-KU-MO" "7JB-KU-PI"</span>
<span class="co">#&gt; [41] "7RA-BH"    "7RA-SJ"    "7SD-0"     "7SD-NS"   </span>
<span class="co">#&gt; [45] "7SE"       "7TK"       "7VR-RI"    "LKMKI"    </span>
<span class="co">#&gt; [49] "LKMSP"     "PRAK"      "PRAM"      "PRH"      </span>
<span class="co">#&gt; [53] "PRHA"      "PRHT"      "PRKA"      "PRKU"     </span>
<span class="co">#&gt; [57] "PRMY"      "PRRL-CR"   "PRRL-DD"   "PRRL-EN"  </span>
<span class="co">#&gt; [61] "PRRL-NT"   "PRRL-VU"   "PRSE-KA"   "PRSE-PA"  </span>
<span class="co">#&gt; [65] "PRSE-SH"   "PRSL"      "PRTK"      "PRTO"     </span>
<span class="co">#&gt; [69] "PRVS"</span></code></pre></div>
<p>Converting NiN_variable_value to numeric also introduced NA’s for these categories:</p>
<div class="sourceCode" id="cb266"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">dat2L</span><span class="op">$</span><span class="va">NiN_variable_code</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">dat2L</span><span class="op">$</span><span class="va">NiN_variable_value</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;  [1] "4DL-S-0"   "4DL-SS-0"  "5AB-0"     "5BY-0"    </span>
<span class="co">#&gt;  [5] "7FA"       "7GR-GI"    "7JB-BA"    "7JB-BT"   </span>
<span class="co">#&gt;  [9] "7JB-GJ"    "7JB-KU-BY" "7JB-KU-DE" "7JB-KU-MO"</span>
<span class="co">#&gt; [13] "7JB-KU-PI" "7RA-SJ"    "7SD-0"     "7SD-NS"   </span>
<span class="co">#&gt; [17] "7SE"       "7TK"       "7VR-RI"    "LKMKI"    </span>
<span class="co">#&gt; [21] "LKMSP"     "PRH"       "PRVS"</span></code></pre></div>
<p>When I now go through the variable codes separately I will also judge if these NA’s are real, or if they for example should be coded as zeros or something. I will exclude variables that are part of the biodiversity assessment of the localities, since these are not assessed for localities that have a very poor condition (this bias is not possible to correct).</p>
<div id="ag-a-sjiktdekningsvariabler" class="section level3" number="5.8.1">
<h3>
<span class="header-section-number">5.8.1</span> 1AG-A (sjiktdekningsvariabler)<a class="anchor" aria-label="anchor" href="#ag-a-sjiktdekningsvariabler"><i class="fas fa-link"></i></a>
</h3>
<p>These are different variables describing the cover in different vegetation strata and/or species</p>
<ul>
<li>1AG-A-0 = Total tre canopy cover</li>
<li>1AG-B = Total shrub cover</li>
<li>1AG-C = Total field layer cover</li>
<li>1AG-A-E = ‘Overstandere’</li>
<li>1AG-A-G = ‘gjenveksttrær’</li>
</ul>
</div>
<div id="ar-c-l-andel-vedvekster-i-fletsjiktet" class="section level3" number="5.8.2">
<h3>
<span class="header-section-number">5.8.2</span> 1AR-C-L (Andel vedvekster i fletsjiktet)<a class="anchor" aria-label="anchor" href="#ar-c-l-andel-vedvekster-i-fletsjiktet"><i class="fas fa-link"></i></a>
</h3>
<p>A condition variable in some mire nature types</p>
</div>
<div id="to-torvmarksformer" class="section level3" number="5.8.3">
<h3>
<span class="header-section-number">5.8.3</span> 3TO (Torvmarksformer)<a class="anchor" aria-label="anchor" href="#to-torvmarksformer"><i class="fas fa-link"></i></a>
</h3>
<p>These are defining variables, and not part of the condition assessment.</p>
<div class="sourceCode" id="cb267"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exclude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"3TO-BØ"</span>,
             <span class="st">"3TO-HA"</span>,
             <span class="st">"3TO-HE"</span>,
             <span class="st">"3TO-HK"</span>,
             <span class="st">"3TO-HN"</span>,
             <span class="st">"3TO-HP"</span>,
             <span class="st">"3TO-PA"</span>,
             <span class="st">"3TO-TE"</span><span class="op">)</span></code></pre></div>
</div>
<div id="dl-coarse-dead-wood" class="section level3" number="5.8.4">
<h3>
<span class="header-section-number">5.8.4</span> 4DL (Coarse dead wood)<a class="anchor" aria-label="anchor" href="#dl-coarse-dead-wood"><i class="fas fa-link"></i></a>
</h3>
<p>4DL-SS-0 and 4DL-S-0 has to do with the total amount of coarse woody debris/logs. It was only recorded for one nature type in 2018, and then as a a <em>biodiversity variable</em>, and not a state variable.</p>
<div class="sourceCode" id="cb268"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exclude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">exclude</span>,
             <span class="st">"4DL-SS-0"</span>,
             <span class="st">"4DL-S-0"</span><span class="op">)</span></code></pre></div>
</div>
<div id="tg-old-trees" class="section level3" number="5.8.5">
<h3>
<span class="header-section-number">5.8.5</span> 4TG (old trees)<a class="anchor" aria-label="anchor" href="#tg-old-trees"><i class="fas fa-link"></i></a>
</h3>
<p>These three variables are used as <em>biodiversity variables</em> in 2018.</p>
<div class="sourceCode" id="cb269"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exclude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">exclude</span>,
             <span class="st">"4TG-BL"</span>,
             <span class="st">"4TG-EL"</span>,
             <span class="st">"4TG-GF"</span><span class="op">)</span></code></pre></div>
</div>
<div id="tl-trees-with-fire-scars" class="section level3" number="5.8.6">
<h3>
<span class="header-section-number">5.8.6</span> 4TL (trees with fire scars)<a class="anchor" aria-label="anchor" href="#tl-trees-with-fire-scars"><i class="fas fa-link"></i></a>
</h3>
<p>These five variables are used together with 4TG as <em>biodiversity variables</em> in 2018.</p>
<div class="sourceCode" id="cb270"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exclude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">exclude</span>,
             <span class="st">"4TL-BS"</span>,
             <span class="st">"4TL-HE"</span>,
             <span class="st">"4TL-HL"</span>,
             <span class="st">"4TL-RB"</span>,
             <span class="st">"4TL-SB"</span><span class="op">)</span></code></pre></div>
</div>
<div id="ab-and-5by-arealbruksklasser-og-byggningstyper" class="section level3" number="5.8.7">
<h3>
<span class="header-section-number">5.8.7</span> 5AB and 5BY (arealbruksklasser og byggningstyper)<a class="anchor" aria-label="anchor" href="#ab-and-5by-arealbruksklasser-og-byggningstyper"><i class="fas fa-link"></i></a>
</h3>
<p>These area land use types and building types, respectively, and the values are not numeric, but categorical, and represents presence or absence of these land uses or objects. These are not suited for automatically determining ecosystem condition as this is done subjectively in the field.</p>
<div class="sourceCode" id="cb271"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exclude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">exclude</span>,
             <span class="st">"5AB-0"</span>,
             <span class="st">"5AB-DO-TT"</span>,
             <span class="st">"5BY-0"</span>
             <span class="op">)</span></code></pre></div>
</div>
<div id="se-and-6so-bioclimatical-sections-and-sones" class="section level3" number="5.8.8">
<h3>
<span class="header-section-number">5.8.8</span> 6SE and 6SO (Bioclimatical sections and sones)<a class="anchor" aria-label="anchor" href="#se-and-6so-bioclimatical-sections-and-sones"><i class="fas fa-link"></i></a>
</h3>
<p>Not relevant here as condition variables.</p>
<div class="sourceCode" id="cb272"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exclude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">exclude</span>,
             <span class="st">"6SE"</span>,
             <span class="st">"6SO"</span><span class="op">)</span></code></pre></div>
</div>
<div id="fa-fremmedartsinnslag" class="section level3" number="5.8.9">
<h3>
<span class="header-section-number">5.8.9</span> 7FA (fremmedartsinnslag)<a class="anchor" aria-label="anchor" href="#fa-fremmedartsinnslag"><i class="fas fa-link"></i></a>
</h3>
<p>Should not have been allowed the value X, so Ok to keep these as NA.</p>
</div>
<div id="gr-gi" class="section level3" number="5.8.10">
<h3>
<span class="header-section-number">5.8.10</span> 7GR-GI<a class="anchor" aria-label="anchor" href="#gr-gi"><i class="fas fa-link"></i></a>
</h3>
<p>7GR-GI (grøftingsintensitet) should not have the value X either, so OK to exclude these NA’s. But we keep the variable, even though its clearly a pressure indicator, we might want to use it as a surrogate for mire hydrology.</p>
</div>
<div id="jb-ba-aktuell-bruksintensitet" class="section level3" number="5.8.11">
<h3>
<span class="header-section-number">5.8.11</span> 7JB-BA (Aktuell bruksintensitet)<a class="anchor" aria-label="anchor" href="#jb-ba-aktuell-bruksintensitet"><i class="fas fa-link"></i></a>
</h3>
<p>A common condition/pressure variable in semi-natural nature types.</p>
<p>Overview of cases where the value is set as <em>X</em>.</p>
<div class="sourceCode" id="cb273"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">dat2L</span><span class="op">[</span><span class="va">dat2L</span><span class="op">$</span><span class="va">ninbeskrivelsesvariabler</span> <span class="op">==</span> <span class="st">"7JB-BA_X"</span>,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">temp</span><span class="op">$</span><span class="va">kartleggingsår</span>, <span class="va">temp</span><span class="op">$</span><span class="va">naturtype</span><span class="op">)</span>
<span class="co">#&gt;       </span>
<span class="co">#&gt;        Eng-aktig sterkt endret fastmark Hagemark</span>
<span class="co">#&gt;   2018                                0        0</span>
<span class="co">#&gt;   2020                                1        0</span>
<span class="co">#&gt;   2021                                0        1</span>
<span class="co">#&gt;       </span>
<span class="co">#&gt;        Semi-naturlig eng Semi-naturlig strandeng Slåttemark</span>
<span class="co">#&gt;   2018                 0                       0          0</span>
<span class="co">#&gt;   2020                 0                       0          0</span>
<span class="co">#&gt;   2021                 1                       1          1</span>
<span class="co">#&gt;       </span>
<span class="co">#&gt;        Strandeng</span>
<span class="co">#&gt;   2018        27</span>
<span class="co">#&gt;   2020         0</span>
<span class="co">#&gt;   2021         0</span></code></pre></div>
<p>These are just a few cases, mostly from 2018. OK to treat as NA.</p>
</div>
<div id="jb-bt-beitetrykk" class="section level3" number="5.8.12">
<h3>
<span class="header-section-number">5.8.12</span> 7JB-BT (Beitetrykk)<a class="anchor" aria-label="anchor" href="#jb-bt-beitetrykk"><i class="fas fa-link"></i></a>
</h3>
<p>Similar variable to the above.</p>
<div class="sourceCode" id="cb274"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">dat2L</span><span class="op">[</span><span class="va">dat2L</span><span class="op">$</span><span class="va">ninbeskrivelsesvariabler</span> <span class="op">==</span> <span class="st">"7JB-BT_X"</span>,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">temp</span><span class="op">$</span><span class="va">kartleggingsår</span>, <span class="va">temp</span><span class="op">$</span><span class="va">naturtype</span><span class="op">)</span>
<span class="co">#&gt;       </span>
<span class="co">#&gt;        Åpen flomfastmark Kystlynghei Sanddynemark</span>
<span class="co">#&gt;   2019                 3           0            0</span>
<span class="co">#&gt;   2020                 1           1            2</span>
<span class="co">#&gt;   2021                 3           0            0</span></code></pre></div>
<p>OK to treat X’s as NA’s.</p>
</div>
<div id="jb-gj-gjødsling" class="section level3" number="5.8.13">
<h3>
<span class="header-section-number">5.8.13</span> 7JB-GJ (Gjødsling)<a class="anchor" aria-label="anchor" href="#jb-gj-gj%C3%B8dsling"><i class="fas fa-link"></i></a>
</h3>
<p>Similar variable to the two above.</p>
<div class="sourceCode" id="cb275"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">dat2L</span><span class="op">[</span><span class="va">dat2L</span><span class="op">$</span><span class="va">ninbeskrivelsesvariabler</span> <span class="op">==</span> <span class="st">"7JB-BT_X"</span>,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">temp</span><span class="op">$</span><span class="va">kartleggingsår</span>, <span class="va">temp</span><span class="op">$</span><span class="va">naturtype</span><span class="op">)</span>
<span class="co">#&gt;       </span>
<span class="co">#&gt;        Åpen flomfastmark Kystlynghei Sanddynemark</span>
<span class="co">#&gt;   2019                 3           0            0</span>
<span class="co">#&gt;   2020                 1           1            2</span>
<span class="co">#&gt;   2021                 3           0            0</span></code></pre></div>
<p>OK to treat as X’s NA’s.</p>
<p>This variable is used as a condition indicator, but it is perhaps strictly speaking a pressure indicator. Secondly, many semi-natural areas were fertilized, also in the reference condition. The people that made the meadows would probably not agree that a productive field/meadow has poor condition. This condition variable is therefor more directly tuned towards the maintenance of biodiversity.</p>
</div>
<div id="jb-ht-høsting-av-tresjiktet" class="section level3" number="5.8.14">
<h3>
<span class="header-section-number">5.8.14</span> 7JB-HT (Høsting av tresjiktet)<a class="anchor" aria-label="anchor" href="#jb-ht-h%C3%B8sting-av-tresjiktet"><i class="fas fa-link"></i></a>
</h3>
<p>Used for <em>Lauveng</em> in 2019 and 2020.</p>
<div class="sourceCode" id="cb276"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">dat2L</span><span class="op">[</span><span class="va">dat2L</span><span class="op">$</span><span class="va">NiN_variable_code</span> <span class="op">==</span> <span class="st">"7JB-HT-ST"</span> <span class="op">|</span> 
               <span class="va">dat2L</span><span class="op">$</span><span class="va">NiN_variable_code</span> <span class="op">==</span> <span class="st">"7JB-HT-SL"</span> ,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">temp</span><span class="op">$</span><span class="va">kartleggingsår</span>, <span class="va">temp</span><span class="op">$</span><span class="va">naturtype</span><span class="op">)</span>
<span class="co">#&gt;       </span>
<span class="co">#&gt;        Lauveng</span>
<span class="co">#&gt;   2019      14</span>
<span class="co">#&gt;   2020       8</span></code></pre></div>
<p>This is so marginal that I will exclude these already now.</p>
<div class="sourceCode" id="cb277"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exclude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">exclude</span>,
             <span class="st">"7JB-HT-SL"</span>,
             <span class="st">"7JB-HT-ST"</span><span class="op">)</span></code></pre></div>
</div>
<div id="jb-ku-kystlyngheias-utviklingsfaser" class="section level3" number="5.8.15">
<h3>
<span class="header-section-number">5.8.15</span> 7JB-KU (Kystlyngheias utviklingsfaser)<a class="anchor" aria-label="anchor" href="#jb-ku-kystlyngheias-utviklingsfaser"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>BY = byggefase</li>
<li>DE = degenereringsfase</li>
<li>MO = moden fase</li>
<li>PI = pionerfase</li>
</ul>
<p>This variable is used as in the <em>biodiversity assessment</em>, and can therefore not be used in the condition assessment because localities with <em>very poor</em> conditions have not been mapped/assessed.</p>
<div class="sourceCode" id="cb278"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exclude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">exclude</span>, 
             <span class="st">"7JB-KU-BY"</span>, 
             <span class="st">"7JB-KU-DE"</span>, 
             <span class="st">"7JB-KU-MO"</span>, 
             <span class="st">"7JB-KU-PI"</span><span class="op">)</span></code></pre></div>
<p>I will nonetheless explore this variable a bit more since this variable has been suggested previously as a condition variable.
NiN defines the possible values for these as numeric between 0 and 4 (shifted to become 1-5 in the data set), but there are 998 cases where it has been given then value <em>X</em>.</p>
<div class="sourceCode" id="cb279"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">dat2L</span><span class="op">[</span><span class="va">dat2L</span><span class="op">$</span><span class="va">ninbeskrivelsesvariabler</span> <span class="op">==</span> <span class="st">"7JB-KU-BY_X"</span> <span class="op">|</span>
                     <span class="va">dat2L</span><span class="op">$</span><span class="va">ninbeskrivelsesvariabler</span> <span class="op">==</span> <span class="st">"7JB-KU-DE_X"</span> <span class="op">|</span>
                <span class="va">dat2L</span><span class="op">$</span><span class="va">ninbeskrivelsesvariabler</span> <span class="op">==</span> <span class="st">"7JB-KU-MO_X"</span> <span class="op">|</span>
                     <span class="va">dat2L</span><span class="op">$</span><span class="va">ninbeskrivelsesvariabler</span> <span class="op">==</span> <span class="st">"7JB-KU-PI_X"</span>,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">temp</span><span class="op">$</span><span class="va">kartleggingsår</span>, <span class="va">temp</span><span class="op">$</span><span class="va">naturtype</span><span class="op">)</span>
<span class="co">#&gt;       </span>
<span class="co">#&gt;        Kystlynghei</span>
<span class="co">#&gt;   2018         510</span>
<span class="co">#&gt;   2019         132</span>
<span class="co">#&gt;   2020          21</span>
<span class="co">#&gt;   2021         326</span></code></pre></div>
<p>The reason could be that this variable is used in the biodiversity assessment, which is not performed if the condition is <em>very poor</em>, but the following table shows that the localities where this variable has been given the value X is spread across all condition scores:</p>
<div class="sourceCode" id="cb280"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">temp</span><span class="op">$</span><span class="va">tilstand</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Dårlig            God        Moderat Svært redusert </span>
<span class="co">#&gt;            181             72            727              9</span></code></pre></div>
<p>We can also make a note that a big proportion of the total number of localities of <em>Kystlynghei</em> had very poor (svært redusert) condition, and therefore this variable 7JB-KU was not recorded in a large proportion of the localities.</p>
<div class="sourceCode" id="cb281"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">KU</span> <span class="op">&lt;-</span> <span class="va">dat2</span><span class="op">[</span><span class="va">dat2</span><span class="op">$</span><span class="va">naturtype</span><span class="op">==</span><span class="st">"Kystlynghei"</span>,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">KU</span><span class="op">$</span><span class="va">tilstand</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-56"></span>
<img src="naturtype_files/figure-html/unnamed-chunk-56-1.png" alt="The distribution of condition scores for Kystlynghei." width="672"><p class="caption">
Figure 2.13: The distribution of condition scores for Kystlynghei.
</p>
</div>
<p>The percentage of localities with very poor condition is 23%.</p>
<p>Each <em>kystlynghei</em> locality should have values for all four parameters (7BA-BY/DE/MO/PI), but if we look at some cases in more detail, to understand why some of these values have been set as X (probably means they were left blank), for example like this:</p>
<div class="sourceCode" id="cb282"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#View(dat2L[dat2L$NiN_variable_code == "7JB-KU-BY" &amp; is.na(dat2L$NiN_variable_value),])</span>
<span class="co">#View(dat2L[dat2L$identifikasjon_lokalid =="NINFP1810002975",]) # None of the 7JB-KU variables have values</span>
<span class="co">#View(dat2L[dat2L$identifikasjon_lokalid =="NINFP2110057689",]) # Two of the 7JB-KU variables have values</span></code></pre></div>
<p>… we can see that sometimes &lt;4 but &gt;0 of the variables/phases has been given a score, but sometimes none have. This makes it problematic to set these NA’s to be zeros.</p>
<p>For this variable to be used in as an indicator for Ecological Condition in the future, the variable needs to be assessed for all localities, and the field protocol and/or field app needs to be revised to that it is not possible to record blank or NA values.</p>
</div>
<div id="ra-bh-and-7ra-sj-rask-suksesjon-i-boreal-hei-og-i-i-semi-naturlig-og-sterkt-endret-jordbruksmark-inkludert-våteng" class="section level3" number="5.8.16">
<h3>
<span class="header-section-number">5.8.16</span> 7RA-BH and 7RA-SJ (rask suksesjon i boreal hei og i i semi-naturlig og sterkt endret jordbruksmark inkludert våteng)<a class="anchor" aria-label="anchor" href="#ra-bh-and-7ra-sj-rask-suksesjon-i-boreal-hei-og-i-i-semi-naturlig-og-sterkt-endret-jordbruksmark-inkludert-v%C3%A5teng"><i class="fas fa-link"></i></a>
</h3>
<p>Condition variables.
There are some very few cases where 7RA-SJ has the value X. It should be numeric 1-4, so the value X is a mistake here I think. We can exclude these (i.e. allow them to be NA’s).</p>
</div>
<div id="sd-0-and-7sd--ns-natur--og-normalskogsdynamikk" class="section level3" number="5.8.17">
<h3>
<span class="header-section-number">5.8.17</span> 7SD-0 and 7SD- NS (Natur- og normalskogsdynamikk)<a class="anchor" aria-label="anchor" href="#sd-0-and-7sd--ns-natur--og-normalskogsdynamikk"><i class="fas fa-link"></i></a>
</h3>
<p>7SD-NS and 7SD-0 was also only used for only one nature type (which is not forest), and then only for wooded localities of <em>Flommyr, myrkant og myrskogsmark</em>. <em>X</em> therefore means <em>not relevant</em>, and we can also exclude the parameters from the dataset all together.</p>
<div class="sourceCode" id="cb283"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exclude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">exclude</span>, 
             <span class="st">"7SD-0"</span>,     
             <span class="st">"7SD-NS"</span><span class="op">)</span></code></pre></div>
</div>
<div id="tk-and-7se-kjørespor-slitasje" class="section level3" number="5.8.18">
<h3>
<span class="header-section-number">5.8.18</span> 7TK and 7SE (kjørespor &amp; slitasje)<a class="anchor" aria-label="anchor" href="#tk-and-7se-kj%C3%B8respor-slitasje"><i class="fas fa-link"></i></a>
</h3>
<p>7TK (kjørespor) and 7SE (slitasje) are not allowed the value X, but it happened on some rare occasions (24) anyhow. It’s fine to treat these as NA’s.</p>
</div>
<div id="vr-ri-reguleringsintensitet" class="section level3" number="5.8.19">
<h3>
<span class="header-section-number">5.8.19</span> 7VR-RI (Reguleringsintensitet)<a class="anchor" aria-label="anchor" href="#vr-ri-reguleringsintensitet"><i class="fas fa-link"></i></a>
</h3>
<p>This variable is defined as numeric between 1-5. There are, however, quite a few cases where it is X.</p>
<div class="sourceCode" id="cb284"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">dat2L</span><span class="op">[</span><span class="va">dat2L</span><span class="op">$</span><span class="va">ninbeskrivelsesvariabler</span> <span class="op">==</span> <span class="st">"7VR-RI_X"</span>,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">temp</span><span class="op">$</span><span class="va">kartleggingsår</span>, <span class="va">temp</span><span class="op">$</span><span class="va">naturtype</span><span class="op">)</span>
<span class="co">#&gt;       </span>
<span class="co">#&gt;        Åpen flomfastmark</span>
<span class="co">#&gt;   2019                96</span>
<span class="co">#&gt;   2020                 1</span>
<span class="co">#&gt;   2021                11</span></code></pre></div>
<p>I cannot explain these, but in any case, this variable is not a good indicator for condition as it rather represents a pressure/driver. So OK to treat as NA’s.</p>
<p><em>LKMs</em><br>
LKM’s (lokal kompleks miljøvariabel) are not relevant to us here.</p>
</div>
<div id="lkmki" class="section level3" number="5.8.20">
<h3>
<span class="header-section-number">5.8.20</span> LKMKI<a class="anchor" aria-label="anchor" href="#lkmki"><i class="fas fa-link"></i></a>
</h3>
<pre><code>+ Kalk (lime)
+ Exclude</code></pre>
</div>
<div id="lkmsp" class="section level3" number="5.8.21">
<h3>
<span class="header-section-number">5.8.21</span> LKMSP<a class="anchor" aria-label="anchor" href="#lkmsp"><i class="fas fa-link"></i></a>
</h3>
<pre><code>+ Slåttemarkspreg
+ Exclude</code></pre>
<p><em>MdirPR-variables</em>
These are Miljødirektoratets own variables (usually variations on existing NiN-variables)</p>
</div>
<div id="prak" class="section level3" number="5.8.22">
<h3>
<span class="header-section-number">5.8.22</span> PRAK<a class="anchor" aria-label="anchor" href="#prak"><i class="fas fa-link"></i></a>
</h3>
<pre><code>+ Antall NiN-kartleggingsenheter
+ Used in the biodiversity assessment
+ Exclude</code></pre>
</div>
<div id="pram" class="section level3" number="5.8.23">
<h3>
<span class="header-section-number">5.8.23</span> PRAM<a class="anchor" aria-label="anchor" href="#pram"><i class="fas fa-link"></i></a>
</h3>
<pre><code>+ Menneskeskapte objekter
+ Related to 5BY and 5AB
+ Exclude (see 5BY and 5AB)</code></pre>
</div>
<div id="prh" class="section level3" number="5.8.24">
<h3>
<span class="header-section-number">5.8.24</span> PRH<a class="anchor" aria-label="anchor" href="#prh"><i class="fas fa-link"></i></a>
</h3>
<pre><code>+ This is perhaps a mistake and should be PRHA or PRHT
+ Exclude</code></pre>
</div>
<div id="prha" class="section level3" number="5.8.25">
<h3>
<span class="header-section-number">5.8.25</span> PRHA<a class="anchor" aria-label="anchor" href="#prha"><i class="fas fa-link"></i></a>
</h3>
<pre><code>+ Habitat spesifikke arter
+ Used in the biodiversity assessment
+ Exclude</code></pre>
</div>
<div id="prht" class="section level3" number="5.8.26">
<h3>
<span class="header-section-number">5.8.26</span> PRHT<a class="anchor" aria-label="anchor" href="#prht"><i class="fas fa-link"></i></a>
</h3>
<pre><code>+ Høsting av tresjiktet</code></pre>
</div>
<div id="prka" class="section level3" number="5.8.27">
<h3>
<span class="header-section-number">5.8.27</span> PRKA<a class="anchor" aria-label="anchor" href="#prka"><i class="fas fa-link"></i></a>
</h3>
<pre><code>+ Kalkindikatorer
+ Used in the biodiversity assessment
+ Exclude</code></pre>
</div>
<div id="prku" class="section level3" number="5.8.28">
<h3>
<span class="header-section-number">5.8.28</span> PRKU<a class="anchor" aria-label="anchor" href="#prku"><i class="fas fa-link"></i></a>
</h3>
<pre><code>+ Kystlyngheias utviklingsfaser
+ Related to 7JB-KU
+ Used in the biodiversity assessment
+ Exclude</code></pre>
</div>
<div id="prmy" class="section level3" number="5.8.29">
<h3>
<span class="header-section-number">5.8.29</span> PRMY<a class="anchor" aria-label="anchor" href="#prmy"><i class="fas fa-link"></i></a>
</h3>
<pre><code>+ Myrstruktur
+ Used in the biodiversity assessment
+ Exclude</code></pre>
</div>
<div id="prrl-crddenntvu" class="section level3" number="5.8.30">
<h3>
<span class="header-section-number">5.8.30</span> PRRL-CR/DD/EN/NT/VU<a class="anchor" aria-label="anchor" href="#prrl-crddenntvu"><i class="fas fa-link"></i></a>
</h3>
<pre><code>+ Red list categories
+ Used in the biodiversity assessment
+ Exclude</code></pre>
</div>
<div id="prse-ka" class="section level3" number="5.8.31">
<h3>
<span class="header-section-number">5.8.31</span> PRSE-KA<a class="anchor" aria-label="anchor" href="#prse-ka"><i class="fas fa-link"></i></a>
</h3>
<pre><code>+ Strukturer, elementer og torvmarksformer (in 2018)
+ See PRSE-PA</code></pre>
</div>
<div id="prse-pa" class="section level3" number="5.8.32">
<h3>
<span class="header-section-number">5.8.32</span> PRSE-PA<a class="anchor" aria-label="anchor" href="#prse-pa"><i class="fas fa-link"></i></a>
</h3>
<pre><code>+ Strukturer, elementer og torvmarksformer
+ Used in the biodiversity assessment
+ Exclude</code></pre>
</div>
<div id="prse-sh" class="section level3" number="5.8.33">
<h3>
<span class="header-section-number">5.8.33</span> PRSE-SH<a class="anchor" aria-label="anchor" href="#prse-sh"><i class="fas fa-link"></i></a>
</h3>
<pre><code>+ Strukturer, elementer og torvmarksformer (in 2018)
+ See PRSE-PA</code></pre>
</div>
<div id="prsl" class="section level3" number="5.8.34">
<h3>
<span class="header-section-number">5.8.34</span> PRSL<a class="anchor" aria-label="anchor" href="#prsl"><i class="fas fa-link"></i></a>
</h3>
<pre><code>+ Slitasje
+ Related to 7SE</code></pre>
</div>
<div id="prtk" class="section level3" number="5.8.35">
<h3>
<span class="header-section-number">5.8.35</span> PRTK<a class="anchor" aria-label="anchor" href="#prtk"><i class="fas fa-link"></i></a>
</h3>
<pre><code>+ Spor av tunge kjøretøyer
+ Related to 7TK</code></pre>
</div>
<div id="prto" class="section level3" number="5.8.36">
<h3>
<span class="header-section-number">5.8.36</span> PRTO<a class="anchor" aria-label="anchor" href="#prto"><i class="fas fa-link"></i></a>
</h3>
<pre><code>+ Torvuttak
+ Strictly speaking a pressure variable</code></pre>
</div>
<div id="prvs" class="section level3" number="5.8.37">
<h3>
<span class="header-section-number">5.8.37</span> PRVS<a class="anchor" aria-label="anchor" href="#prvs"><i class="fas fa-link"></i></a>
</h3>
<pre><code>+ Variasjon i vannsprutintensitet
+ Used in the biodiversity assessment
+ Exclude</code></pre>
<div class="sourceCode" id="cb303"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exclude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">exclude</span>,
             <span class="st">"LKMKI"</span>,     
          <span class="st">"LKMSP"</span>,
          <span class="st">"PRAK"</span>,
          <span class="st">"PRAM"</span>,
          <span class="st">"PRH"</span>,
          <span class="st">"PRHA"</span>,
          <span class="st">"PRKA"</span>,
          <span class="st">"PRKU"</span>,
          <span class="st">"PRMY"</span>,
          <span class="st">"PRRL-DD"</span>,   <span class="st">"PRRL-VU"</span>,   <span class="st">"PRRL-NT"</span>,   <span class="st">"PRRL-EN"</span>,   <span class="st">"PRRL-CR"</span>,  
          <span class="st">"PRSE-KA"</span>,
          <span class="st">"PRSE-PA"</span>,
          <span class="st">"PRSE-SH"</span>,
          <span class="st">"PRVS"</span>
          <span class="op">)</span></code></pre></div>
</div>
</div>
<div id="subset" class="section level2" number="5.9">
<h2>
<span class="header-section-number">5.9</span> Subset<a class="anchor" aria-label="anchor" href="#subset"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb304"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Exclude NAs</span>
<span class="va">dat2L2</span> <span class="op">&lt;-</span> <span class="va">dat2L</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">dat2L</span><span class="op">$</span><span class="va">NiN_variable_value</span><span class="op">)</span>,<span class="op">]</span>

<span class="co"># Exclude selected NiN variables </span>
<span class="va">dat2L2</span> <span class="op">&lt;-</span> <span class="va">dat2L2</span><span class="op">[</span><span class="va">dat2L2</span><span class="op">$</span><span class="va">NiN_variable_code</span> <span class="op">%!in%</span> <span class="va">exclude</span>,<span class="op">]</span></code></pre></div>
<p>Now we are now down to 20 possible condition variables.</p>
<p><code>dat2L2</code> includes only the three target ecosystems. Hule eiker are excluded. Mosaics are included. Several non-relevant NiN variables are excluded. The localities are duplicated in as many rows as there are NiN variables for that locality.</p>
</div>
<div id="combine-naturetypes-nin-variables-and-nin-main-types" class="section level2" number="5.10">
<h2>
<span class="header-section-number">5.10</span> Combine Naturetypes, NiN variables and NiN main types<a class="anchor" aria-label="anchor" href="#combine-naturetypes-nin-variables-and-nin-main-types"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb305"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ntyp_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dat2L2</span><span class="op">$</span><span class="va">naturtype</span>, <span class="va">dat2L2</span><span class="op">$</span><span class="va">NiN_variable_code</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">ntyp_vars</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Nature_type"</span>, <span class="st">"NiN_variable_code"</span>, <span class="st">"NiN_variable_count"</span><span class="op">)</span>
<span class="va">ntyp_vars</span> <span class="op">&lt;-</span> <span class="va">ntyp_vars</span><span class="op">[</span><span class="va">ntyp_vars</span><span class="op">$</span><span class="va">NiN_variable_count</span> <span class="op">&gt;</span><span class="fl">0</span>,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ntyp_vars</span><span class="op">)</span>
<span class="co">#&gt;                                          Nature_type</span>
<span class="co">#&gt; 3   Åpen grunnlendt kalkrik mark i boreonemoral sone</span>
<span class="co">#&gt; 16                                          Hagemark</span>
<span class="co">#&gt; 28                                    Naturbeitemark</span>
<span class="co">#&gt; 69                                          Hagemark</span>
<span class="co">#&gt; 79                                           Lauveng</span>
<span class="co">#&gt; 144                                Semi-naturlig myr</span>
<span class="co">#&gt;     NiN_variable_code NiN_variable_count</span>
<span class="co">#&gt; 3             1AG-A-0                 41</span>
<span class="co">#&gt; 16            1AG-A-0                348</span>
<span class="co">#&gt; 28            1AG-A-0                  1</span>
<span class="co">#&gt; 69            1AG-A-E               1445</span>
<span class="co">#&gt; 79            1AG-A-E                 11</span>
<span class="co">#&gt; 144           1AG-A-G                693</span></code></pre></div>
<p>Add a column for the total number of localities for each nature type and get the percentage of localities where each NiN main type has been recorded.</p>
<div class="sourceCode" id="cb306"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#options(scipen=999) # suppress exp notation</span>
<span class="va">count</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dat2</span><span class="op">$</span><span class="va">naturtype</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Nature_type"</span>, <span class="st">"totalLocations"</span><span class="op">)</span>
<span class="va">ntyp_vars</span><span class="op">$</span><span class="va">totalLocations</span> <span class="op">&lt;-</span> <span class="va">count</span><span class="op">$</span><span class="va">totalLocations</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="va">ntyp_vars</span><span class="op">$</span><span class="va">Nature_type</span>, <span class="va">count</span><span class="op">$</span><span class="va">Nature_type</span><span class="op">)</span><span class="op">]</span>
<span class="va">ntyp_vars</span><span class="op">$</span><span class="va">percentageUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="va">ntyp_vars</span><span class="op">$</span><span class="va">NiN_variable_count</span><span class="op">/</span><span class="va">ntyp_vars</span><span class="op">$</span><span class="va">totalLocations</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p>Cast to get NiN codes as columns</p>
<div class="sourceCode" id="cb307"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># should switch to pivot_wider</span>
<span class="va">ntyp_vars_wide</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/dcast.data.table.html">dcast</a></span><span class="op">(</span><span class="fu">setDT</span><span class="op">(</span><span class="va">ntyp_vars</span><span class="op">)</span>,
                                    <span class="va">Nature_type</span><span class="op">~</span><span class="va">NiN_variable_code</span>,
                                    value.var <span class="op">=</span> <span class="st">"percentageUse"</span><span class="op">)</span></code></pre></div>
<p>This data set contains the nature types that were only mapped in 2018 or 2019, and which we removed from ntypDF2. Let’s exclude these nature types now</p>
<div class="sourceCode" id="cb308"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ntyp_vars_wide</span> <span class="op">&lt;-</span> <span class="va">ntyp_vars_wide</span><span class="op">[</span><span class="va">ntyp_vars_wide</span><span class="op">$</span><span class="va">Nature_type</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span><span class="op">]</span></code></pre></div>
<p>Combine datasets</p>
<div class="sourceCode" id="cb309"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ntyp_fill</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">ntypDF2</span>, <span class="va">ntyp_vars_wide</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="va">ntypDF2</span><span class="op">$</span><span class="va">Nature_type</span>, <span class="va">ntyp_vars_wide</span><span class="op">$</span><span class="va">Nature_type</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div id="add-number-of-location-and-total-area-mapped" class="section level3" number="5.10.1">
<h3>
<span class="header-section-number">5.10.1</span> Add number of location and total area mapped<a class="anchor" aria-label="anchor" href="#add-number-of-location-and-total-area-mapped"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb310"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat2</span><span class="op">$</span><span class="va">km2</span> <span class="op">&lt;-</span> <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/units/man/drop_units.html">drop_units</a></span><span class="op">(</span><span class="va">dat2</span><span class="op">$</span><span class="va">area</span><span class="op">/</span><span class="fl">10</span><span class="op">^</span><span class="fl">6</span><span class="op">)</span>

<span class="va">num</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">dat2</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">naturtype</span><span class="op">)</span><span class="op">%&gt;%</span>
  <span class="fu">summarise</span><span class="op">(</span>km2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">km2</span><span class="op">)</span>,
            numberOfLocalities <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="va">ntyp_fill</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">ntyp_fill</span>, <span class="va">num</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="va">ntyp_fill</span><span class="op">$</span><span class="va">Nature_type</span>, <span class="va">num</span><span class="op">$</span><span class="va">naturtype</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="plots" class="section level2" number="5.11">
<h2>
<span class="header-section-number">5.11</span> Plots<a class="anchor" aria-label="anchor" href="#plots"><i class="fas fa-link"></i></a>
</h2>
<div id="the-total-mapped-area" class="section level3" number="5.11.1">
<h3>
<span class="header-section-number">5.11.1</span> The total mapped area<a class="anchor" aria-label="anchor" href="#the-total-mapped-area"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb311"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">mySize</span> <span class="op">&lt;-</span> <span class="fl">8</span>
<span class="va">gg_area</span> <span class="op">&lt;-</span> <span class="va">ntyp_fill</span> <span class="op">%&gt;%</span>
  <span class="fu">arrange</span><span class="op">(</span><span class="va">km2</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>Nature_type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">Nature_type</span>, levels<span class="op">=</span><span class="va">Nature_type</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>   <span class="co"># This trick update the factor levels</span>
  <span class="fu">ggplot</span><span class="op">(</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Nature_type</span>,
                   y <span class="op">=</span> <span class="va">km2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
        <span class="fu">geom_segment</span><span class="op">(</span> <span class="fu">aes</span><span class="op">(</span>xend<span class="op">=</span><span class="va">Nature_type</span>, yend<span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
        <span class="fu">geom_point</span><span class="op">(</span> size<span class="op">=</span><span class="fl">4</span>, <span class="fu">aes</span><span class="op">(</span>group <span class="op">=</span> <span class="va">Ecosystem</span>,
                                colour<span class="op">=</span> <span class="va">Ecosystem</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
        <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
        <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="va">mySize</span><span class="op">)</span> <span class="op">+</span>
        <span class="fu">xlab</span><span class="op">(</span><span class="st">""</span><span class="op">)</span><span class="op">+</span>
        <span class="fu">ylab</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">km</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
      <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span>,
        legend.key.size <span class="op">=</span>  <span class="fu">unit</span><span class="op">(</span><span class="fl">.05</span>, <span class="st">'cm'</span><span class="op">)</span>,
            legend.background <span class="op">=</span> <span class="fu">element_rect</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>
            <span class="op">)</span>

<span class="va">gg_locs</span> <span class="op">&lt;-</span> <span class="va">ntyp_fill</span> <span class="op">%&gt;%</span>
  <span class="fu">arrange</span><span class="op">(</span><span class="va">km2</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>Nature_type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">Nature_type</span>, levels<span class="op">=</span><span class="va">Nature_type</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>    <span class="co"># also sorted after km2</span>
  <span class="fu">ggplot</span><span class="op">(</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Nature_type</span>,
                   y <span class="op">=</span> <span class="va">numberOfLocalities</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
        <span class="fu">geom_segment</span><span class="op">(</span> <span class="fu">aes</span><span class="op">(</span>xend<span class="op">=</span><span class="va">Nature_type</span>, yend<span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
        <span class="fu">geom_point</span><span class="op">(</span> size<span class="op">=</span><span class="fl">4</span>, <span class="fu">aes</span><span class="op">(</span>group <span class="op">=</span> <span class="va">Ecosystem</span>,
                                colour<span class="op">=</span> <span class="va">Ecosystem</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
        <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
        <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="va">mySize</span><span class="op">)</span> <span class="op">+</span>
        <span class="fu">xlab</span><span class="op">(</span><span class="st">""</span><span class="op">)</span><span class="op">+</span>
        <span class="fu">ylab</span><span class="op">(</span><span class="st">"Number of localities"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,
        axis.text.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>


<span class="fu">egg</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/egg/man/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">gg_area</span>, <span class="va">gg_locs</span>, 
                        ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-68"></span>
<img src="naturtype_files/figure-html/unnamed-chunk-68-1.png" alt="The total mapped area for nature types associated with three selected main ecosystems" width="672"><p class="caption">
Figure 5.11: The total mapped area for nature types associated with three selected main ecosystems
</p>
</div>
</div>
<div id="area-of-localities-per-nin-main-type" class="section level3" number="5.11.2">
<h3>
<span class="header-section-number">5.11.2</span> Area of localities per NiN main type<a class="anchor" aria-label="anchor" href="#area-of-localities-per-nin-main-type"><i class="fas fa-link"></i></a>
</h3>
<p>First I will add the NiN main types that are not covered by any nature types.</p>
<div class="sourceCode" id="cb312"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">open</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="st">"T1"</span>,
  <span class="st">"T2"</span>,
  <span class="st">"T6"</span>,
  <span class="st">"T8"</span>,
  <span class="st">"T11"</span>,
  <span class="st">"T12"</span>,
  <span class="st">"T13"</span>,
  <span class="st">"T15"</span>,
  <span class="st">"T16"</span>,
  <span class="st">"T17"</span>,
  <span class="st">"T18"</span>,
  <span class="st">"T20"</span>,
  <span class="st">"T21"</span>,
  <span class="st">"T23"</span>,
  <span class="st">"T24"</span>,
  <span class="st">"T25"</span>,
  <span class="st">"T26"</span>,
  <span class="st">"T27"</span>,
  <span class="st">"T29"</span>
<span class="op">)</span>

<span class="va">semi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="st">"T31"</span>,
  <span class="st">"T32"</span>,
  <span class="st">"T33"</span>,
  <span class="st">"T34"</span>,
  <span class="st">"T40"</span>,  <span class="co"># are these included</span>
  <span class="st">"T41"</span>   <span class="co"># are these included</span>
<span class="op">)</span>

<span class="va">wetland</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="st">"V1"</span>,
  <span class="st">"V3"</span>,
  <span class="st">"V4"</span>,
  <span class="st">"V6"</span>,
  <span class="st">"V9"</span>,
  <span class="st">"V10"</span>,
  <span class="st">"L4"</span>    <span class="co"># this will probably not be part of the assessments</span>
  
<span class="op">)</span></code></pre></div>
<p>Adding the non-mapped open types</p>
<div class="sourceCode" id="cb313"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">open</span><span class="op">[</span><span class="va">open</span> <span class="op">%!in%</span> <span class="va">ntyp_fill</span><span class="op">$</span><span class="va">NiN_mainType</span><span class="op">]</span>
<span class="co">#&gt; [1] "T6"  "T11" "T13" "T16" "T23" "T24" "T25" "T26" "T27"</span></code></pre></div>
<div class="sourceCode" id="cb314"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ntyp_fill2</span> <span class="op">&lt;-</span> <span class="va">ntyp_fill</span> <span class="op">%&gt;%</span>
  <span class="fu">add_row</span><span class="op">(</span>NiN_mainType <span class="op">=</span> <span class="st">"T6"</span>, Ecosystem <span class="op">=</span> <span class="st">"Naturlig åpne områder under skoggrensa"</span>, NiN_mainTypeCoverage <span class="op">=</span> <span class="st">"Not mapped"</span>, km2 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">add_row</span><span class="op">(</span>NiN_mainType <span class="op">=</span> <span class="st">"T11"</span>, Ecosystem <span class="op">=</span> <span class="st">"Naturlig åpne områder under skoggrensa"</span>, NiN_mainTypeCoverage <span class="op">=</span> <span class="st">"Not mapped"</span>, km2 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">add_row</span><span class="op">(</span>NiN_mainType <span class="op">=</span> <span class="st">"T13"</span>, Ecosystem <span class="op">=</span> <span class="st">"Naturlig åpne områder under skoggrensa"</span>, NiN_mainTypeCoverage <span class="op">=</span> <span class="st">"Not mapped"</span>, km2 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">add_row</span><span class="op">(</span>NiN_mainType <span class="op">=</span> <span class="st">"T16"</span>, Ecosystem <span class="op">=</span> <span class="st">"Naturlig åpne områder under skoggrensa"</span>, NiN_mainTypeCoverage <span class="op">=</span> <span class="st">"Not mapped"</span>, km2 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">add_row</span><span class="op">(</span>NiN_mainType <span class="op">=</span> <span class="st">"T23"</span>, Ecosystem <span class="op">=</span> <span class="st">"Naturlig åpne områder under skoggrensa"</span>, NiN_mainTypeCoverage <span class="op">=</span> <span class="st">"Not mapped"</span>, km2 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">add_row</span><span class="op">(</span>NiN_mainType <span class="op">=</span> <span class="st">"T24"</span>, Ecosystem <span class="op">=</span> <span class="st">"Naturlig åpne områder under skoggrensa"</span>, NiN_mainTypeCoverage <span class="op">=</span> <span class="st">"Not mapped"</span>, km2 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">add_row</span><span class="op">(</span>NiN_mainType <span class="op">=</span> <span class="st">"T25"</span>, Ecosystem <span class="op">=</span> <span class="st">"Naturlig åpne områder under skoggrensa"</span>, NiN_mainTypeCoverage <span class="op">=</span> <span class="st">"Not mapped"</span>, km2 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">add_row</span><span class="op">(</span>NiN_mainType <span class="op">=</span> <span class="st">"T26"</span>, Ecosystem <span class="op">=</span> <span class="st">"Naturlig åpne områder under skoggrensa"</span>, NiN_mainTypeCoverage <span class="op">=</span> <span class="st">"Not mapped"</span>, km2 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">add_row</span><span class="op">(</span>NiN_mainType <span class="op">=</span> <span class="st">"T27"</span>, Ecosystem <span class="op">=</span> <span class="st">"Naturlig åpne områder under skoggrensa"</span>, NiN_mainTypeCoverage <span class="op">=</span> <span class="st">"Not mapped"</span>, km2 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> </code></pre></div>
<p>Adding the non-mapped semi-natural types</p>
<div class="sourceCode" id="cb315"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">semi</span><span class="op">[</span><span class="va">semi</span> <span class="op">%!in%</span> <span class="va">ntyp_fill</span><span class="op">$</span><span class="va">NiN_mainType</span><span class="op">]</span>
<span class="co">#&gt; [1] "T40"</span></code></pre></div>
<div class="sourceCode" id="cb316"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ntyp_fill2</span> <span class="op">&lt;-</span> <span class="va">ntyp_fill2</span> <span class="op">%&gt;%</span>
  <span class="fu">add_row</span><span class="op">(</span>NiN_mainType <span class="op">=</span> <span class="st">"T40"</span>, Ecosystem <span class="op">=</span> <span class="st">"Semi-naturlig mark"</span>, NiN_mainTypeCoverage <span class="op">=</span> <span class="st">"Not mapped"</span>, km2 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<p>Adding the non-mapped wetland types</p>
<div class="sourceCode" id="cb317"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wetland</span><span class="op">[</span><span class="va">wetland</span> <span class="op">%!in%</span> <span class="va">ntyp_fill</span><span class="op">$</span><span class="va">NiN_mainType</span><span class="op">]</span>
<span class="co">#&gt; [1] "V6"</span></code></pre></div>
<p>V6 is <em>Våtsnøleie</em>, and my guess is that it <em>is</em> mapped, but grouped with the alpine ecosystem. I’ll therefore not add it in here, but mention it in the figure caption below.</p>
<div class="sourceCode" id="cb318"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mySize</span> <span class="op">&lt;-</span> <span class="fl">10</span>
<span class="va">ntyp_fill2</span> <span class="op">%&gt;%</span>
  <span class="co"># combining two classes to get a better colour palette</span>
  <span class="fu">mutate</span><span class="op">(</span>NiN_mainTypeCoverage <span class="op">=</span> 
           <span class="fu"><a href="https://rdrr.io/r/base/replace.html">replace</a></span><span class="op">(</span><span class="va">NiN_mainTypeCoverage</span>, <span class="va">NiN_mainTypeCoverage</span> <span class="op">==</span> <span class="st">"southern"</span>, <span class="st">"partial"</span><span class="op">)</span>,
         NiN_mainTypeCoverage <span class="op">=</span> 
           <span class="fu"><a href="https://rdrr.io/r/base/replace.html">replace</a></span><span class="op">(</span><span class="va">NiN_mainTypeCoverage</span>, <span class="va">NiN_mainTypeCoverage</span> <span class="op">==</span> <span class="st">"calcareous and dry"</span>, <span class="st">"calcareous"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  
  <span class="fu">group_by</span><span class="op">(</span><span class="va">NiN_mainType</span>, <span class="va">NiN_mainTypeCoverage</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>km2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">km2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">slice_head</span><span class="op">(</span><span class="op">)</span><span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="va">Ecosystem</span>,
         <span class="va">NiN_mainType</span>,
         <span class="va">NiN_mainTypeCoverage</span>,
         <span class="va">km2</span><span class="op">)</span><span class="op">%&gt;%</span>
  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>NiN_mainType <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html">fct_reorder</a></span><span class="op">(</span><span class="va">NiN_mainType</span>, <span class="va">km2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">NiN_mainType</span>,
             y <span class="op">=</span> <span class="va">km2</span>,
             fill <span class="op">=</span> <span class="va">NiN_mainTypeCoverage</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>,
             colour <span class="op">=</span> <span class="st">"grey40"</span>,
             position <span class="op">=</span> <span class="st">"stack"</span><span class="op">)</span><span class="op">+</span>
    <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="va">mySize</span><span class="op">)</span><span class="op">+</span>
    <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"NiN main type"</span>,
       y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">km</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,
       fill <span class="op">=</span> <span class="st">"Spatial coverage"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">scale_fill_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">Ecosystem</span><span class="op">)</span>,
             scales <span class="op">=</span> <span class="st">"free"</span>,
             labeller <span class="op">=</span> <span class="fu">label_wrap_gen</span><span class="op">(</span>width<span class="op">=</span><span class="fl">25</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-75"></span>
<img src="naturtype_files/figure-html/unnamed-chunk-75-1.png" alt="The areas mapped for each NiN main type, and the degree of spatial representativity (or coverage) of the mapping units (nature types). V6 Våtsnøleie og snøleiekilde is not included." width="672"><p class="caption">
Figure 3.10: The areas mapped for each NiN main type, and the degree of spatial representativity (or coverage) of the mapping units (nature types). V6 Våtsnøleie og snøleiekilde is not included.
</p>
</div>
</div>
<div id="number-of-localities-per-nin-main-type" class="section level3" number="5.11.3">
<h3>
<span class="header-section-number">5.11.3</span> Number of localities per NiN main type<a class="anchor" aria-label="anchor" href="#number-of-localities-per-nin-main-type"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb319"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mySize</span> <span class="op">&lt;-</span> <span class="fl">10</span>
<span class="va">ntyp_fill2</span> <span class="op">%&gt;%</span>
  <span class="co"># combining two classes to get a better colour palette</span>
  <span class="fu">mutate</span><span class="op">(</span>NiN_mainTypeCoverage <span class="op">=</span> 
           <span class="fu"><a href="https://rdrr.io/r/base/replace.html">replace</a></span><span class="op">(</span><span class="va">NiN_mainTypeCoverage</span>, <span class="va">NiN_mainTypeCoverage</span> <span class="op">==</span> <span class="st">"southern"</span>, <span class="st">"partial"</span><span class="op">)</span>,
         NiN_mainTypeCoverage <span class="op">=</span> 
           <span class="fu"><a href="https://rdrr.io/r/base/replace.html">replace</a></span><span class="op">(</span><span class="va">NiN_mainTypeCoverage</span>, <span class="va">NiN_mainTypeCoverage</span> <span class="op">==</span> <span class="st">"calcareous and dry"</span>, <span class="st">"calcareous"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  
  <span class="fu">group_by</span><span class="op">(</span><span class="va">NiN_mainType</span>, <span class="va">NiN_mainTypeCoverage</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">numberOfLocalities</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">slice_head</span><span class="op">(</span><span class="op">)</span><span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="va">Ecosystem</span>,
         <span class="va">NiN_mainType</span>,
         <span class="va">NiN_mainTypeCoverage</span>,
         <span class="va">count</span><span class="op">)</span><span class="op">%&gt;%</span>
  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>count <span class="op">=</span> <span class="fu">replace_na</span><span class="op">(</span><span class="va">count</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>NiN_mainType <span class="op">=</span> <span class="fu">fct_reorder</span><span class="op">(</span><span class="va">NiN_mainType</span>, <span class="va">count</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">NiN_mainType</span>,
             y <span class="op">=</span> <span class="va">count</span>,
             fill <span class="op">=</span> <span class="va">NiN_mainTypeCoverage</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>,
             colour <span class="op">=</span> <span class="st">"grey40"</span>,
             position <span class="op">=</span> <span class="st">"stack"</span><span class="op">)</span><span class="op">+</span>
    <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="va">mySize</span><span class="op">)</span><span class="op">+</span>
    <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"NiN main type"</span>,
       y <span class="op">=</span> <span class="st">"Number of localities"</span>,
       fill <span class="op">=</span> <span class="st">"Spatial coverage"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">scale_fill_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">Ecosystem</span><span class="op">)</span>,
             scales <span class="op">=</span> <span class="st">"free"</span>,
             labeller <span class="op">=</span> <span class="fu">label_wrap_gen</span><span class="op">(</span>width<span class="op">=</span><span class="fl">25</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-76"></span>
<img src="naturtype_files/figure-html/unnamed-chunk-76-1.png" alt="The number of localities mapped for each NiN main type, and the degree of spatial representativity (or coverage) of the mapping units (nature types). V6 Våtsnøleie og snøleiekilde is not included. NiN main types are arranged rougly by decreasing order, except for types that are not mapped at all, which are arranged on top." width="672"><p class="caption">
Figure 2.19: The number of localities mapped for each NiN main type, and the degree of spatial representativity (or coverage) of the mapping units (nature types). V6 Våtsnøleie og snøleiekilde is not included. NiN main types are arranged rougly by decreasing order, except for types that are not mapped at all, which are arranged on top.
</p>
</div>
<p>From the figure above I take that <em>Naturlig åpne områder</em> is very poorly represented in general as there are many NiN main types that are completely missing from the dataset. The three most common types by area, however, have complete thematic coverage (if excluding the year 2018 and including all sub-types). I will need to investigate especially if there are some NiN variables for the nature types mapping T18 Åpen flomfastmark, T12 Strandeng and T21 Sanddynemark which we can use.</p>
<p>For <em>Semi-naturlig mark</em> we have quite good thematic coverage for the three main types (by area). The other three types probably makes up a considerably smaller area, but note that T33 has some coverage, and is classes as <em>all (-2018)</em>. Of the three main ecosystems, semi-naturlig mark dominates clearly in ters of area and in terms of number of localities.</p>
<p>For <em>Våtmark</em> we have good thematic coverage for V3 nedbørsmyr and V9 semi-naturlig myr, but for V1 åpen jordvassmyr only calcareous localities are mapped and assessed. A question is then whether, for a given NiN variable, that calcareous localities can be representative for all mires (poor and rich) or if this will introduce too much bias in one way or another. Another important bias for this main ecosystem is related to the lower size limit for mapping units (MMU), which is quite big for V3. We need to think about whether small bogs are more or less prone to different pressures compared to big bogs.</p>
</div>
<div id="commonness-of-nin-variables" class="section level3" number="5.11.4">
<h3>
<span class="header-section-number">5.11.4</span> Commonness of NiN variables<a class="anchor" aria-label="anchor" href="#commonness-of-nin-variables"><i class="fas fa-link"></i></a>
</h3>
<p>I want to see how common the different NiN variables are, and if we can use this to select core variables (kjernevariabler).</p>
<p>First I will get the total area mappe per main ecosystem</p>
<div class="sourceCode" id="cb320"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">areaSum</span> <span class="op">&lt;-</span> <span class="va">ntyp_fill2</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Ecosystem</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise</span><span class="op">(</span>km2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">km2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span>.before<span class="op">=</span><span class="fl">1</span>,
                     NiN_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Combined"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb321"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ntyp_fill2</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">ntyp_vars</span><span class="op">$</span><span class="va">NiN_variable_code</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">drop_na</span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">rename</span><span class="op">(</span>NiN_code <span class="op">=</span> <span class="va">name</span>,
         useFrequency <span class="op">=</span> <span class="va">value</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">useFrequency</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">NiN_code</span>, <span class="va">Ecosystem</span>, <span class="va">NiN_mainType</span><span class="op">)</span> <span class="op">%&gt;%</span>  <span class="co"># NiN main type could be replaced with Nature_type</span>
  <span class="fu">summarise</span><span class="op">(</span>km2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">km2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  
  <span class="co"># create a truncated fill variable </span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Ecosystem</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>myFill <span class="op">=</span> <span class="fu">fct_lump</span><span class="op">(</span><span class="va">NiN_mainType</span>, <span class="fl">3</span>, w <span class="op">=</span> <span class="va">km2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  
  <span class="co"># qick fix to sort variable across facets (dont work after adding 'Nature_type' in the first group_by)</span>
  <span class="co">#mutate(lab = paste(NiN_code, substr(Ecosystem, start = 1, stop = 1), sep = " ")) %&gt;%</span>
  <span class="co">#ungroup()%&gt;%</span>
  <span class="co">#mutate(lab = forcats::fct_reorder(lab, km2)) %&gt;%</span>
  
  
  <span class="co"># plot</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">NiN_code</span>,
              y <span class="op">=</span> <span class="va">km2</span>,
             fill <span class="op">=</span> <span class="va">myFill</span>
                <span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>,
           colour <span class="op">=</span> <span class="st">"grey40"</span>,
           <span class="co">#fill = "grey80",</span>
           position <span class="op">=</span> <span class="st">"stack"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_hline</span><span class="op">(</span>data <span class="op">=</span> <span class="va">areaSum</span>,
             <span class="fu">aes</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">km2</span><span class="op">)</span>,
             colour <span class="op">=</span> <span class="st">"red"</span>,
             linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">Ecosystem</span><span class="op">)</span>,
             scales <span class="op">=</span> <span class="st">"free"</span>,
             labeller <span class="op">=</span> <span class="fu">label_wrap_gen</span><span class="op">(</span>width<span class="op">=</span><span class="fl">25</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>,
       y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">km</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,
       fill <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">scale_fill_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="va">mySize</span><span class="op">)</span>
<span class="co">#&gt; `summarise()` has grouped output by 'NiN_code',</span>
<span class="co">#&gt; 'Ecosystem'. You can override using the `.groups` argument.</span>
<span class="co">#&gt; Warning in RColorBrewer::brewer.pal(n, pal): n too large, allowed maximum for palette Set1 is 9</span>
<span class="co">#&gt; Returning the palette you asked for with that many colors</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-78"></span>
<img src="naturtype_files/figure-html/unnamed-chunk-78-1.png" alt="Barplot showing the proportion area for which each NiN variable is recorded. The total mapped area for each main ecosystem (the facets) is shown as a dashed red line. The three most dominant NiN main types for each ecosystem is given a uniqe colour, and all the remaining are grouped as 'other'." width="672"><p class="caption">
Figure 5.12: Barplot showing the proportion area for which each NiN variable is recorded. The total mapped area for each main ecosystem (the facets) is shown as a dashed red line. The three most dominant NiN main types for each ecosystem is given a uniqe colour, and all the remaining are grouped as ‘other.’
</p>
</div>
<p>This figure, in combination with the above, points to he most obvious NiN variable candidates.</p>
<p>7SE and 7TK are good candidates for <em>Naturlig åpne områder</em>. 7JA-BT is probably more appropriately classed as a pressure indicator. Same with 7VR-RI with is recorded for all T18 localities.</p>
<p>The same two variables (7SE and 7TK) are the best candidates also for <em>Semi-natural areas</em>. 7JB-BT is a pressure variable (<em>beitetrykk</em>). 7RA-SJ/BH are related to <em>gjengoing</em> which will be covered by another indicator informed from remote sensing (LiDAR), and we therefor don’t need to describe this with a field-based indicator as well.</p>
<p>For <em>Våtmark</em>, 7GR-Gi is the most common variables, but this is a pressure variable (<em>grøfting</em>). But, perhaps it could be used as a surrogate indicator. I think this is justifiable, especially since the relationship between the pressure (grøfting) and the condition (hydrology) is so well known. 7SE+PRSL and 7TK+PRTK are other good candidates. PRTO is only relevant for V3, but covers a relatively large area. It is, however,, more like a pressure indicator.</p>
</div>
</div>
<div id="tables" class="section level2" number="5.12">
<h2>
<span class="header-section-number">5.12</span> Tables<a class="anchor" aria-label="anchor" href="#tables"><i class="fas fa-link"></i></a>
</h2>
<p>Here are some output tables with numbers the numbers underlying the above figures.</p>
<div class="sourceCode" id="cb322"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="va">ntyp_fill2</span>,
              <span class="co">#extensions = "FixedColumns",</span>
  options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    scrollX <span class="op">=</span> <span class="cn">T</span>,
    scrollY<span class="op">=</span><span class="cn">T</span>,
    pageLength <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-79"></span>
<div id="htmlwidget-9368fb52a74fbd600185" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-9368fb52a74fbd600185">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54"],["Slåttemark","Kystlynghei","Naturbeitemark","Slåttemyr","Boreal hei","Semi-naturlig eng","Platåhøymyr","Strandeng","Hagemark","Semi-naturlig våteng","Eksentrisk høymyr","Rik åpen jordvannsmyr i mellomboreal sone","Sørlig slåttemyr","Terrengdekkende myr","Semi-naturlig myr","Åpen flomfastmark","Svært tørkeutsatt sørlig kalkberg","Isinnfrysingsmark","Eng-aktig sterkt endret fastmark","Høgereligende og nordlig nedbørsmyr","Øyblandingsmyr","Semi-naturlig strandeng","Lauveng","Kalkrik helofyttsump","Sørlig nedbørsmyr","Rik åpen sørlig jordvannsmyr","Fossepåvirket berg","Aktiv skredmark","Palsmyr","Silt og leirskred","Nakent tørkeutsatt kalkberg","Sørlig kaldkilde","Åpen grunnlendt kalkrik mark i boreonemoral sone","Sørlig etablert sanddynemark","Atlantisk høymyr","Rik åpen jordvannsmyr i nordboreal og lavalpin sone","Sanddynemark","Åpen grunnlendt kalkrik mark i sørboreal sone","Fuglefjell-eng og fugletopp","Fosseberg","Kanthøymyr","Fosse-eng","Øvre sandstrand uten pionervegetasjon","Konsentrisk høymyr",null,null,null,null,null,null,null,null,null,null],["2018, 2019, 2020, 2021","2018, 2019, 2020, 2021","2018, 2019, 2020, 2021","2018, 2019, 2020, 2021","2018, 2019, 2020, 2021","2018, 2019, 2020, 2021","2019, 2020, 2021","2018, 2019, 2020, 2021","2018, 2019, 2020, 2021","2018, 2019, 2020, 2021","2019, 2020, 2021","2019, 2020, 2021","2019, 2020, 2021","2019, 2020, 2021","2019, 2020, 2021","2018, 2019, 2020, 2021","2019, 2020, 2021","2018, 2019, 2020, 2021","2018, 2019, 2020, 2021","2019, 2020, 2021","2019, 2020, 2021","2018, 2019, 2020, 2021","2019, 2020","2019, 2020, 2021","2019, 2020, 2021","2018, 2019, 2020, 2021","2019, 2020, 2021","2019, 2020, 2021","2021","2019, 2020, 2021","2018, 2019, 2020, 2021","2018, 2019, 2020, 2021","2018, 2019, 2020, 2021","2018, 2019, 2020, 2021","2019, 2020, 2021","2018, 2019, 2020, 2021","2018, 2019, 2020, 2021","2019, 2020, 2021","2019, 2020, 2021","2021","2019, 2020, 2021","2019, 2020","2019, 2020, 2021","2019, 2020",null,null,null,null,null,null,null,null,null,null],["Semi-naturlig mark","Semi-naturlig mark","Semi-naturlig mark","Våtmark","Semi-naturlig mark","Semi-naturlig mark","Våtmark","Naturlig åpne områder under skoggrensa","Semi-naturlig mark","Våtmark","Våtmark","Våtmark","Våtmark","Våtmark","Våtmark","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Semi-naturlig mark","Våtmark","Våtmark","Semi-naturlig mark","Semi-naturlig mark","Våtmark","Våtmark","Våtmark","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Våtmark","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Våtmark","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Våtmark","Våtmark","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Våtmark","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Våtmark","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Semi-naturlig mark"],["T32","T34","T32","V9","T31","T32","V3","T12","T32","V10","V3","V1","V9","V3","V9","T18","T1","T20","T41","V3","V1","T33","T32","L4","V3","V1","T1","T17","V3","T17","T1","V4","T2","T21","V3","V1","T21","T2","T8","T1","V3","T15","T29","V3","T6","T11","T13","T16","T23","T24","T25","T26","T27","T40"],["all (if including sub-types)","all","all (if including sub-types)","all (if including sub-types)","all","all (if including sub-types)","all (if including sub-types)","all (-2018)","all (if including sub-types)","all (-2018)","all (if including sub-types)","calcareous","all (if including sub-types)","all (if including sub-types)","all (if including sub-types)","all","calcareous and dry","all","all","all (if including sub-types)","partial","all (-2018)","all (if including sub-types)","calcareous","all (if including sub-types)","calcareous","extra wet","all (if including sub-types)","all (if including sub-types)","all (if including sub-types)","calcareous and dry","southern","calcareous","all (if including sub-types)","all (if including sub-types)","calcareous","all (if including sub-types)","calcareous","all","extra wet","all (if including sub-types)","all","sandy and vegetated","all (if including sub-types)","Not mapped","Not mapped","Not mapped","Not mapped","Not mapped","Not mapped","Not mapped","Not mapped","Not mapped","Not mapped"],[null,null,0,null,null,null,null,null,19.4,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,9.3,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,80.5,null,null,null,null,null,null,null,null,null,null,null,null,null,100,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,100,null,null,null,null,null,null,null,null,100,null,100,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,100,null,null,null,null,null,null,null,null,100,null,100,null,null,null,null,null,null,null,null,100,null,null,null,null,null,null,null,null,99.5,null,null,null,null,100,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,0,null,null,null,null,null,19.3,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,42.6,null,null,null,null,null,null,null,null,39.1,null,36.5,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[99.7,99.9,99.9,7.4,100,99.9,null,99.9,99.9,99.8,null,100,null,null,null,66.6,100,null,100,null,null,98.9,100,100,null,100,null,null,null,null,100,null,99.8,100,null,5.5,100,100,null,null,null,null,100,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,99.8,null,null,100,null,null,null,100,100,100,100,100,null,null,null,null,99.7,100,null,null,100,100,98.9,null,null,100,null,null,98.4,null,null,100,94.5,null,null,null,null,100,null,null,100,null,null,null,null,null,null,null,null,null,null],[99.9,null,100,null,null,99.9,null,2.5,100,100,null,null,null,null,null,null,null,null,99.8,null,null,98.7,100,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,99.9,null,null,100,null,null,null,null,null,null,null,null,null,null,86.5,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,100,null,null,98.9,null,100,null,null,100,100,null,null,null,null,null,null,null,null,null,null,null],[98.5,null,99.7,null,null,99.2,null,null,99.8,99.7,null,null,null,null,null,null,null,null,99.3,null,null,null,100,null,null,null,null,null,null,null,null,null,null,100,null,null,98.9,null,null,null,null,null,100,null,null,null,null,null,null,null,null,null,null,null],[null,0,null,null,100,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[99.9,99.9,100,null,null,99.9,null,1.8,99.9,100,null,null,null,null,null,null,null,null,99.3,null,null,98.6,100,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,45.2,null,7.4,32.4,null,100,99.9,null,null,100,100,null,100,null,86.7,100,88.9,99.5,99.7,100,15.8,null,null,100,100,100,null,100,null,100,9.4,99.5,100,100,100,100,100,100,null,100,100,100,100,null,null,null,null,null,null,null,null,null,null],[null,54.2,null,100,67.4,null,null,99.9,null,null,null,null,100,null,100,86.6,null,88.9,null,null,null,null,null,100,null,17.4,null,100,null,100,14.6,null,99.5,100,null,5.5,100,100,null,null,null,100,100,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,93,null,null,null,null,null,null,null,null,null,null,100,null,null,null,null,null,null,null,null,null,null,null,null,100,null,100,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,100,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,92.6,null,null,null,null,null,null,null,null,100,null,100,null,null,null,null,null,null,83.2,null,100,null,null,null,null,null,null,null,90.6,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,100,null,null,null,100,100,null,100,null,null,null,null,null,99.7,100,null,null,null,100,82.6,null,null,100,null,null,null,null,null,100,94.5,null,null,null,null,100,null,null,100,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,100,null,null,null,100,null,null,100,null,null,null,null,null,99.7,null,null,null,null,100,null,null,null,null,null,null,null,null,null,100,null,null,null,null,null,100,null,null,100,null,null,null,null,null,null,null,null,null,null],[6.81956356593571,446.638733529904,108.83795146733,8.94881563070796,311.179910500879,25.6749258232426,3.64513842004613,4.18015991464149,13.9306785922215,4.99997030545661,5.40129720245494,6.67459600985544,0.849630753543558,16.951171252332,6.97532795463438,10.2576622102261,0.0939286599663424,0.0172138593255082,1.1136383496571,12.3792368582634,4.23571529897774,3.40471202718152,0.0276215101012527,1.9365690032333,12.3314095299565,4.41543153836709,0.0459278897347861,0.405816768116717,1.30286814519671,0.022958446379465,1.48426109399653,0.0528799856375842,0.68576061110412,0.333717528775667,3.32734000458103,0.212262234086063,1.89650385103741,0.156271240033891,0.248655085415105,0.00792215845906082,0.109073191077505,0.00237313203080123,0.0165918400637099,0.35986377082405,0,0,0,0,0,0,0,0,0,0],[1577,7444,9657,554,4887,3402,73,1376,1796,1000,106,797,133,326,693,1554,74,9,565,361,189,935,11,250,766,755,21,155,38,37,342,127,440,55,85,55,284,124,20,11,17,3,19,9,null,null,null,null,null,null,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Nature_type<\/th>\n      <th>Year<\/th>\n      <th>Ecosystem<\/th>\n      <th>NiN_mainType<\/th>\n      <th>NiN_mainTypeCoverage<\/th>\n      <th>1AG-A-0<\/th>\n      <th>1AG-A-E<\/th>\n      <th>1AG-A-G<\/th>\n      <th>1AG-B<\/th>\n      <th>1AG-C<\/th>\n      <th>1AR-C-L<\/th>\n      <th>7FA<\/th>\n      <th>7GR-GI<\/th>\n      <th>7JB-BA<\/th>\n      <th>7JB-BT<\/th>\n      <th>7JB-GJ<\/th>\n      <th>7RA-BH<\/th>\n      <th>7RA-SJ<\/th>\n      <th>7SE<\/th>\n      <th>7TK<\/th>\n      <th>7VR-RI<\/th>\n      <th>PRHT<\/th>\n      <th>PRSL<\/th>\n      <th>PRTK<\/th>\n      <th>PRTO<\/th>\n      <th>km2<\/th>\n      <th>numberOfLocalities<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"scrollY":true,"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p class="caption">
Figure 5.13: List of 45 nature types additionam data, including the proportion of localities for which there is data for each of the NiN variables.
</p>
</div>
<div class="sourceCode" id="cb323"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span>
  <span class="va">ntyp_fill2</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">ntyp_vars</span><span class="op">$</span><span class="va">NiN_variable_code</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">drop_na</span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">rename</span><span class="op">(</span>NiN_code <span class="op">=</span> <span class="va">name</span>,
         useFrequency <span class="op">=</span> <span class="va">value</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">useFrequency</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">NiN_code</span>, <span class="va">Ecosystem</span>, <span class="va">NiN_mainType</span><span class="op">)</span> <span class="op">%&gt;%</span>  <span class="co"># NiN main type could be replaced with Nature_type</span>
  <span class="fu">summarise</span><span class="op">(</span>km2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">km2</span><span class="op">)</span><span class="op">)</span>,
  options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    scrollX <span class="op">=</span> <span class="cn">T</span>,
    scrollY<span class="op">=</span><span class="cn">T</span>,
    pageLength <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; `summarise()` has grouped output by 'NiN_code',</span>
<span class="co">#&gt; 'Ecosystem'. You can override using the `.groups` argument.</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-80"></span>
<div id="htmlwidget-da891376bd413065f81a" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-da891376bd413065f81a">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95"],["1AG-A-0","1AG-A-0","1AG-A-E","1AG-A-G","1AG-B","1AG-B","1AG-B","1AG-C","1AR-C-L","7FA","7FA","7FA","7FA","7FA","7FA","7FA","7FA","7FA","7FA","7FA","7FA","7FA","7FA","7FA","7GR-GI","7GR-GI","7GR-GI","7GR-GI","7GR-GI","7JB-BA","7JB-BA","7JB-BA","7JB-BA","7JB-BA","7JB-BT","7JB-BT","7JB-BT","7JB-BT","7JB-BT","7JB-BT","7JB-BT","7JB-GJ","7JB-GJ","7JB-GJ","7JB-GJ","7JB-GJ","7RA-BH","7RA-SJ","7RA-SJ","7RA-SJ","7RA-SJ","7RA-SJ","7RA-SJ","7SE","7SE","7SE","7SE","7SE","7SE","7SE","7SE","7SE","7SE","7SE","7SE","7SE","7SE","7SE","7SE","7SE","7TK","7TK","7TK","7TK","7TK","7TK","7TK","7TK","7TK","7TK","7TK","7TK","7TK","7TK","7VR-RI","7VR-RI","7VR-RI","PRHT","PRSL","PRSL","PRSL","PRSL","PRTK","PRTK","PRTO"],["Naturlig åpne områder under skoggrensa","Semi-naturlig mark","Semi-naturlig mark","Våtmark","Naturlig åpne områder under skoggrensa","Våtmark","Våtmark","Semi-naturlig mark","Våtmark","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Semi-naturlig mark","Semi-naturlig mark","Semi-naturlig mark","Semi-naturlig mark","Semi-naturlig mark","Våtmark","Våtmark","Våtmark","Våtmark","Våtmark","Våtmark","Våtmark","Våtmark","Våtmark","Naturlig åpne områder under skoggrensa","Semi-naturlig mark","Semi-naturlig mark","Semi-naturlig mark","Våtmark","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Semi-naturlig mark","Semi-naturlig mark","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Semi-naturlig mark","Semi-naturlig mark","Våtmark","Semi-naturlig mark","Naturlig åpne områder under skoggrensa","Semi-naturlig mark","Semi-naturlig mark","Semi-naturlig mark","Semi-naturlig mark","Våtmark","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Semi-naturlig mark","Semi-naturlig mark","Semi-naturlig mark","Semi-naturlig mark","Våtmark","Våtmark","Våtmark","Våtmark","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Semi-naturlig mark","Semi-naturlig mark","Våtmark","Våtmark","Våtmark","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Naturlig åpne områder under skoggrensa","Semi-naturlig mark","Semi-naturlig mark","Våtmark","Våtmark","Våtmark","Våtmark","Våtmark","Våtmark"],["T2","T32","T32","V9","T2","L4","V9","T32","V9","T1","T12","T18","T2","T21","T29","T31","T32","T33","T34","T41","L4","V1","V10","V9","L4","V1","V3","V4","V9","T12","T32","T33","T41","V10","T15","T18","T21","T29","T8","T31","T34","T21","T29","T32","T41","V10","T31","T12","T32","T33","T34","T41","V10","T1","T12","T15","T18","T2","T20","T21","T29","T8","T31","T33","T34","T41","V1","V3","V4","V9","T1","T12","T15","T17","T18","T2","T20","T21","T29","T31","T34","L4","V1","V9","T1","T15","T18","T32","T33","L4","V4","V9","V1","V3","V3"],[0.68576061110412,13.9306785922215,13.9583001023227,16.7737743388859,0.842031851138011,1.9365690032333,16.7737743388859,13.9306785922215,16.7737743388859,1.57818975396287,4.18015991464149,10.2576622102261,0.842031851138011,2.23022137981308,0.0165918400637099,311.179910500879,155.290740958831,3.40471202718152,446.638733529904,1.1136383496571,1.9365690032333,11.3022897823086,4.99997030545661,8.94881563070796,1.9365690032333,15.5380050812863,55.8073983747322,0.0528799856375842,16.7737743388859,4.18015991464149,155.290740958831,3.40471202718152,1.1136383496571,4.99997030545661,0.00237313203080123,10.2576622102261,2.23022137981308,0.0165918400637099,0.248655085415105,311.179910500879,446.638733529904,2.23022137981308,0.0165918400637099,155.290740958831,1.1136383496571,4.99997030545661,311.179910500879,4.18015991464149,155.290740958831,3.40471202718152,446.638733529904,1.1136383496571,4.99997030545661,1.62411764369765,4.18015991464149,0.00237313203080123,10.2576622102261,0.842031851138011,0.0172138593255082,2.23022137981308,0.0165918400637099,0.248655085415105,311.179910500879,3.40471202718152,446.638733529904,1.1136383496571,15.5380050812863,55.8073983747322,0.0528799856375842,8.94881563070796,1.48426109399653,4.18015991464149,0.00237313203080123,0.428775214496182,10.2576622102261,0.842031851138011,0.0172138593255082,2.23022137981308,0.0165918400637099,311.179910500879,446.638733529904,1.9365690032333,4.62769377245315,16.7737743388859,0.0538500481938469,0.00237313203080123,10.2576622102261,0.0276215101012527,3.40471202718152,1.9365690032333,0.0528799856375842,16.7737743388859,15.5380050812863,55.8073983747322,54.5045302295355]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>NiN_code<\/th>\n      <th>Ecosystem<\/th>\n      <th>NiN_mainType<\/th>\n      <th>km2<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"scrollY":true,"pageLength":10,"columnDefs":[{"className":"dt-right","targets":4},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p class="caption">
Figure 5.14: List of unique combinatios of NiN variable codes and naturetypes with the summed area for which we have this data.
</p>
</div>
</div>
<div id="exp-natureType-summary" class="section level2" number="5.13">
<h2>
<span class="header-section-number">5.13</span> Export data<a class="anchor" aria-label="anchor" href="#exp-natureType-summary"><i class="fas fa-link"></i></a>
</h2>
<p>Exporting the table with the summary statistics and other information that I compled for each nature type in the three main ecosystems. This can be merged with the main dataset in order to subset according to a specific research question.</p>
<div class="sourceCode" id="cb324"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">ntyp_fill2</span>, <span class="st">"data/naturetypes/natureType_summary.rds"</span><span class="op">)</span></code></pre></div>
<p>Note also that the main dataset still contains some localities where there is a mis-match between the nature type definition and the NiN mapping uits recorded in the field. Each researcher should decide to include or exclude these.</p>
<p>The main data set also includes mosaic localities, that are less suitable to use as ground trouth data for remote sensing methods.</p>
</div>
<div id="appendix-1" class="section level2" number="5.14">
<h2>
<span class="header-section-number">5.14</span> Appendix 1<a class="anchor" aria-label="anchor" href="#appendix-1"><i class="fas fa-link"></i></a>
</h2>
<p>Here is a deeper look into the causes for why some localities are recorded with seemingly erroneous NiN mapping units (and hence NiN main types)</p>
<p>Lets have a look at how the NiN main types (recorded in the field) cover the different <em>hovedøkosystem</em> when we exclude <em>Hule eiker</em> and all localities that have more than one NiN main type.</p>
<div class="sourceCode" id="cb325"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_red</span> <span class="op">&lt;-</span> <span class="va">dat_melt</span><span class="op">[</span><span class="va">dat_melt</span><span class="op">$</span><span class="va">n_ninkartleggingsenheter</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> 
                      <span class="va">dat_melt</span><span class="op">$</span><span class="va">naturtype</span> <span class="op">!=</span> <span class="st">"Hule eiker"</span> <span class="op">&amp;</span>
                      <span class="va">dat_melt</span><span class="op">$</span><span class="va">mosaikk</span> <span class="op">==</span> <span class="st">"Nei"</span>,<span class="op">]</span></code></pre></div>
<p>Let’s focus in on our three targeted ecosystems.</p>
<div class="sourceCode" id="cb326"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_red_tally</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dat_red</span>,
                                  <span class="va">area</span><span class="op">~</span><span class="va">hovedøkosystem</span><span class="op">+</span><span class="va">ninkartleggingsenheter3</span>, FUN <span class="op">=</span> <span class="va">length</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dat_red_tally</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"count"</span></code></pre></div>
<div class="sourceCode" id="cb327"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">target</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Semi-naturlig mark"</span>,
            <span class="st">"Våtmark"</span>,
            <span class="st">"Naturlig åpne områder under skoggrensa"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb328"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat_red_tally</span><span class="op">[</span><span class="va">dat_red_tally</span><span class="op">$</span><span class="va">hovedøkosystem</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">target</span>,<span class="op">]</span>,
       <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">ninkartleggingsenheter3</span>,
               y <span class="op">=</span> <span class="va">count</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_bar</span><span class="op">(</span>
           fill<span class="op">=</span><span class="st">"grey"</span>,
           colour<span class="op">=</span><span class="st">"black"</span>,
           stat<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Number of localities"</span>,
       x <span class="op">=</span> <span class="st">"NiN main types"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"left"</span>,
                   expand <span class="op">=</span> <span class="fu">expansion</span><span class="op">(</span>mult<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.0</span>,<span class="fl">.3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_text</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label<span class="op">=</span><span class="va">count</span><span class="op">)</span>, hjust<span class="op">=</span><span class="op">-</span><span class="fl">0.25</span><span class="op">)</span><span class="op">+</span>
    <span class="fu">facet_wrap</span><span class="op">(</span><span class="st">"hovedøkosystem"</span>,
             scales <span class="op">=</span> <span class="st">"free"</span>,
             ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-85"></span>
<img src="naturtype_files/figure-html/unnamed-chunk-85-1.png" alt="Number of localities for each combination of main ecosystem and NiN main type" width="672"><p class="caption">
Figure 3.12: Number of localities for each combination of main ecosystem and NiN main type
</p>
</div>
<p>Still some weird cases which I will look at in turn below, trying to understand how they came to be recorded in this way.</p>
<div id="naturlig-åpne-områder-under-skoggrensa" class="section level4" number="5.14.0.1">
<h4>
<span class="header-section-number">5.14.0.1</span> Naturlig åpne områder under skoggrensa<a class="anchor" aria-label="anchor" href="#naturlig-%C3%A5pne-omr%C3%A5der-under-skoggrensa"><i class="fas fa-link"></i></a>
</h4>
<p>Listing the NiN main types recorded for nature types belonging to <em>Naturlig åpne områder under skoggrensa</em>, but which clearly don’t belong there:</p>
<ul>
<li>V10 (semi-naturlig våteng)
<ul>
<li>One case of Åpen flomfastmark wrongly associated with V10 whan it should be T18.</li>
</ul>
</li>
<li>T33 (Semi naturlig strandeng)
<ul>
<li>These are cases where either the <code>naturtype</code> should have been <code>semi-naturlig strandeng</code> (and hence the hovedøkosystem would be Semi-nat), or the <code>naturtype</code> is correctly recorded as <code>Strandeng</code> but then the NiN type should be <code>T12</code>.</li>
</ul>
</li>
<li>T32 (Semi-naturlig eng)
<ul>
<li>Obvious error</li>
</ul>
</li>
<li>T30 (Flomskogsmark)
<ul>
<li>Obvious error</li>
</ul>
</li>
</ul>
<p>Listing the remaining NiN main types:
* T8 (fulglefjelleng og fugltopp)
* T6 (Standberg)
* T29 (Grus og steindominert strand og strandlinje)
* T21 (Sanddynemark)
* T20 (Isinnfrysingsmark)
* T2 (Åpen grunlendt mark)
* T18 (Åpne flomfastmark)
* T17 (Aktiv skredmark)
* T15 (Fosse-eng)
* T13 (Rasmark)
* T12 (Strandeng)
* T1 (Nakent berg)</p>
<div class="sourceCode" id="cb329"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">`%!in%`</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Negate</a></span><span class="op">(</span><span class="va">`%in%`</span><span class="op">)</span>
<span class="va">dat_red2</span> <span class="op">&lt;-</span> <span class="va">dat_red</span><span class="op">[</span>
  <span class="va">dat_red</span><span class="op">$</span><span class="va">hovedøkosystem</span><span class="op">!=</span><span class="st">"Naturlig åpne områder under skoggrensa"</span> <span class="op">|</span>
  <span class="va">dat_red</span><span class="op">$</span><span class="va">hovedøkosystem</span><span class="op">==</span><span class="st">"Naturlig åpne områder under skoggrensa"</span> <span class="op">&amp;</span> 
    <span class="va">dat_red</span><span class="op">$</span><span class="va">ninkartleggingsenheter3</span> <span class="op">%!in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"T30"</span>, <span class="st">"T32"</span>, <span class="st">"T33"</span>, <span class="st">"V10"</span><span class="op">)</span>,<span class="op">]</span></code></pre></div>
<p>This resulted in deleting 19m localities.</p>
</div>
<div id="semi-naturlig-mark" class="section level4" number="5.14.0.2">
<h4>
<span class="header-section-number">5.14.0.2</span> Semi-naturlig mark<a class="anchor" aria-label="anchor" href="#semi-naturlig-mark"><i class="fas fa-link"></i></a>
</h4>
<p>Listing the NiN main types recorded for nature types belonging to <em>Semi-naturlig mark</em>, but which clearly don’t belong there:</p>
<ul>
<li>V9 (Semi-naturlig myr)
<ul>
<li>Kystlynghei recorded as mire</li>
</ul>
</li>
<li>T4 (Fastmarksskogsmark)
<ul>
<li>These should all be T32 (naturbeitemark, lauveng, hagemark, +++)</li>
</ul>
</li>
<li>T35 (Sterkt endret fastmark med løsmassedekke)
<ul>
<li>Wrong NiN type given to eng-aktig sterkt endret fastmark (it should be T40)</li>
</ul>
</li>
<li>T3 (Fjellhei, leside og tundra)
<ul>
<li>Boreal hei (should’ve been T31)</li>
</ul>
</li>
<li>T12 (Strandeng)
<ul>
<li>Should probably have been T33</li>
</ul>
</li>
<li>T1 (Nakent berg)
<ul>
<li>Obvious mistake</li>
</ul>
</li>
</ul>
<p>Listing the remaining NiN-main types:
* V10 (semi-nat våteng)
* T41 (Oppdyrket mark med preg av semi-naturlig eng)
* T40 (Sterkt endret fastmark med preg av semi-naturlig eng)
* T31-34</p>
<div class="sourceCode" id="cb330"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_red3</span> <span class="op">&lt;-</span> <span class="va">dat_red2</span><span class="op">[</span>
  <span class="va">dat_red2</span><span class="op">$</span><span class="va">hovedøkosystem</span><span class="op">!=</span><span class="st">"Semi-naturlig mark"</span> <span class="op">|</span>
  <span class="va">dat_red2</span><span class="op">$</span><span class="va">hovedøkosystem</span><span class="op">==</span><span class="st">"Semi-naturlig mark"</span> <span class="op">&amp;</span> <span class="va">dat_red2</span><span class="op">$</span><span class="va">ninkartleggingsenheter3</span> <span class="op">%!in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V9"</span>, <span class="st">"T4"</span>, <span class="st">"T35"</span>, <span class="st">"T3"</span>, <span class="st">"T12"</span>, <span class="st">"T1"</span><span class="op">)</span>,<span class="op">]</span></code></pre></div>
<p>This resulted in the deletion of 57 localities.</p>
</div>
<div id="våtmark" class="section level4" number="5.14.0.3">
<h4>
<span class="header-section-number">5.14.0.3</span> Våtmark<a class="anchor" aria-label="anchor" href="#v%C3%A5tmark"><i class="fas fa-link"></i></a>
</h4>
<p>Listing the NiN main types recorded for nature types belonging to <em>Våtmark</em>, but which clearly don’t belong there.</p>
<p>Våtmark doesn’t distinguish between semi-natural and natural, so all V-types are correct, except the strongly modified V11-V13.</p>
<ul>
<li>V11 (Torvtak)
<ul>
<li>Obvious mistake</li>
</ul>
</li>
<li>V12 (Grøftet åpne torvmark)
<ul>
<li>Obvious mistake</li>
</ul>
</li>
<li>V13 (Ny våtmark)
<ul>
<li>Obvious mistake</li>
</ul>
</li>
<li>T4 (skog)
<ul>
<li>some that should’ve been T2 and some other strange things</li>
</ul>
</li>
<li>T30-T32
<ul>
<li>Someone switching the semi-natural and natural equivalents</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb331"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_red4</span> <span class="op">&lt;-</span> <span class="va">dat_red3</span><span class="op">[</span>
  <span class="va">dat_red3</span><span class="op">$</span><span class="va">hovedøkosystem</span><span class="op">!=</span><span class="st">"Våtmark"</span> <span class="op">|</span>
  <span class="va">dat_red3</span><span class="op">$</span><span class="va">hovedøkosystem</span><span class="op">==</span><span class="st">"Våtmark"</span> <span class="op">&amp;</span> <span class="va">dat_red3</span><span class="op">$</span><span class="va">ninkartleggingsenheter3</span> <span class="op">%!in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"T4"</span>, <span class="st">"T30"</span>, <span class="st">"T31"</span>, <span class="st">"T32"</span>, <span class="st">"V11"</span>, <span class="st">"V12"</span>, <span class="st">"V13"</span><span class="op">)</span>,<span class="op">]</span></code></pre></div>
<p>This resulted in the deletion of 31 localities.</p>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="areal-uten-d%C3%B8d-eller-skadet-r%C3%B8sslyng-i-kystlynghei.html"><span class="header-section-number">4</span> Areal uten død eller skadet røsslyng i kystlynghei</a></div>
<div class="next"><a href="scaling-functions.html"><span class="header-section-number">6</span> Scaling functions</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#naturtype"><span class="header-section-number">5</span> Nature types</a></li>
<li><a class="nav-link" href="#import-data-and-general-summary-statistics"><span class="header-section-number">5.1</span> Import data and general summary statistics</a></li>
<li><a class="nav-link" href="#area"><span class="header-section-number">5.2</span> Area</a></li>
<li><a class="nav-link" href="#temporal-trend"><span class="header-section-number">5.3</span> Temporal trend</a></li>
<li><a class="nav-link" href="#condition"><span class="header-section-number">5.4</span> Condition</a></li>
<li><a class="nav-link" href="#mosaic-types"><span class="header-section-number">5.5</span> Mosaic types</a></li>
<li><a class="nav-link" href="#nin-types-across-main-ecosystems"><span class="header-section-number">5.6</span> NiN types across main ecosystems</a></li>
<li>
<a class="nav-link" href="#assigning-nin-main-types-to-nature-types"><span class="header-section-number">5.7</span> Assigning NiN main types to Nature types</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#add-nin-main-type-and-degree-of-representativity"><span class="header-section-number">5.7.1</span> Add NiN main type and degree of representativity</a></li></ul>
</li>
<li>
<a class="nav-link" href="#add-nin-variables"><span class="header-section-number">5.8</span> Add NiN variables</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#ag-a-sjiktdekningsvariabler"><span class="header-section-number">5.8.1</span> 1AG-A (sjiktdekningsvariabler)</a></li>
<li><a class="nav-link" href="#ar-c-l-andel-vedvekster-i-fletsjiktet"><span class="header-section-number">5.8.2</span> 1AR-C-L (Andel vedvekster i fletsjiktet)</a></li>
<li><a class="nav-link" href="#to-torvmarksformer"><span class="header-section-number">5.8.3</span> 3TO (Torvmarksformer)</a></li>
<li><a class="nav-link" href="#dl-coarse-dead-wood"><span class="header-section-number">5.8.4</span> 4DL (Coarse dead wood)</a></li>
<li><a class="nav-link" href="#tg-old-trees"><span class="header-section-number">5.8.5</span> 4TG (old trees)</a></li>
<li><a class="nav-link" href="#tl-trees-with-fire-scars"><span class="header-section-number">5.8.6</span> 4TL (trees with fire scars)</a></li>
<li><a class="nav-link" href="#ab-and-5by-arealbruksklasser-og-byggningstyper"><span class="header-section-number">5.8.7</span> 5AB and 5BY (arealbruksklasser og byggningstyper)</a></li>
<li><a class="nav-link" href="#se-and-6so-bioclimatical-sections-and-sones"><span class="header-section-number">5.8.8</span> 6SE and 6SO (Bioclimatical sections and sones)</a></li>
<li><a class="nav-link" href="#fa-fremmedartsinnslag"><span class="header-section-number">5.8.9</span> 7FA (fremmedartsinnslag)</a></li>
<li><a class="nav-link" href="#gr-gi"><span class="header-section-number">5.8.10</span> 7GR-GI</a></li>
<li><a class="nav-link" href="#jb-ba-aktuell-bruksintensitet"><span class="header-section-number">5.8.11</span> 7JB-BA (Aktuell bruksintensitet)</a></li>
<li><a class="nav-link" href="#jb-bt-beitetrykk"><span class="header-section-number">5.8.12</span> 7JB-BT (Beitetrykk)</a></li>
<li><a class="nav-link" href="#jb-gj-gj%C3%B8dsling"><span class="header-section-number">5.8.13</span> 7JB-GJ (Gjødsling)</a></li>
<li><a class="nav-link" href="#jb-ht-h%C3%B8sting-av-tresjiktet"><span class="header-section-number">5.8.14</span> 7JB-HT (Høsting av tresjiktet)</a></li>
<li><a class="nav-link" href="#jb-ku-kystlyngheias-utviklingsfaser"><span class="header-section-number">5.8.15</span> 7JB-KU (Kystlyngheias utviklingsfaser)</a></li>
<li><a class="nav-link" href="#ra-bh-and-7ra-sj-rask-suksesjon-i-boreal-hei-og-i-i-semi-naturlig-og-sterkt-endret-jordbruksmark-inkludert-v%C3%A5teng"><span class="header-section-number">5.8.16</span> 7RA-BH and 7RA-SJ (rask suksesjon i boreal hei og i i semi-naturlig og sterkt endret jordbruksmark inkludert våteng)</a></li>
<li><a class="nav-link" href="#sd-0-and-7sd--ns-natur--og-normalskogsdynamikk"><span class="header-section-number">5.8.17</span> 7SD-0 and 7SD- NS (Natur- og normalskogsdynamikk)</a></li>
<li><a class="nav-link" href="#tk-and-7se-kj%C3%B8respor-slitasje"><span class="header-section-number">5.8.18</span> 7TK and 7SE (kjørespor &amp; slitasje)</a></li>
<li><a class="nav-link" href="#vr-ri-reguleringsintensitet"><span class="header-section-number">5.8.19</span> 7VR-RI (Reguleringsintensitet)</a></li>
<li><a class="nav-link" href="#lkmki"><span class="header-section-number">5.8.20</span> LKMKI</a></li>
<li><a class="nav-link" href="#lkmsp"><span class="header-section-number">5.8.21</span> LKMSP</a></li>
<li><a class="nav-link" href="#prak"><span class="header-section-number">5.8.22</span> PRAK</a></li>
<li><a class="nav-link" href="#pram"><span class="header-section-number">5.8.23</span> PRAM</a></li>
<li><a class="nav-link" href="#prh"><span class="header-section-number">5.8.24</span> PRH</a></li>
<li><a class="nav-link" href="#prha"><span class="header-section-number">5.8.25</span> PRHA</a></li>
<li><a class="nav-link" href="#prht"><span class="header-section-number">5.8.26</span> PRHT</a></li>
<li><a class="nav-link" href="#prka"><span class="header-section-number">5.8.27</span> PRKA</a></li>
<li><a class="nav-link" href="#prku"><span class="header-section-number">5.8.28</span> PRKU</a></li>
<li><a class="nav-link" href="#prmy"><span class="header-section-number">5.8.29</span> PRMY</a></li>
<li><a class="nav-link" href="#prrl-crddenntvu"><span class="header-section-number">5.8.30</span> PRRL-CR/DD/EN/NT/VU</a></li>
<li><a class="nav-link" href="#prse-ka"><span class="header-section-number">5.8.31</span> PRSE-KA</a></li>
<li><a class="nav-link" href="#prse-pa"><span class="header-section-number">5.8.32</span> PRSE-PA</a></li>
<li><a class="nav-link" href="#prse-sh"><span class="header-section-number">5.8.33</span> PRSE-SH</a></li>
<li><a class="nav-link" href="#prsl"><span class="header-section-number">5.8.34</span> PRSL</a></li>
<li><a class="nav-link" href="#prtk"><span class="header-section-number">5.8.35</span> PRTK</a></li>
<li><a class="nav-link" href="#prto"><span class="header-section-number">5.8.36</span> PRTO</a></li>
<li><a class="nav-link" href="#prvs"><span class="header-section-number">5.8.37</span> PRVS</a></li>
</ul>
</li>
<li><a class="nav-link" href="#subset"><span class="header-section-number">5.9</span> Subset</a></li>
<li>
<a class="nav-link" href="#combine-naturetypes-nin-variables-and-nin-main-types"><span class="header-section-number">5.10</span> Combine Naturetypes, NiN variables and NiN main types</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#add-number-of-location-and-total-area-mapped"><span class="header-section-number">5.10.1</span> Add number of location and total area mapped</a></li></ul>
</li>
<li>
<a class="nav-link" href="#plots"><span class="header-section-number">5.11</span> Plots</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#the-total-mapped-area"><span class="header-section-number">5.11.1</span> The total mapped area</a></li>
<li><a class="nav-link" href="#area-of-localities-per-nin-main-type"><span class="header-section-number">5.11.2</span> Area of localities per NiN main type</a></li>
<li><a class="nav-link" href="#number-of-localities-per-nin-main-type"><span class="header-section-number">5.11.3</span> Number of localities per NiN main type</a></li>
<li><a class="nav-link" href="#commonness-of-nin-variables"><span class="header-section-number">5.11.4</span> Commonness of NiN variables</a></li>
</ul>
</li>
<li><a class="nav-link" href="#tables"><span class="header-section-number">5.12</span> Tables</a></li>
<li><a class="nav-link" href="#exp-natureType-summary"><span class="header-section-number">5.13</span> Export data</a></li>
<li><a class="nav-link" href="#appendix-1"><span class="header-section-number">5.14</span> Appendix 1</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/NINAnor/ecosystemCondition/blob/master/naturtype.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/NINAnor/ecosystemCondition/edit/master/naturtype.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Indicators for Ecosystem Condition in Norway</strong>" was written by Anders L. Kolstad. It was last built on 2023-03-07.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
