<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 4 Functional plant indicators, wetland ecosystems (Moisture, Light, pH, Nitrogen) | Indicators for Ecosystem Condition in Norway</title>
<meta name="author" content="Anders L. Kolstad">
<meta name="description" content="Author and date: Joachim Töpper May 2023  Ecosystem Økologisk.egenskap ECT.class våtmark Primærproduksjon Functional state characteristic våtmark Abiotiske forhold Functional state characteristic ...">
<meta name="generator" content="bookdown 0.33 with bs4_book()">
<meta property="og:title" content="Chapter 4 Functional plant indicators, wetland ecosystems (Moisture, Light, pH, Nitrogen) | Indicators for Ecosystem Condition in Norway">
<meta property="og:type" content="book">
<meta property="og:url" content="https://ninanor.github.io/ecosystemCondition/index.html/Functional-plant-indicators-wetland.html">
<meta property="og:image" content="https://ninanor.github.io/ecosystemCondition/index.html/images/Picture1.png">
<meta property="og:description" content="Author and date: Joachim Töpper May 2023  Ecosystem Økologisk.egenskap ECT.class våtmark Primærproduksjon Functional state characteristic våtmark Abiotiske forhold Functional state characteristic ...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 4 Functional plant indicators, wetland ecosystems (Moisture, Light, pH, Nitrogen) | Indicators for Ecosystem Condition in Norway">
<meta name="twitter:description" content="Author and date: Joachim Töpper May 2023  Ecosystem Økologisk.egenskap ECT.class våtmark Primærproduksjon Functional state characteristic våtmark Abiotiske forhold Functional state characteristic ...">
<meta name="twitter:image" content="https://ninanor.github.io/ecosystemCondition/index.html/images/Picture1.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.6.1/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.27/datatables.js"></script><link href="libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Indicators for Ecosystem Condition in Norway</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">About </a></li>
<li><a class="" href="overview-of-indicators.html">Overview of indicators</a></li>
<li class="book-part">INDICATORS</li>
<li><a class="" href="slitasje-og-kj%C3%B8respor.html"><span class="header-section-number">1</span> Slitasje og kjørespor</a></li>
<li><a class="" href="median-summer-temp.html"><span class="header-section-number">2</span> Median Summer Temperature</a></li>
<li><a class="" href="alien-species.html"><span class="header-section-number">3</span> Alien species</a></li>
<li><a class="active" href="Functional-plant-indicators-wetland.html"><span class="header-section-number">4</span> Functional plant indicators, wetland ecosystems (Moisture, Light, pH, Nitrogen)</a></li>
<li class="book-part">INDICATORS FROM THE ALPINE ASSESSMENT</li>
<li><a class="" href="areal-av-isbreer.html"><span class="header-section-number">5</span> Areal av isbreer</a></li>
<li class="book-part">DEPRECATED</li>
<li><a class="" href="areal-uten-d%C3%B8d-eller-skadet-r%C3%B8sslyng-i-kystlynghei.html"><span class="header-section-number">6</span> Areal uten død eller skadet røsslyng i kystlynghei</a></li>
<li class="book-part">GENERAL TOPICS</li>
<li><a class="" href="naturtype.html"><span class="header-section-number">7</span> Nature types</a></li>
<li><a class="" href="scaling-functions.html"><span class="header-section-number">8</span> Scaling functions</a></li>
<li><a class="" href="homogeneous-impact-areas.html"><span class="header-section-number">9</span> Homogeneous Impact Areas</a></li>
<li><a class="" href="master-grid.html"><span class="header-section-number">10</span> Master grid</a></li>
<li><a class="" href="climate-indicators-explained.html"><span class="header-section-number">11</span> Climate indicators explained</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/NINAnor/ecosystemCondition">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="Functional-plant-indicators-wetland" class="section level1" number="4">
<h1>
<span class="header-section-number">4</span> Functional plant indicators, wetland ecosystems (Moisture, Light, pH, Nitrogen)<a class="anchor" aria-label="anchor" href="#Functional-plant-indicators-wetland"><i class="fas fa-link"></i></a>
</h1>
<p><br></p>
<p><em>Author and date:</em>
Joachim Töpper</p>
<p>May 2023</p>
<p><br></p>
<!-- Load all you dependencies here -->
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">Ecosystem</th>
<th align="left">Økologisk.egenskap</th>
<th align="left">ECT.class</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">våtmark</td>
<td align="left">Primærproduksjon</td>
<td align="left">Functional state characteristic</td>
</tr>
<tr class="even">
<td align="left">våtmark</td>
<td align="left">Abiotiske forhold</td>
<td align="left">Functional state characteristic</td>
</tr>
</tbody>
</table></div>
<!-- Don't remove these three html lines --><br><br><hr>
<div id="introduction-3" class="section level2" number="4.1">
<h2>
<span class="header-section-number">4.1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction-3"><i class="fas fa-link"></i></a>
</h2>
<p>Functional plant indicators can be used to describe the functional signature of plant communities by calculating community-weighted means of plant indicator values for plant communities (Diekmann 2003). The functional signature of plant communities may be indicative of ecosystem identity, depending on which functional plant indicator we look at (cf. Töpper et al. 2018). For instance, using an indicator for moisture one would find a functional signature with higher moisture values for plant communities in mires compared to e.g. grasslands or forests. Deviations in the functional signature of such an indicator beyond a certain range of indicator values (as there of course is natural variation of functional signatures within an ecosystem type) may be related to a reduction in ecological condition. Here, we combine functional plant indicator data with field sampled plant community data from the Norwegian nature monitoring program ANO (Tingstad et al. 2019) for wetland ecosystems. We calculate the functional signature of plant communities in the monitored sites with respect to light, moisture, pH and nitrogen. These functional signatures are then compared to reference distributions of functional signature, separately for each wetland ecosystem type, calculated from ‘generalized species lists’ underlying the Norwegian categorization system for eco-diversity (Halvorsen et al. 2020). These plant functional condition indicators are developed following the principles and technical protocol of the IBECA framework (Jakobsson et al. 2021, Töpper &amp; Jakobsson 2021). Note that deviations from the reference may occur in both directions, e.g. the moisture signature from the testing data may be higher or lower than in the reference. Deviations in these two directions indicate very different environmental phenomena and thus have to be treated separately. Therefore, we develop two condition indicators for each functional plant indicator, a lower one and an upper one (see further down for more details).</p>
</div>
<div id="about-the-underlying-data-3" class="section level2" number="4.2">
<h2>
<span class="header-section-number">4.2</span> About the underlying data<a class="anchor" aria-label="anchor" href="#about-the-underlying-data-3"><i class="fas fa-link"></i></a>
</h2>
<p>In the ‘functional plant indicator’ project for wetlands, we use three sets of data for building indicators for ecological condition:</p>
<ul>
<li>as test data we use plant community data from the ANO monitoring scheme (cf. Tingstad et al. 2019)</li>
<li>as reference data we use generalized species lists from the Norwegian categorization system for eco-diversity (NiN) (cf. Halvorsen et al. 2020)</li>
<li>Swedish plant indicator data for light, moisture, pH, and nitrogen from Tyler et al. (2021)</li>
</ul>
<ol style="list-style-type: decimal">
<li><p>ANO monitoring data:
ANO stands for ‘areal-representativ naturovervåking’, i.e. ‘area representative nature monitoring’. 1000 sites are randomly distributed across mainland Norway and visited within a 5-year cycle. Each ANO site spans a 500 x 500 m grid cell, and the data collection at each ANO site includes up to 12 evenly distributed vegetation analyses in 1 x 1 m plots (up to 12, because some of these evenly distributed points may be in water or otherwise inaccessible). For the vegetation analyses, the cover of each vascular plant species in the plot is recorded. Every vegetation analysis is accompanied by an assessment of the ecosystem the plot lies in, including ecosystem type and some additional variables related to ecosystem-specific drivers of state. In the wetland-analysis in this document, we only use the plots which were classified as one of the wetland ecosystem types in the Norwegian categorization system for eco-diversity (NiN).
In the analysis in this document, we use the data available on Miljødirektoratets kartkatalog (<a href="https://kartkatalog.miljodirektoratet.no/Dataset/Details/2054" class="uri">https://kartkatalog.miljodirektoratet.no/Dataset/Details/2054</a>), which comprises data from the first three ANO-years, 2019-2021, and a total of 8887 plots in 498 sites.</p></li>
<li><p>NiN reference data:
The generalized species lists underlying the ecosystem categorization in NiN represent expert-compiled species lists based on empirical evidence from the literature and expert knowledge of the systems and their species. In these lists, every species is assigned an abundance value on a 6-step scale, with each step representing a range for the ‘expected combination of frequency and cover’ of occurrence (1: &lt; 1/32, 2: 1/32 - 1/8 , 3: 1/8 - 3/8, 4: 3/8 - 4/5, 5: 3/8 - 4/5 + dominance, 6: &gt; 4/5). For the purpose of this project, these steps are simplified to maximum ‘expected combination of frequency and cover’, whereby steps 4 &amp; 5 are assigned 0.6 and 0.8, respectively, in order to distinguish between them.</p></li>
<li><p>The Swedish plant indicator set published by Tyler et al. (2021) contains a large collection of plant indicators based on the Swedish flora, which is well representative of the Norwegian flora as well. From this set, we decided to include indicator data for light, moisture, pH, and nitrogen for wetlands as these are thought to be subject to potential change due to shrub/tree encroachment, drainage, and pollution.</p></li>
</ol>
<div id="representativity-in-time-and-space-3" class="section level3" number="4.2.1">
<h3>
<span class="header-section-number">4.2.1</span> Representativity in time and space<a class="anchor" aria-label="anchor" href="#representativity-in-time-and-space-3"><i class="fas fa-link"></i></a>
</h3>
<p>For wetlands, the ANO data contain 1351 plots in 330 sites, in principle distributed randomly across the country. As wetlands occur more often in certain regions of Norway than in others, the amount of plots and sites is not equal among Norway’s five regions. The 1351 plots are distributed across regions in the following way:</p>
<ul>
<li>Northern Norway: 416</li>
<li>Central Norway: 362</li>
<li>Eastern Norway: 295</li>
<li>Western Norway: 151</li>
<li>Southern Norway: 127</li>
</ul>
</div>
<div id="temporal-coverage-3" class="section level3" number="4.2.2">
<h3>
<span class="header-section-number">4.2.2</span> Temporal coverage<a class="anchor" aria-label="anchor" href="#temporal-coverage-3"><i class="fas fa-link"></i></a>
</h3>
<p>The evaluation data cover the first three years, 2019-2021, of the first 5-year-cycle in the ANO monitoring scheme. Thus there is no actual time series to these data, and the indicator evaluation does therefore not include any temporal analyses.</p>
</div>
</div>
<div id="collinearities-with-other-indicators-3" class="section level2" number="4.3">
<h2>
<span class="header-section-number">4.3</span> Collinearities with other indicators<a class="anchor" aria-label="anchor" href="#collinearities-with-other-indicators-3"><i class="fas fa-link"></i></a>
</h2>
<!-- Text here -->
</div>
<div id="reference-state-and-values" class="section level2" number="4.4">
<h2>
<span class="header-section-number">4.4</span> Reference state and values<a class="anchor" aria-label="anchor" href="#reference-state-and-values"><i class="fas fa-link"></i></a>
</h2>
<div id="reference-state" class="section level3" number="4.4.1">
<h3>
<span class="header-section-number">4.4.1</span> Reference state<a class="anchor" aria-label="anchor" href="#reference-state"><i class="fas fa-link"></i></a>
</h3>
<p>The reference state is defined via the functional signature of the generalized species lists in NiN (see also Töpper et al. 2018). By bootstrapping the species lists (see details further below) and calculating community-weighted means of functional plant indicators for every re-sampled community, we describe the reference state as a distribution of indicator values for each respective plant functional indicator. These distributions are calculated for ecosystem sub-types (“grunntyper” or “kartleggingsenheter” at a 1:5000 mapping scale) within the main wetland types in NiN. A more extensive discussion on the use of reference communities can be found in Jakobsson et al. (2020).</p>
</div>
<div id="reference-values-thresholds-for-defining-good-ecological-condition-minimum-andor-maximum-values-3" class="section level3" number="4.4.2">
<h3>
<span class="header-section-number">4.4.2</span> Reference values, thresholds for defining <em>good ecological condition</em>, minimum and/or maximum values<a class="anchor" aria-label="anchor" href="#reference-values-thresholds-for-defining-good-ecological-condition-minimum-andor-maximum-values-3"><i class="fas fa-link"></i></a>
</h3>
<p>In this analysis, we derive scaling values from statistical (here, non-parametric) distributions (see Jakobsson et al. 2010). For each ecosystem sub-type and plant functional indicator, the reference value is defined as the median value of the indicator value distribution. As in most cases the distributions naturally are two-sided (but see the Heat-requirement indicator in the mountain assessment for an example of a one-sided functional plant indicator, Fremstad et al. 2022), and deviation from the optimal state thus may occur in both direction (e.g. indicating too low or too high pH), we need to define two threshold values for good ecological condition as well as both a minimum and maximum value. In line with previous assessments of ecological condition for Norwegian forests and mountains, we define a lower and an upper threshold value via the 95% confidence interval of the reference distribution, i.e. its 0.025 and 0.975 quantiles. The minimum and maximum values are given by the minimum and maximum of the possible indicator values for each respective plant functional indicator. For details on the scaling principles in IBECA, please see Töpper &amp; Jakobsson (2021).</p>
</div>
</div>
<div id="uncertainties-3" class="section level2" number="4.5">
<h2>
<span class="header-section-number">4.5</span> Uncertainties<a class="anchor" aria-label="anchor" href="#uncertainties-3"><i class="fas fa-link"></i></a>
</h2>
<p>We can calculate a mean indicator value (after scaling) for every region (or any other delimited area of interest) as well as its corresponding standard error and standard deviation as a measure of spatial uncertainty for a geographical area.</p>
</div>
<div id="references-3" class="section level2" number="4.6">
<h2>
<span class="header-section-number">4.6</span> References<a class="anchor" aria-label="anchor" href="#references-3"><i class="fas fa-link"></i></a>
</h2>
<p>Diekmann, M. 2003. Species indicator values as an important tool in applied plant ecology - a review. Basic and Applied Ecology 4: 493-506, <a href="doi:10.1078/1439-1791-00185" class="uri">doi:10.1078/1439-1791-00185</a></p>
<p>Framstad, E., Kolstad, A. L., Nybø, S., Töpper, J. &amp; Vandvik, V. 2022. The condition of forest and mountain ecosystems in Norway. Assessment by the IBECA method. NINA Report 2100. Norwegian Institute for Nature Research.</p>
<p>Halvorsen, R., Skarpaas, O., Bryn, A., Bratli, H., Erikstad, L., Simensen, T., &amp; Lieungh, E. (2020). Towards a systematics of ecodiversity: The EcoSyst framework. Global Ecology and Biogeography, 29(11), 1887-1906. <a href="doi:10.1111/geb.13164" class="uri">doi:10.1111/geb.13164</a></p>
<p>Jakobsson, S., Töpper, J.P., Evju, M., Framstad, E., Lyngstad, A., Pedersen, B., Sickel, H., Sverdrup-Thygeson, A., Vandvik. V., Velle, L.G., Aarrestad, P.A. &amp; Nybø, S. 2020. Setting reference levels and limits for good ecological condition in terrestrial ecosystems. Insights from a case study based on the IBECA approach. Ecological Indicators 116: 106492.</p>
<p>Jakobsson, S., Evju, M., Framstad, E., Imbert, A., Lyngstad, A., Sickel, H., Sverdrup-Thygeson, A., Töpper, J., Vandvik, V., Velle, L.G., Aarrestad, P.A. &amp; Nybø, S. 2021. An index-based assessment of ecological condition and its links to international frameworks. Ecological Indicators 124: 107252.</p>
<p>Tingstad, L., Evju, M., Sickel, H., &amp; Töpper, J. 2019. Utvikling av nasjonal arealrepresentativ naturovervåking (ANO). Forslag til gjennomføring, protokoller og kostnadsvurderinger med utgangspunkt i erfaringer fra uttesting i Trøndelag. NINA Rapport 1642.</p>
<p>Töpper, J. &amp; Jakobsson, S. 2021. The Index-Based Ecological Condition Assessment (IBECA) - Technical protocol, version 1.0. NINA Report 1967. Norwegian Institute for Nature Research.</p>
<p>Töpper, J., Velle, L.G. &amp; Vandvik, V. 2018. Developing a method for assessment of ecological state based on indicator values after Ellenberg and Grime (revised edition). NINA Report 1529b. Norwegian Institute for Nature Research.</p>
<p>Tyler, T., Herbertsson, L., Olofsson, J., &amp; Olsson, P. A. 2021. Ecological indicator and traits values for Swedish vascular plants. Ecological In-dicators, 120. <a href="doi:10.1016/j.ecolind.2020.106923" class="uri">doi:10.1016/j.ecolind.2020.106923</a></p>
</div>
<div id="analyses-3" class="section level2" number="4.7">
<h2>
<span class="header-section-number">4.7</span> Analyses<a class="anchor" aria-label="anchor" href="#analyses-3"><i class="fas fa-link"></i></a>
</h2>
<div id="data-sets-2" class="section level3" number="4.7.1">
<h3>
<span class="header-section-number">4.7.1</span> Data sets<a class="anchor" aria-label="anchor" href="#data-sets-2"><i class="fas fa-link"></i></a>
</h3>
<p>ANO data</p>
<p>Plant indicators from Tyler et al. (2021)</p>
<p>Generalized species lists NiN</p>
<div id="data-handling" class="section level4" number="4.7.1.1">
<h4>
<span class="header-section-number">4.7.1.1</span> Data handling<a class="anchor" aria-label="anchor" href="#data-handling"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>Checking for errors</li>
<li>Checking species nomenclature in the different species lists to make species and indicator data possible to merge</li>
<li>Merging indicator data with monitoring data and indicator data with reference data
(not shown here, but documented in the code)</li>
</ul>
<p>leaving us with the monitoring data including plant indicators (ANO.sp.ind) and the reference data including plant indicators (NiN.wetland.cov)</p>
<div class="sourceCode" id="cb191"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ANO.sp.ind</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Species art_dekning</span></span>
<span><span class="co">#&gt; 1 Abies alba           0</span></span>
<span><span class="co">#&gt; 2 Abies alba           0</span></span>
<span><span class="co">#&gt; 3 Abies alba           0</span></span>
<span><span class="co">#&gt; 4 Abies alba           0</span></span>
<span><span class="co">#&gt; 5 Abies alba           0</span></span>
<span><span class="co">#&gt; 6 Abies alba           0</span></span>
<span><span class="co">#&gt;                           ParentGlobalID Light Moisture</span></span>
<span><span class="co">#&gt; 1 {CB1796B9-01F5-4109-B44E-4582CA855F93}     2        5</span></span>
<span><span class="co">#&gt; 2 {AB9ED5C2-E906-4C73-B543-EC6CB28B39D5}     2        5</span></span>
<span><span class="co">#&gt; 3 {32A9B462-5483-4D47-ADAF-78F11AF201AA}     2        5</span></span>
<span><span class="co">#&gt; 4 {004C000D-459B-4244-96F4-4FF8B06454D4}     2        5</span></span>
<span><span class="co">#&gt; 5 {B7DD61EE-A113-4486-A4B8-D50ACAAC648B}     2        5</span></span>
<span><span class="co">#&gt; 6 {0431743B-F268-4819-98F7-FFB7006E55BA}     2        5</span></span>
<span><span class="co">#&gt;   Soil_reaction_pH Nitrogen</span></span>
<span><span class="co">#&gt; 1                5        5</span></span>
<span><span class="co">#&gt; 2                5        5</span></span>
<span><span class="co">#&gt; 3                5        5</span></span>
<span><span class="co">#&gt; 4                5        5</span></span>
<span><span class="co">#&gt; 5                5        5</span></span>
<span><span class="co">#&gt; 6                5        5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">NiN.wetland.cov</span><span class="op">)</span></span>
<span><span class="co">#&gt;                        sp V3-C1a V3-C1b V3-C1c V3-C1d</span></span>
<span><span class="co">#&gt; 1    Abietinella abietina      0      0      0      0</span></span>
<span><span class="co">#&gt; 2        Acer platanoides      0      0      0      0</span></span>
<span><span class="co">#&gt; 3    Achillea millefolium      0      0      0      0</span></span>
<span><span class="co">#&gt; 4       Achillea ptarmica      0      0      0      0</span></span>
<span><span class="co">#&gt; 5         Acinos arvensis      0      0      0      0</span></span>
<span><span class="co">#&gt; 6 Aconitum septentrionale      0      0      0      0</span></span>
<span><span class="co">#&gt;   V3-C1e V1-C1a V1-C1b V1-C1c V1-C1d V1-C1e V1-C2a V1-C2b</span></span>
<span><span class="co">#&gt; 1      0      0      0      0      0      0      0      0</span></span>
<span><span class="co">#&gt; 2      0      0      0      0      0      0      0      0</span></span>
<span><span class="co">#&gt; 3      0      0      0      0      0      0      0      0</span></span>
<span><span class="co">#&gt; 4      0      0      0      0      0      0      0      0</span></span>
<span><span class="co">#&gt; 5      0      0      0      0      0      0      0      0</span></span>
<span><span class="co">#&gt; 6      0      0      0      0      0      0      0      0</span></span>
<span><span class="co">#&gt;   V1-C2c V1-C2d V1-C3a V1-C3b V1-C3c V1-C3d V1-C4a V1-C4b</span></span>
<span><span class="co">#&gt; 1      0      0      0      0      0      0      0      0</span></span>
<span><span class="co">#&gt; 2      0      0      0      0      0      0      0      0</span></span>
<span><span class="co">#&gt; 3      0      0      0      0      0      0      0      0</span></span>
<span><span class="co">#&gt; 4      0      0      0      0      0      0      0      0</span></span>
<span><span class="co">#&gt; 5      0      0      0      0      0      0      0      0</span></span>
<span><span class="co">#&gt; 6      0      0      0      0      0      0      0      0</span></span>
<span><span class="co">#&gt;   V1-C4c V1-C4d V1-C4e V1-C4f V1-C4g V1-C4h V3-C2 V1-C5</span></span>
<span><span class="co">#&gt; 1      0      0      0      0      0      0     0     0</span></span>
<span><span class="co">#&gt; 2      0      0      0      0      0      0     0     0</span></span>
<span><span class="co">#&gt; 3      0      0      0      0      0      0     0     0</span></span>
<span><span class="co">#&gt; 4      0      0      0      0      0      0     0     0</span></span>
<span><span class="co">#&gt; 5      0      0      0      0      0      0     0     0</span></span>
<span><span class="co">#&gt; 6      0      0      0      0      0      0     0     0</span></span>
<span><span class="co">#&gt;   V1-C6a V1-C6b V1-C7a V1-C7b V1-C8a V1-C8b V2-C1a V2-C1b</span></span>
<span><span class="co">#&gt; 1      0      0      0      0      0      0      0      0</span></span>
<span><span class="co">#&gt; 2      0      0      0      0      0      0      0      0</span></span>
<span><span class="co">#&gt; 3      0      0      0      0      0      0      0      0</span></span>
<span><span class="co">#&gt; 4      0      0      0      0      0      0      0      0</span></span>
<span><span class="co">#&gt; 5      0      0      0      0      0      0      0      0</span></span>
<span><span class="co">#&gt; 6      0      0      0      0      0      0      0      0</span></span>
<span><span class="co">#&gt;   V2-C2a V2-C2b V2-C3a V2-C3b V4-C2 V4-C3 V8-C1 V8-C2 V8-C3</span></span>
<span><span class="co">#&gt; 1      0      0      0      0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; 2      0      0      0      0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; 3      0      0      0      0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; 4      0      0      0      0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; 5      0      0      0      0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; 6      0      0      0      0     0     0     0     0     0</span></span>
<span><span class="co">#&gt;   Light Moisture Soil_reaction_pH Nitrogen</span></span>
<span><span class="co">#&gt; 1    NA       NA               NA       NA</span></span>
<span><span class="co">#&gt; 2     4        4                6        5</span></span>
<span><span class="co">#&gt; 3     6        2                5        5</span></span>
<span><span class="co">#&gt; 4     5        6                4        4</span></span>
<span><span class="co">#&gt; 5     7        1                7        3</span></span>
<span><span class="co">#&gt; 6     4        5                7        7</span></span></code></pre></div>
<p>For each ecosystem type with a NiN species list, we can calculate a community weighted mean (CWM) for the relevant functional plant indicators.
For wetland ecosystem we are testing “Light”, “Moisture”, “Soil_reaction_pH”, and “Nitrogen”. In order to get distributions of CWMs rather than one single value (for comparison with the empirical testing data) the NiN lists can be bootstrapped.</p>
<div id="bootstrap-function-for-frequency-abundance" class="section level5" number="4.7.1.1.1">
<h5>
<span class="header-section-number">4.7.1.1.1</span> bootstrap function for frequency abundance<a class="anchor" aria-label="anchor" href="#bootstrap-function-for-frequency-abundance"><i class="fas fa-link"></i></a>
</h5>
<ul>
<li>function to calculate community weighted means of selected indicator values (ind)</li>
<li>for species lists (sp) with given abundances in percent (or on a scale from 0 to 1) in one or more ‘sites’ (abun)</li>
<li>with a given number of iterations (iter),</li>
<li>with species given a certain minimum abundance occurring in all bootstraps (obl), and</li>
<li>with a given re-sampling ratio of the original species list (rat)</li>
<li>in every bootstrap iteration the abundance of the sampled species can be randomly changed by a limited amount if wished by introducing a re-sampling of abundance values from adjacent abundance steps with a certain probability (var.abun)</li>
</ul>
<p>Running the bootstraps</p>
<div class="sourceCode" id="cb192"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">NiN.wetland</span><span class="op">)</span></span>
<span><span class="co"># 1st column is the species</span></span>
<span><span class="co"># 2nd-46th column is the abundances of sp in different ecosystem types</span></span>
<span><span class="co"># 47th-50th column is the indicator values of the respective species</span></span>
<span><span class="co"># we choose 1000 iterations</span></span>
<span><span class="co"># species with abundance 1 (i.e. a max of 100%, must be included in each sample)</span></span>
<span><span class="co"># each sample re-samples 1/3 of the number of species</span></span>
<span><span class="co"># the abundance of the re-sampled species may vary (see bootstrap function for details)</span></span>
<span><span class="va">wetland.ref.cov</span> <span class="op">&lt;-</span> <span class="fu">indBoot.freq</span><span class="op">(</span>sp<span class="op">=</span><span class="va">NiN.wetland.cov</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,abun<span class="op">=</span><span class="va">NiN.wetland.cov</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">46</span><span class="op">]</span>,ind<span class="op">=</span><span class="va">NiN.wetland.cov</span><span class="op">[</span>,<span class="fl">47</span><span class="op">:</span><span class="fl">50</span><span class="op">]</span>,</span>
<span>                          iter<span class="op">=</span><span class="fl">1000</span>,obl<span class="op">=</span><span class="fl">1</span>,rat<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,var.abun<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fixing NaNs</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">)</span> <span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">v</span> <span class="op">&lt;-</span> <span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span></span>
<span>    <span class="va">v</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html">is.nan</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>    <span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">v</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb193"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;   V3-C1a   V3-C1b   V3-C1c   V3-C1d   V3-C1e   V1-C1a</span></span>
<span><span class="co">#&gt; 1     NA 5.537118 5.519421 4.516616 5.198992 5.615385</span></span>
<span><span class="co">#&gt; 2     NA 5.545455 5.303867 5.500000 4.984615 4.857143</span></span>
<span><span class="co">#&gt; 3     NA 6.588832 5.376543 5.904977 4.833333 5.972973</span></span>
<span><span class="co">#&gt; 4     NA 6.308017 5.042328 5.298507 5.245614 4.526066</span></span>
<span><span class="co">#&gt; 5     NA 5.761421 5.333333 5.822622 5.010862 5.758621</span></span>
<span><span class="co">#&gt; 6     NA 5.300000 5.672269 5.250000 5.076159 6.250000</span></span>
<span><span class="co">#&gt;     V1-C1b   V1-C1c   V1-C1d   V1-C1e   V1-C2a   V1-C2b</span></span>
<span><span class="co">#&gt; 1 5.665025 5.040943 5.444206 5.284579 4.516291 5.500000</span></span>
<span><span class="co">#&gt; 2 5.025050 5.823529 5.087358 5.187335 5.649860 6.029586</span></span>
<span><span class="co">#&gt; 3 6.312500 5.710956 5.576603 5.154487 5.781485 6.008580</span></span>
<span><span class="co">#&gt; 4 5.564772 5.372824 5.022936 5.016098 6.454976 4.520129</span></span>
<span><span class="co">#&gt; 5 5.471328 6.035370 5.608986 4.988055 6.576869 5.655134</span></span>
<span><span class="co">#&gt; 6 5.390782 4.984520 4.877800 4.603080 4.896975 6.073020</span></span>
<span><span class="co">#&gt;     V1-C2c   V1-C2d   V1-C3a   V1-C3b   V1-C3c   V1-C3d</span></span>
<span><span class="co">#&gt; 1 4.727120 5.234536 6.242694 5.292952 5.109108 5.214753</span></span>
<span><span class="co">#&gt; 2 5.256491 5.175023 6.561584 5.814873 6.167920 5.461832</span></span>
<span><span class="co">#&gt; 3 5.631367 5.672697 4.837065 5.289557 5.324456 4.809302</span></span>
<span><span class="co">#&gt; 4 5.417409 5.424689 6.581006 4.581459 5.104036 5.271104</span></span>
<span><span class="co">#&gt; 5 5.715929 5.782609 5.982505 5.684211 5.732940 5.369686</span></span>
<span><span class="co">#&gt; 6 4.876417 4.808176 5.975198 5.335248 5.198312 5.698343</span></span>
<span><span class="co">#&gt;     V1-C4a   V1-C4b   V1-C4c   V1-C4d   V1-C4e   V1-C4f</span></span>
<span><span class="co">#&gt; 1 5.674512 6.100610 5.916846 6.220841 6.673210 5.481481</span></span>
<span><span class="co">#&gt; 2 6.421354 5.719110 5.691259 5.397706 5.611799 6.233498</span></span>
<span><span class="co">#&gt; 3 5.486574 6.149593 5.485597 5.446296 6.174157 5.806962</span></span>
<span><span class="co">#&gt; 4 5.870466 5.936061 5.465432 6.407635 6.280048 5.459891</span></span>
<span><span class="co">#&gt; 5 6.063272 5.979097 5.489074 5.492537 6.101709 5.664537</span></span>
<span><span class="co">#&gt; 6 6.338515 6.172363 5.180462 5.120773 6.634538 6.200617</span></span>
<span><span class="co">#&gt;     V1-C4g   V1-C4h    V3-C2    V1-C5   V1-C6a   V1-C6b</span></span>
<span><span class="co">#&gt; 1 6.092386 6.057186 4.996385 4.830956 5.077866 4.628153</span></span>
<span><span class="co">#&gt; 2 5.801220 4.922374 4.764331 4.679059 4.695021 4.988584</span></span>
<span><span class="co">#&gt; 3 5.435173 5.481737 4.781609 4.649430 4.883855 4.942087</span></span>
<span><span class="co">#&gt; 4 5.944277 6.204067 5.198690 4.653085 4.924060 4.614800</span></span>
<span><span class="co">#&gt; 5 5.183016 6.196417 5.224044 4.577465 4.993554 4.574797</span></span>
<span><span class="co">#&gt; 6 5.994172 5.525847 4.768879 4.756207 4.760917 4.516348</span></span>
<span><span class="co">#&gt;     V1-C7a   V1-C7b   V1-C8a   V1-C8b   V2-C1a   V2-C1b</span></span>
<span><span class="co">#&gt; 1 4.544482 4.371762 5.047897 4.633618 4.287703 4.045110</span></span>
<span><span class="co">#&gt; 2 4.492043 4.409722 5.018118 4.484203 4.110429 4.326881</span></span>
<span><span class="co">#&gt; 3 4.759162 5.117394 5.100655 4.734568 4.365521 4.210180</span></span>
<span><span class="co">#&gt; 4 5.099964 4.587847 4.609169 4.303894 3.932933 4.168017</span></span>
<span><span class="co">#&gt; 5 4.574026 4.980466 4.306452 5.038488 4.954111 4.247664</span></span>
<span><span class="co">#&gt; 6 4.996280 4.733447 5.742741 4.772339 4.612745 4.427966</span></span>
<span><span class="co">#&gt;     V2-C2a   V2-C2b   V2-C3a   V2-C3b    V4-C2    V4-C3</span></span>
<span><span class="co">#&gt; 1 4.471163 4.109362 4.081429 3.454026 4.647626 5.152364</span></span>
<span><span class="co">#&gt; 2 4.275137 3.836049 4.134050 4.055677 4.804082 5.327044</span></span>
<span><span class="co">#&gt; 3 4.328051 3.587933 4.015032 4.045385 4.727341 5.645874</span></span>
<span><span class="co">#&gt; 4 4.623957 3.827967 4.588215 4.065883 4.913506 4.729878</span></span>
<span><span class="co">#&gt; 5 4.558872 4.484615 3.762264 3.839943 5.491614 4.388280</span></span>
<span><span class="co">#&gt; 6 3.874477 3.611697 4.451854 4.808479 4.920083 4.641156</span></span>
<span><span class="co">#&gt;      V8-C1    V8-C2    V8-C3</span></span>
<span><span class="co">#&gt; 1 3.830428 4.969906 4.509828</span></span>
<span><span class="co">#&gt; 2 4.554674 4.690696 4.581641</span></span>
<span><span class="co">#&gt; 3 4.714435 4.460696 4.545655</span></span>
<span><span class="co">#&gt; 4 4.507944 4.876977 4.733694</span></span>
<span><span class="co">#&gt; 5 4.871125 4.796040 4.844728</span></span>
<span><span class="co">#&gt; 6 4.293290 4.564882 4.709910</span></span></code></pre></div>
<p>This results in an R-list with a slot for every selected indicator, and in every slot there’s a data frame with as many columns as there are NiN species lists and as many rows as there were iterations in the bootstrap.
Next, we need to derive scaling values from these bootstrap-lists (the columns) for every mapping unit in NiN. Here, we define things in the following way:</p>
<ul>
<li>Median = reference values</li>
<li>0.025 and 0.975 quantiles = lower and upper limit values</li>
<li>min and max of the respective indicator’s scale = min/max values</li>
</ul>
<pre><code>#&gt;   V3-C1a   V3-C1b   V3-C1c   V3-C1d   V3-C1e   V1-C1a
#&gt; 1     NA 5.537118 5.519421 4.516616 5.198992 5.615385
#&gt; 2     NA 5.545455 5.303867 5.500000 4.984615 4.857143
#&gt; 3     NA 6.588832 5.376543 5.904977 4.833333 5.972973
#&gt; 4     NA 6.308017 5.042328 5.298507 5.245614 4.526066
#&gt; 5     NA 5.761421 5.333333 5.822622 5.010862 5.758621
#&gt; 6     NA 5.300000 5.672269 5.250000 5.076159 6.250000
#&gt;     V1-C1b   V1-C1c   V1-C1d   V1-C1e   V1-C2a   V1-C2b
#&gt; 1 5.665025 5.040943 5.444206 5.284579 4.516291 5.500000
#&gt; 2 5.025050 5.823529 5.087358 5.187335 5.649860 6.029586
#&gt; 3 6.312500 5.710956 5.576603 5.154487 5.781485 6.008580
#&gt; 4 5.564772 5.372824 5.022936 5.016098 6.454976 4.520129
#&gt; 5 5.471328 6.035370 5.608986 4.988055 6.576869 5.655134
#&gt; 6 5.390782 4.984520 4.877800 4.603080 4.896975 6.073020
#&gt;     V1-C2c   V1-C2d   V1-C3a   V1-C3b   V1-C3c   V1-C3d
#&gt; 1 4.727120 5.234536 6.242694 5.292952 5.109108 5.214753
#&gt; 2 5.256491 5.175023 6.561584 5.814873 6.167920 5.461832
#&gt; 3 5.631367 5.672697 4.837065 5.289557 5.324456 4.809302
#&gt; 4 5.417409 5.424689 6.581006 4.581459 5.104036 5.271104
#&gt; 5 5.715929 5.782609 5.982505 5.684211 5.732940 5.369686
#&gt; 6 4.876417 4.808176 5.975198 5.335248 5.198312 5.698343
#&gt;     V1-C4a   V1-C4b   V1-C4c   V1-C4d   V1-C4e   V1-C4f
#&gt; 1 5.674512 6.100610 5.916846 6.220841 6.673210 5.481481
#&gt; 2 6.421354 5.719110 5.691259 5.397706 5.611799 6.233498
#&gt; 3 5.486574 6.149593 5.485597 5.446296 6.174157 5.806962
#&gt; 4 5.870466 5.936061 5.465432 6.407635 6.280048 5.459891
#&gt; 5 6.063272 5.979097 5.489074 5.492537 6.101709 5.664537
#&gt; 6 6.338515 6.172363 5.180462 5.120773 6.634538 6.200617
#&gt;     V1-C4g   V1-C4h    V3-C2    V1-C5   V1-C6a   V1-C6b
#&gt; 1 6.092386 6.057186 4.996385 4.830956 5.077866 4.628153
#&gt; 2 5.801220 4.922374 4.764331 4.679059 4.695021 4.988584
#&gt; 3 5.435173 5.481737 4.781609 4.649430 4.883855 4.942087
#&gt; 4 5.944277 6.204067 5.198690 4.653085 4.924060 4.614800
#&gt; 5 5.183016 6.196417 5.224044 4.577465 4.993554 4.574797
#&gt; 6 5.994172 5.525847 4.768879 4.756207 4.760917 4.516348
#&gt;     V1-C7a   V1-C7b   V1-C8a   V1-C8b   V2-C1a   V2-C1b
#&gt; 1 4.544482 4.371762 5.047897 4.633618 4.287703 4.045110
#&gt; 2 4.492043 4.409722 5.018118 4.484203 4.110429 4.326881
#&gt; 3 4.759162 5.117394 5.100655 4.734568 4.365521 4.210180
#&gt; 4 5.099964 4.587847 4.609169 4.303894 3.932933 4.168017
#&gt; 5 4.574026 4.980466 4.306452 5.038488 4.954111 4.247664
#&gt; 6 4.996280 4.733447 5.742741 4.772339 4.612745 4.427966
#&gt;     V2-C2a   V2-C2b   V2-C3a   V2-C3b    V4-C2    V4-C3
#&gt; 1 4.471163 4.109362 4.081429 3.454026 4.647626 5.152364
#&gt; 2 4.275137 3.836049 4.134050 4.055677 4.804082 5.327044
#&gt; 3 4.328051 3.587933 4.015032 4.045385 4.727341 5.645874
#&gt; 4 4.623957 3.827967 4.588215 4.065883 4.913506 4.729878
#&gt; 5 4.558872 4.484615 3.762264 3.839943 5.491614 4.388280
#&gt; 6 3.874477 3.611697 4.451854 4.808479 4.920083 4.641156
#&gt;      V8-C1    V8-C2    V8-C3
#&gt; 1 3.830428 4.969906 4.509828
#&gt; 2 4.554674 4.690696 4.581641
#&gt; 3 4.714435 4.460696 4.545655
#&gt; 4 4.507944 4.876977 4.733694
#&gt; 5 4.871125 4.796040 4.844728
#&gt; 6 4.293290 4.564882 4.709910
#&gt;  [1] V3-C1a V3-C1b V3-C1c V3-C1d V3-C1e V1-C1a V1-C1b V1-C1c
#&gt;  [9] V1-C1d V1-C1e V1-C2a V1-C2b V1-C2c V1-C2d V1-C3a V1-C3b
#&gt; [17] V1-C3c V1-C3d V1-C4a V1-C4b V1-C4c V1-C4d V1-C4e V1-C4f
#&gt; [25] V1-C4g V1-C4h V3-C2  V1-C5  V1-C6a V1-C6b V1-C7a V1-C7b
#&gt; [33] V1-C8a V1-C8b V2-C1a V2-C1b V2-C2a V2-C2b V2-C3a V2-C3b
#&gt; [41] V4-C2  V4-C3  V8-C1  V8-C2  V8-C3 
#&gt; &lt;0 rows&gt; (or 0-length row.names)
#&gt;  [1] "V3-C1" "V1-C1" "V1-C2" "V1-C3" "V1-C4" "V3-C2" "V1-C5"
#&gt;  [8] "V1-C6" "V1-C7" "V1-C8" "V2-C1" "V2-C2" "V2-C3" "V4-C2"
#&gt; [15] "V4-C3" "V8-C1" "V8-C2" "V8-C3"
#&gt;  [1] "V3-C1a" "V3-C1b" "V3-C1c" "V3-C1d" "V3-C1e" "V1-C1a"
#&gt;  [7] "V1-C1b" "V1-C1c" "V1-C1d" "V1-C1e" "V1-C2a" "V1-C2b"
#&gt; [13] "V1-C2c" "V1-C2d" "V1-C3a" "V1-C3b" "V1-C3c" "V1-C3d"
#&gt; [19] "V1-C4a" "V1-C4b" "V1-C4c" "V1-C4d" "V1-C4e" "V1-C4f"
#&gt; [25] "V1-C4g" "V1-C4h" "V3-C2"  "V1-C5"  "V1-C6a" "V1-C6b"
#&gt; [31] "V1-C7a" "V1-C7b" "V1-C8a" "V1-C8b" "V2-C1a" "V2-C1b"
#&gt; [37] "V2-C2a" "V2-C2b" "V2-C3a" "V2-C3b" "V4-C2"  "V4-C3" 
#&gt; [43] "V8-C1"  "V8-C2"  "V8-C3"
#&gt;  [1] "V3-C1" "V1-C1" "V1-C2" "V1-C3" "V1-C4" "V1-C6" "V1-C7"
#&gt;  [8] "V1-C8" "V2-C1" "V2-C2" "V2-C3"
#&gt; [1] 1 2 3 4 5
#&gt;          V1       V2       V3       V4       V5       V6
#&gt; 1  4.650288 4.966443 5.242167 4.730467 5.450611 6.287387
#&gt; 2  4.412518 4.678375 4.983052 5.024660 5.705182 6.515412
#&gt; 3  4.181051 4.885976 5.575828 5.959727 7.108910 7.929956
#&gt; 4  4.265677 4.970310 5.728271 6.072307 6.944127 7.598114
#&gt; 5  4.026841 4.715468 5.326302 6.041072 7.262666 8.132334
#&gt; 6  4.331418 4.760871 5.131781 6.519606 7.245583 7.905369
#&gt; 7  4.379654 4.687800 4.977008 6.665973 7.502367 8.189600
#&gt; 8  4.676349 5.342796 6.777778 4.473684 6.424165 8.467209
#&gt; 9  4.735842 5.388481 6.835764 4.805905 6.985401 9.142989
#&gt; 10 4.684189 5.548379 6.753948 5.703439 7.826415 9.337017
#&gt; 11 4.644572 5.484308 6.487499 6.503395 8.213247 9.445956
#&gt; 12 4.552329 5.686564 6.494601 6.530966 8.109657 9.294677
#&gt; 13 4.219840 4.779976 5.423544 5.518264 7.313205 9.248771
#&gt; 14 4.166529 4.692662 5.433001 5.869488 7.241861 8.685496
#&gt; 15 4.206007 4.887366 5.758946 5.712864 7.085127 8.097239
#&gt; 16 3.657798 4.231589 4.953344 4.851244 5.751619 8.797058
#&gt; 17 3.446326 4.238208 4.940917 5.141012 6.474238 8.285018
#&gt; 18 3.242379 4.121921 4.738912 5.556370 6.814557 8.218944
#&gt;          V7       V8       V9      V10      V11      V12
#&gt; 1  1.655954 2.069755 2.814447 1.798326 2.101967 2.488591
#&gt; 2  1.858930 2.328319 2.983125 1.707630 2.083033 2.676179
#&gt; 3  3.022003 3.802753 4.769512 2.638866 3.345274 4.191821
#&gt; 4  3.495213 4.389075 5.344473 2.841443 3.687148 5.207416
#&gt; 5  3.322124 4.182404 4.879182 3.634319 4.453431 5.308846
#&gt; 6  4.279028 4.750092 5.202615 4.680611 5.400094 6.103431
#&gt; 7  4.502166 4.913133 5.280336 5.067941 5.752526 6.270266
#&gt; 8  1.082218 1.951116 3.292487 1.006211 1.544669 2.200000
#&gt; 9  1.304445 1.971098 4.000000 1.049953 1.613392 2.539114
#&gt; 10 1.623551 2.737952 4.376870 1.202420 1.908494 3.136698
#&gt; 11 2.307563 3.592224 4.848489 1.360667 2.344593 3.836578
#&gt; 12 2.929122 4.566270 5.959868 1.712485 2.626977 3.948144
#&gt; 13 2.201466 3.168781 4.330514 2.067017 2.802510 3.660364
#&gt; 14 2.663268 3.405840 4.365503 2.368457 3.072115 3.880840
#&gt; 15 3.267379 4.278356 5.369703 2.553046 3.524687 4.784577
#&gt; 16 2.388756 2.849982 4.133991 2.482721 3.078022 4.157467
#&gt; 17 2.926638 3.625899 4.478642 3.222495 4.096205 5.004499
#&gt; 18 3.325443 4.107336 4.837873 3.954204 4.890875 5.899529
#&gt;      NiN
#&gt; 1  V3-C2
#&gt; 2  V1-C5
#&gt; 3  V4-C2
#&gt; 4  V4-C3
#&gt; 5  V8-C1
#&gt; 6  V8-C2
#&gt; 7  V8-C3
#&gt; 8  V3-C1
#&gt; 9  V1-C1
#&gt; 10 V1-C2
#&gt; 11 V1-C3
#&gt; 12 V1-C4
#&gt; 13 V1-C6
#&gt; 14 V1-C7
#&gt; 15 V1-C8
#&gt; 16 V2-C1
#&gt; 17 V2-C2
#&gt; 18 V2-C3
#&gt;      V1   V2   V3   V4   V5   V6   V7   V8   V9  V10  V11
#&gt; 1  4.65 4.97 5.24 4.73 5.45 6.29 1.66 2.07 2.81 1.80 2.10
#&gt; 2  4.41 4.68 4.98 5.02 5.71 6.52 1.86 2.33 2.98 1.71 2.08
#&gt; 3  4.18 4.89 5.58 5.96 7.11 7.93 3.02 3.80 4.77 2.64 3.35
#&gt; 4  4.27 4.97 5.73 6.07 6.94 7.60 3.50 4.39 5.34 2.84 3.69
#&gt; 5  4.03 4.72 5.33 6.04 7.26 8.13 3.32 4.18 4.88 3.63 4.45
#&gt; 6  4.33 4.76 5.13 6.52 7.25 7.91 4.28 4.75 5.20 4.68 5.40
#&gt; 7  4.38 4.69 4.98 6.67 7.50 8.19 4.50 4.91 5.28 5.07 5.75
#&gt; 8  4.68 5.34 6.78 4.47 6.42 8.47 1.08 1.95 3.29 1.01 1.54
#&gt; 9  4.74 5.39 6.84 4.81 6.99 9.14 1.30 1.97 4.00 1.05 1.61
#&gt; 10 4.68 5.55 6.75 5.70 7.83 9.34 1.62 2.74 4.38 1.20 1.91
#&gt; 11 4.64 5.48 6.49 6.50 8.21 9.45 2.31 3.59 4.85 1.36 2.34
#&gt; 12 4.55 5.69 6.49 6.53 8.11 9.29 2.93 4.57 5.96 1.71 2.63
#&gt; 13 4.22 4.78 5.42 5.52 7.31 9.25 2.20 3.17 4.33 2.07 2.80
#&gt; 14 4.17 4.69 5.43 5.87 7.24 8.69 2.66 3.41 4.37 2.37 3.07
#&gt; 15 4.21 4.89 5.76 5.71 7.09 8.10 3.27 4.28 5.37 2.55 3.52
#&gt; 16 3.66 4.23 4.95 4.85 5.75 8.80 2.39 2.85 4.13 2.48 3.08
#&gt; 17 3.45 4.24 4.94 5.14 6.47 8.29 2.93 3.63 4.48 3.22 4.10
#&gt; 18 3.24 4.12 4.74 5.56 6.81 8.22 3.33 4.11 4.84 3.95 4.89
#&gt;     V12
#&gt; 1  2.49
#&gt; 2  2.68
#&gt; 3  4.19
#&gt; 4  5.21
#&gt; 5  5.31
#&gt; 6  6.10
#&gt; 7  6.27
#&gt; 8  2.20
#&gt; 9  2.54
#&gt; 10 3.14
#&gt; 11 3.84
#&gt; 12 3.95
#&gt; 13 3.66
#&gt; 14 3.88
#&gt; 15 4.78
#&gt; 16 4.16
#&gt; 17 5.00
#&gt; 18 5.90
#&gt;    Light_q2.5      Light_q50      Light_q97.5   
#&gt;  Min.   :3.242   Min.   :4.122   Min.   :4.739  
#&gt;  1st Qu.:4.170   1st Qu.:4.689   1st Qu.:5.020  
#&gt;  Median :4.299   Median :4.833   Median :5.428  
#&gt;  Mean   :4.249   Mean   :4.893   Mean   :5.642  
#&gt;  3rd Qu.:4.622   3rd Qu.:5.250   3rd Qu.:6.305  
#&gt;  Max.   :4.736   Max.   :5.687   Max.   :6.836  
#&gt;    Moist_q2.5      Moist_q50      Moist_q97.5   
#&gt;  Min.   :4.474   Min.   :5.451   Min.   :6.287  
#&gt;  1st Qu.:5.054   1st Qu.:6.559   1st Qu.:7.972  
#&gt;  Median :5.708   Median :7.097   Median :8.252  
#&gt;  Mean   :5.649   Mean   :6.970   Mean   :8.310  
#&gt;  3rd Qu.:6.064   3rd Qu.:7.301   3rd Qu.:9.057  
#&gt;  Max.   :6.666   Max.   :8.213   Max.   :9.446  
#&gt;     pH_q2.5          pH_q50         pH_q97.5    
#&gt;  Min.   :1.082   Min.   :1.951   Min.   :2.814  
#&gt;  1st Qu.:1.945   1st Qu.:2.766   1st Qu.:4.183  
#&gt;  Median :2.795   Median :3.609   Median :4.624  
#&gt;  Mean   :2.675   Mean   :3.483   Mean   :4.515  
#&gt;  3rd Qu.:3.308   3rd Qu.:4.254   3rd Qu.:5.122  
#&gt;  Max.   :4.502   Max.   :4.913   Max.   :5.960  
#&gt;  Nitrogen_q2.5    Nitrogen_q50   Nitrogen_q97.5 
#&gt;  Min.   :1.006   Min.   :1.545   Min.   :2.200  
#&gt;  1st Qu.:1.709   1st Qu.:2.163   1st Qu.:3.268  
#&gt;  Median :2.426   Median :3.075   Median :4.053  
#&gt;  Mean   :2.519   Mean   :3.240   Mean   :4.183  
#&gt;  3rd Qu.:3.127   3rd Qu.:3.994   3rd Qu.:5.157  
#&gt;  Max.   :5.068   Max.   :5.753   Max.   :6.270  
#&gt;      NiN           
#&gt;  Length:18         
#&gt;  Class :character  
#&gt;  Mode  :character  
#&gt;                    
#&gt;                    
#&gt; 
#&gt;    Light_q2.5 Light_q50 Light_q97.5 Moist_q2.5 Moist_q50
#&gt; 1    4.650288  4.966443    5.242167   4.730467  5.450611
#&gt; 2    4.412518  4.678375    4.983052   5.024660  5.705182
#&gt; 3    4.181051  4.885976    5.575828   5.959727  7.108910
#&gt; 4    4.265677  4.970310    5.728271   6.072307  6.944127
#&gt; 5    4.026841  4.715468    5.326302   6.041072  7.262666
#&gt; 6    4.331418  4.760871    5.131781   6.519606  7.245583
#&gt; 7    4.379654  4.687800    4.977008   6.665973  7.502367
#&gt; 8    4.676349  5.342796    6.777778   4.473684  6.424165
#&gt; 9    4.735842  5.388481    6.835764   4.805905  6.985401
#&gt; 10   4.684189  5.548379    6.753948   5.703439  7.826415
#&gt; 11   4.644572  5.484308    6.487499   6.503395  8.213247
#&gt; 12   4.552329  5.686564    6.494601   6.530966  8.109657
#&gt; 13   4.219840  4.779976    5.423544   5.518264  7.313205
#&gt; 14   4.166529  4.692662    5.433001   5.869488  7.241861
#&gt; 15   4.206007  4.887366    5.758946   5.712864  7.085127
#&gt; 16   3.657798  4.231589    4.953344   4.851244  5.751619
#&gt; 17   3.446326  4.238208    4.940917   5.141012  6.474238
#&gt; 18   3.242379  4.121921    4.738912   5.556370  6.814557
#&gt;    Moist_q97.5  pH_q2.5   pH_q50 pH_q97.5 Nitrogen_q2.5
#&gt; 1     6.287387 1.655954 2.069755 2.814447      1.798326
#&gt; 2     6.515412 1.858930 2.328319 2.983125      1.707630
#&gt; 3     7.929956 3.022003 3.802753 4.769512      2.638866
#&gt; 4     7.598114 3.495213 4.389075 5.344473      2.841443
#&gt; 5     8.132334 3.322124 4.182404 4.879182      3.634319
#&gt; 6     7.905369 4.279028 4.750092 5.202615      4.680611
#&gt; 7     8.189600 4.502166 4.913133 5.280336      5.067941
#&gt; 8     8.467209 1.082218 1.951116 3.292487      1.006211
#&gt; 9     9.142989 1.304445 1.971098 4.000000      1.049953
#&gt; 10    9.337017 1.623551 2.737952 4.376870      1.202420
#&gt; 11    9.445956 2.307563 3.592224 4.848489      1.360667
#&gt; 12    9.294677 2.929122 4.566270 5.959868      1.712485
#&gt; 13    9.248771 2.201466 3.168781 4.330514      2.067017
#&gt; 14    8.685496 2.663268 3.405840 4.365503      2.368457
#&gt; 15    8.097239 3.267379 4.278356 5.369703      2.553046
#&gt; 16    8.797058 2.388756 2.849982 4.133991      2.482721
#&gt; 17    8.285018 2.926638 3.625899 4.478642      3.222495
#&gt; 18    8.218944 3.325443 4.107336 4.837873      3.954204
#&gt;    Nitrogen_q50 Nitrogen_q97.5    NiN
#&gt; 1      2.101967       2.488591 V3-C-2
#&gt; 2      2.083033       2.676179 V1-C-5
#&gt; 3      3.345274       4.191821 V4-C-2
#&gt; 4      3.687148       5.207416 V4-C-3
#&gt; 5      4.453431       5.308846 V8-C-1
#&gt; 6      5.400094       6.103431 V8-C-2
#&gt; 7      5.752526       6.270266 V8-C-3
#&gt; 8      1.544669       2.200000 V3-C-1
#&gt; 9      1.613392       2.539114 V1-C-1
#&gt; 10     1.908494       3.136698 V1-C-2
#&gt; 11     2.344593       3.836578 V1-C-3
#&gt; 12     2.626977       3.948144 V1-C-4
#&gt; 13     2.802510       3.660364 V1-C-6
#&gt; 14     3.072115       3.880840 V1-C-7
#&gt; 15     3.524687       4.784577 V1-C-8
#&gt; 16     3.078022       4.157467 V2-C-1
#&gt; 17     4.096205       5.004499 V2-C-2
#&gt; 18     4.890875       5.899529 V2-C-3
#&gt;          N1 hoved  grunn county region       Ind       Rv
#&gt; 1   wetland    NA V3-C-2    all    all    Light1 4.966443
#&gt; 2   wetland    NA V3-C-2    all    all    Light2 4.966443
#&gt; 3   wetland    NA V1-C-5    all    all    Light1 4.678375
#&gt; 4   wetland    NA V1-C-5    all    all    Light2 4.678375
#&gt; 5   wetland    NA V4-C-2    all    all    Light1 4.885976
#&gt; 6   wetland    NA V4-C-2    all    all    Light2 4.885976
#&gt; 7   wetland    NA V4-C-3    all    all    Light1 4.970310
#&gt; 8   wetland    NA V4-C-3    all    all    Light2 4.970310
#&gt; 9   wetland    NA V8-C-1    all    all    Light1 4.715468
#&gt; 10  wetland    NA V8-C-1    all    all    Light2 4.715468
#&gt; 11  wetland    NA V8-C-2    all    all    Light1 4.760871
#&gt; 12  wetland    NA V8-C-2    all    all    Light2 4.760871
#&gt; 13  wetland    NA V8-C-3    all    all    Light1 4.687800
#&gt; 14  wetland    NA V8-C-3    all    all    Light2 4.687800
#&gt; 15  wetland    NA V3-C-1    all    all    Light1 5.342796
#&gt; 16  wetland    NA V3-C-1    all    all    Light2 5.342796
#&gt; 17  wetland    NA V1-C-1    all    all    Light1 5.388481
#&gt; 18  wetland    NA V1-C-1    all    all    Light2 5.388481
#&gt; 19  wetland    NA V1-C-2    all    all    Light1 5.548379
#&gt; 20  wetland    NA V1-C-2    all    all    Light2 5.548379
#&gt; 21  wetland    NA V1-C-3    all    all    Light1 5.484308
#&gt; 22  wetland    NA V1-C-3    all    all    Light2 5.484308
#&gt; 23  wetland    NA V1-C-4    all    all    Light1 5.686564
#&gt; 24  wetland    NA V1-C-4    all    all    Light2 5.686564
#&gt; 25  wetland    NA V1-C-6    all    all    Light1 4.779976
#&gt; 26  wetland    NA V1-C-6    all    all    Light2 4.779976
#&gt; 27  wetland    NA V1-C-7    all    all    Light1 4.692662
#&gt; 28  wetland    NA V1-C-7    all    all    Light2 4.692662
#&gt; 29  wetland    NA V1-C-8    all    all    Light1 4.887366
#&gt; 30  wetland    NA V1-C-8    all    all    Light2 4.887366
#&gt; 31  wetland    NA V2-C-1    all    all    Light1 4.231589
#&gt; 32  wetland    NA V2-C-1    all    all    Light2 4.231589
#&gt; 33  wetland    NA V2-C-2    all    all    Light1 4.238208
#&gt; 34  wetland    NA V2-C-2    all    all    Light2 4.238208
#&gt; 35  wetland    NA V2-C-3    all    all    Light1 4.121921
#&gt; 36  wetland    NA V2-C-3    all    all    Light2 4.121921
#&gt; 37  wetland    NA V3-C-2    all    all    Moist1 5.450611
#&gt; 38  wetland    NA V3-C-2    all    all    Moist2 5.450611
#&gt; 39  wetland    NA V1-C-5    all    all    Moist1 5.705182
#&gt; 40  wetland    NA V1-C-5    all    all    Moist2 5.705182
#&gt; 41  wetland    NA V4-C-2    all    all    Moist1 7.108910
#&gt; 42  wetland    NA V4-C-2    all    all    Moist2 7.108910
#&gt; 43  wetland    NA V4-C-3    all    all    Moist1 6.944127
#&gt; 44  wetland    NA V4-C-3    all    all    Moist2 6.944127
#&gt; 45  wetland    NA V8-C-1    all    all    Moist1 7.262666
#&gt; 46  wetland    NA V8-C-1    all    all    Moist2 7.262666
#&gt; 47  wetland    NA V8-C-2    all    all    Moist1 7.245583
#&gt; 48  wetland    NA V8-C-2    all    all    Moist2 7.245583
#&gt; 49  wetland    NA V8-C-3    all    all    Moist1 7.502367
#&gt; 50  wetland    NA V8-C-3    all    all    Moist2 7.502367
#&gt; 51  wetland    NA V3-C-1    all    all    Moist1 6.424165
#&gt; 52  wetland    NA V3-C-1    all    all    Moist2 6.424165
#&gt; 53  wetland    NA V1-C-1    all    all    Moist1 6.985401
#&gt; 54  wetland    NA V1-C-1    all    all    Moist2 6.985401
#&gt; 55  wetland    NA V1-C-2    all    all    Moist1 7.826415
#&gt; 56  wetland    NA V1-C-2    all    all    Moist2 7.826415
#&gt; 57  wetland    NA V1-C-3    all    all    Moist1 8.213247
#&gt; 58  wetland    NA V1-C-3    all    all    Moist2 8.213247
#&gt; 59  wetland    NA V1-C-4    all    all    Moist1 8.109657
#&gt; 60  wetland    NA V1-C-4    all    all    Moist2 8.109657
#&gt; 61  wetland    NA V1-C-6    all    all    Moist1 7.313205
#&gt; 62  wetland    NA V1-C-6    all    all    Moist2 7.313205
#&gt; 63  wetland    NA V1-C-7    all    all    Moist1 7.241861
#&gt; 64  wetland    NA V1-C-7    all    all    Moist2 7.241861
#&gt; 65  wetland    NA V1-C-8    all    all    Moist1 7.085127
#&gt; 66  wetland    NA V1-C-8    all    all    Moist2 7.085127
#&gt; 67  wetland    NA V2-C-1    all    all    Moist1 5.751619
#&gt; 68  wetland    NA V2-C-1    all    all    Moist2 5.751619
#&gt; 69  wetland    NA V2-C-2    all    all    Moist1 6.474238
#&gt; 70  wetland    NA V2-C-2    all    all    Moist2 6.474238
#&gt; 71  wetland    NA V2-C-3    all    all    Moist1 6.814557
#&gt; 72  wetland    NA V2-C-3    all    all    Moist2 6.814557
#&gt; 73  wetland    NA V3-C-2    all    all       pH1 2.069755
#&gt; 74  wetland    NA V3-C-2    all    all       pH2 2.069755
#&gt; 75  wetland    NA V1-C-5    all    all       pH1 2.328319
#&gt; 76  wetland    NA V1-C-5    all    all       pH2 2.328319
#&gt; 77  wetland    NA V4-C-2    all    all       pH1 3.802753
#&gt; 78  wetland    NA V4-C-2    all    all       pH2 3.802753
#&gt; 79  wetland    NA V4-C-3    all    all       pH1 4.389075
#&gt; 80  wetland    NA V4-C-3    all    all       pH2 4.389075
#&gt; 81  wetland    NA V8-C-1    all    all       pH1 4.182404
#&gt; 82  wetland    NA V8-C-1    all    all       pH2 4.182404
#&gt; 83  wetland    NA V8-C-2    all    all       pH1 4.750092
#&gt; 84  wetland    NA V8-C-2    all    all       pH2 4.750092
#&gt; 85  wetland    NA V8-C-3    all    all       pH1 4.913133
#&gt; 86  wetland    NA V8-C-3    all    all       pH2 4.913133
#&gt; 87  wetland    NA V3-C-1    all    all       pH1 1.951116
#&gt; 88  wetland    NA V3-C-1    all    all       pH2 1.951116
#&gt; 89  wetland    NA V1-C-1    all    all       pH1 1.971098
#&gt; 90  wetland    NA V1-C-1    all    all       pH2 1.971098
#&gt; 91  wetland    NA V1-C-2    all    all       pH1 2.737952
#&gt; 92  wetland    NA V1-C-2    all    all       pH2 2.737952
#&gt; 93  wetland    NA V1-C-3    all    all       pH1 3.592224
#&gt; 94  wetland    NA V1-C-3    all    all       pH2 3.592224
#&gt; 95  wetland    NA V1-C-4    all    all       pH1 4.566270
#&gt; 96  wetland    NA V1-C-4    all    all       pH2 4.566270
#&gt; 97  wetland    NA V1-C-6    all    all       pH1 3.168781
#&gt; 98  wetland    NA V1-C-6    all    all       pH2 3.168781
#&gt; 99  wetland    NA V1-C-7    all    all       pH1 3.405840
#&gt; 100 wetland    NA V1-C-7    all    all       pH2 3.405840
#&gt; 101 wetland    NA V1-C-8    all    all       pH1 4.278356
#&gt; 102 wetland    NA V1-C-8    all    all       pH2 4.278356
#&gt; 103 wetland    NA V2-C-1    all    all       pH1 2.849982
#&gt; 104 wetland    NA V2-C-1    all    all       pH2 2.849982
#&gt; 105 wetland    NA V2-C-2    all    all       pH1 3.625899
#&gt; 106 wetland    NA V2-C-2    all    all       pH2 3.625899
#&gt; 107 wetland    NA V2-C-3    all    all       pH1 4.107336
#&gt; 108 wetland    NA V2-C-3    all    all       pH2 4.107336
#&gt; 109 wetland    NA V3-C-2    all    all Nitrogen1 2.101967
#&gt; 110 wetland    NA V3-C-2    all    all Nitrogen2 2.101967
#&gt; 111 wetland    NA V1-C-5    all    all Nitrogen1 2.083033
#&gt; 112 wetland    NA V1-C-5    all    all Nitrogen2 2.083033
#&gt; 113 wetland    NA V4-C-2    all    all Nitrogen1 3.345274
#&gt; 114 wetland    NA V4-C-2    all    all Nitrogen2 3.345274
#&gt; 115 wetland    NA V4-C-3    all    all Nitrogen1 3.687148
#&gt; 116 wetland    NA V4-C-3    all    all Nitrogen2 3.687148
#&gt; 117 wetland    NA V8-C-1    all    all Nitrogen1 4.453431
#&gt; 118 wetland    NA V8-C-1    all    all Nitrogen2 4.453431
#&gt; 119 wetland    NA V8-C-2    all    all Nitrogen1 5.400094
#&gt; 120 wetland    NA V8-C-2    all    all Nitrogen2 5.400094
#&gt; 121 wetland    NA V8-C-3    all    all Nitrogen1 5.752526
#&gt; 122 wetland    NA V8-C-3    all    all Nitrogen2 5.752526
#&gt; 123 wetland    NA V3-C-1    all    all Nitrogen1 1.544669
#&gt; 124 wetland    NA V3-C-1    all    all Nitrogen2 1.544669
#&gt; 125 wetland    NA V1-C-1    all    all Nitrogen1 1.613392
#&gt; 126 wetland    NA V1-C-1    all    all Nitrogen2 1.613392
#&gt; 127 wetland    NA V1-C-2    all    all Nitrogen1 1.908494
#&gt; 128 wetland    NA V1-C-2    all    all Nitrogen2 1.908494
#&gt; 129 wetland    NA V1-C-3    all    all Nitrogen1 2.344593
#&gt; 130 wetland    NA V1-C-3    all    all Nitrogen2 2.344593
#&gt; 131 wetland    NA V1-C-4    all    all Nitrogen1 2.626977
#&gt; 132 wetland    NA V1-C-4    all    all Nitrogen2 2.626977
#&gt; 133 wetland    NA V1-C-6    all    all Nitrogen1 2.802510
#&gt; 134 wetland    NA V1-C-6    all    all Nitrogen2 2.802510
#&gt; 135 wetland    NA V1-C-7    all    all Nitrogen1 3.072115
#&gt; 136 wetland    NA V1-C-7    all    all Nitrogen2 3.072115
#&gt; 137 wetland    NA V1-C-8    all    all Nitrogen1 3.524687
#&gt; 138 wetland    NA V1-C-8    all    all Nitrogen2 3.524687
#&gt; 139 wetland    NA V2-C-1    all    all Nitrogen1 3.078022
#&gt; 140 wetland    NA V2-C-1    all    all Nitrogen2 3.078022
#&gt; 141 wetland    NA V2-C-2    all    all Nitrogen1 4.096205
#&gt; 142 wetland    NA V2-C-2    all    all Nitrogen2 4.096205
#&gt; 143 wetland    NA V2-C-3    all    all Nitrogen1 4.890875
#&gt; 144 wetland    NA V2-C-3    all    all Nitrogen2 4.890875
#&gt;           Gv maxmin
#&gt; 1   4.650288      1
#&gt; 2   5.242167      7
#&gt; 3   4.412518      1
#&gt; 4   4.983052      7
#&gt; 5   4.181051      1
#&gt; 6   5.575828      7
#&gt; 7   4.265677      1
#&gt; 8   5.728271      7
#&gt; 9   4.026841      1
#&gt; 10  5.326302      7
#&gt; 11  4.331418      1
#&gt; 12  5.131781      7
#&gt; 13  4.379654      1
#&gt; 14  4.977008      7
#&gt; 15  4.676349      1
#&gt; 16  6.777778      7
#&gt; 17  4.735842      1
#&gt; 18  6.835764      7
#&gt; 19  4.684189      1
#&gt; 20  6.753948      7
#&gt; 21  4.644572      1
#&gt; 22  6.487499      7
#&gt; 23  4.552329      1
#&gt; 24  6.494601      7
#&gt; 25  4.219840      1
#&gt; 26  5.423544      7
#&gt; 27  4.166529      1
#&gt; 28  5.433001      7
#&gt; 29  4.206007      1
#&gt; 30  5.758946      7
#&gt; 31  3.657798      1
#&gt; 32  4.953344      7
#&gt; 33  3.446326      1
#&gt; 34  4.940917      7
#&gt; 35  3.242379      1
#&gt; 36  4.738912      7
#&gt; 37  4.730467      1
#&gt; 38  6.287387     12
#&gt; 39  5.024660      1
#&gt; 40  6.515412     12
#&gt; 41  5.959727      1
#&gt; 42  7.929956     12
#&gt; 43  6.072307      1
#&gt; 44  7.598114     12
#&gt; 45  6.041072      1
#&gt; 46  8.132334     12
#&gt; 47  6.519606      1
#&gt; 48  7.905369     12
#&gt; 49  6.665973      1
#&gt; 50  8.189600     12
#&gt; 51  4.473684      1
#&gt; 52  8.467209     12
#&gt; 53  4.805905      1
#&gt; 54  9.142989     12
#&gt; 55  5.703439      1
#&gt; 56  9.337017     12
#&gt; 57  6.503395      1
#&gt; 58  9.445956     12
#&gt; 59  6.530966      1
#&gt; 60  9.294677     12
#&gt; 61  5.518264      1
#&gt; 62  9.248771     12
#&gt; 63  5.869488      1
#&gt; 64  8.685496     12
#&gt; 65  5.712864      1
#&gt; 66  8.097239     12
#&gt; 67  4.851244      1
#&gt; 68  8.797058     12
#&gt; 69  5.141012      1
#&gt; 70  8.285018     12
#&gt; 71  5.556370      1
#&gt; 72  8.218944     12
#&gt; 73  1.655954      1
#&gt; 74  2.814447      8
#&gt; 75  1.858930      1
#&gt; 76  2.983125      8
#&gt; 77  3.022003      1
#&gt; 78  4.769512      8
#&gt; 79  3.495213      1
#&gt; 80  5.344473      8
#&gt; 81  3.322124      1
#&gt; 82  4.879182      8
#&gt; 83  4.279028      1
#&gt; 84  5.202615      8
#&gt; 85  4.502166      1
#&gt; 86  5.280336      8
#&gt; 87  1.082218      1
#&gt; 88  3.292487      8
#&gt; 89  1.304445      1
#&gt; 90  4.000000      8
#&gt; 91  1.623551      1
#&gt; 92  4.376870      8
#&gt; 93  2.307563      1
#&gt; 94  4.848489      8
#&gt; 95  2.929122      1
#&gt; 96  5.959868      8
#&gt; 97  2.201466      1
#&gt; 98  4.330514      8
#&gt; 99  2.663268      1
#&gt; 100 4.365503      8
#&gt; 101 3.267379      1
#&gt; 102 5.369703      8
#&gt; 103 2.388756      1
#&gt; 104 4.133991      8
#&gt; 105 2.926638      1
#&gt; 106 4.478642      8
#&gt; 107 3.325443      1
#&gt; 108 4.837873      8
#&gt; 109 1.798326      1
#&gt; 110 2.488591      9
#&gt; 111 1.707630      1
#&gt; 112 2.676179      9
#&gt; 113 2.638866      1
#&gt; 114 4.191821      9
#&gt; 115 2.841443      1
#&gt; 116 5.207416      9
#&gt; 117 3.634319      1
#&gt; 118 5.308846      9
#&gt; 119 4.680611      1
#&gt; 120 6.103431      9
#&gt; 121 5.067941      1
#&gt; 122 6.270266      9
#&gt; 123 1.006211      1
#&gt; 124 2.200000      9
#&gt; 125 1.049953      1
#&gt; 126 2.539114      9
#&gt; 127 1.202420      1
#&gt; 128 3.136698      9
#&gt; 129 1.360667      1
#&gt; 130 3.836578      9
#&gt; 131 1.712485      1
#&gt; 132 3.948144      9
#&gt; 133 2.067017      1
#&gt; 134 3.660364      9
#&gt; 135 2.368457      1
#&gt; 136 3.880840      9
#&gt; 137 2.553046      1
#&gt; 138 4.784577      9
#&gt; 139 2.482721      1
#&gt; 140 4.157467      9
#&gt; 141 3.222495      1
#&gt; 142 5.004499      9
#&gt; 143 3.954204      1
#&gt; 144 5.899529      9
#&gt;       N1               hoved               grunn   
#&gt;  Length:144         Length:144         V1-C-1 : 8  
#&gt;  Class :character   Class :character   V1-C-2 : 8  
#&gt;  Mode  :character   Mode  :character   V1-C-3 : 8  
#&gt;                                        V1-C-4 : 8  
#&gt;                                        V1-C-5 : 8  
#&gt;                                        V1-C-6 : 8  
#&gt;                                        (Other):96  
#&gt;     county             region                 Ind    
#&gt;  Length:144         Length:144         Light1   :18  
#&gt;  Class :character   Class :character   Light2   :18  
#&gt;  Mode  :character   Mode  :character   Moist1   :18  
#&gt;                                        Moist2   :18  
#&gt;                                        Nitrogen1:18  
#&gt;                                        Nitrogen2:18  
#&gt;                                        (Other)  :36  
#&gt;        Rv              Gv            maxmin     
#&gt;  Min.   :1.545   Min.   :1.006   Min.   : 1.00  
#&gt;  1st Qu.:3.391   1st Qu.:3.315   1st Qu.: 1.00  
#&gt;  Median :4.690   Median :4.682   Median : 4.00  
#&gt;  Mean   :4.646   Mean   :4.718   Mean   : 5.00  
#&gt;  3rd Qu.:5.691   3rd Qu.:5.736   3rd Qu.: 8.25  
#&gt;  Max.   :8.213   Max.   :9.446   Max.   :12.00  
#&gt; </code></pre>
<div class="sourceCode" id="cb195"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">wetland.ref.cov.val</span><span class="op">)</span></span>
<span><span class="co">#&gt;        N1 hoved  grunn county region    Ind       Rv</span></span>
<span><span class="co">#&gt; 1 wetland    NA V3-C-2    all    all Light1 4.966443</span></span>
<span><span class="co">#&gt; 2 wetland    NA V3-C-2    all    all Light2 4.966443</span></span>
<span><span class="co">#&gt; 3 wetland    NA V1-C-5    all    all Light1 4.678375</span></span>
<span><span class="co">#&gt; 4 wetland    NA V1-C-5    all    all Light2 4.678375</span></span>
<span><span class="co">#&gt; 5 wetland    NA V4-C-2    all    all Light1 4.885976</span></span>
<span><span class="co">#&gt; 6 wetland    NA V4-C-2    all    all Light2 4.885976</span></span>
<span><span class="co">#&gt;         Gv maxmin</span></span>
<span><span class="co">#&gt; 1 4.650288      1</span></span>
<span><span class="co">#&gt; 2 5.242167      7</span></span>
<span><span class="co">#&gt; 3 4.412518      1</span></span>
<span><span class="co">#&gt; 4 4.983052      7</span></span>
<span><span class="co">#&gt; 5 4.181051      1</span></span>
<span><span class="co">#&gt; 6 5.575828      7</span></span></code></pre></div>
<p>Once test data (ANO) and the scaling values from the reference data (NiN) are in place, we can calculate CWMs of the selected indicators for the ANO community data and scale them against the scaling values from the reference distribution. Note that we scale each ANO plot’s CWM against either the lower threshold value and the min value OR the upper threshold value and the max value based on whether the CWM is smaller or higher than the reference value. Since the scaled values for both sides range between 0 and 1, we generate separate lower and upper condition indicators for each functional plant indicator. An ANO plot can only have a scaled value in either the lower or the upper indicator (the other one will be ‘NA’), except for the unlikely event that the CWM exactly matches the reference value, in which case both lower and upper indicator will receive a scaled indicator value of 1.</p>
<p>Here is the scaling function</p>
<div class="sourceCode" id="cb196"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#### scaled values ####</span></span>
<span><span class="va">r.s</span> <span class="op">&lt;-</span> <span class="fl">1</span>    <span class="co"># reference value</span></span>
<span><span class="va">l.s</span> <span class="op">&lt;-</span> <span class="fl">0.6</span>  <span class="co"># limit value</span></span>
<span><span class="va">a.s</span> <span class="op">&lt;-</span> <span class="fl">0</span>    <span class="co"># abscence of indicator, or indicator at maximum</span></span>
<span></span>
<span><span class="co">#### function for calculating scaled values for measured value ####</span></span>
<span></span>
<span><span class="co">## scaling function including truncation</span></span>
<span><span class="va">scal</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># place to hold the result</span></span>
<span>   <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">maxmin</span> <span class="op">&lt;</span> <span class="va">ref</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># values &gt;= the reference value equal 1</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">val</span> <span class="op">&gt;=</span> <span class="va">ref</span><span class="op">)</span> <span class="op">{</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">}</span></span>
<span>    <span class="co"># values &lt; the reference value and &gt;= the limit value can be deducted from the linear relationship between these two</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">val</span> <span class="op">&lt;</span> <span class="va">ref</span> <span class="op">&amp;</span> <span class="va">val</span> <span class="op">&gt;=</span> <span class="va">lim</span><span class="op">)</span> <span class="op">{</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">l.s</span> <span class="op">+</span> <span class="op">(</span><span class="va">val</span><span class="op">-</span><span class="va">lim</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span> <span class="op">(</span><span class="va">r.s</span><span class="op">-</span><span class="va">l.s</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">ref</span><span class="op">-</span><span class="va">lim</span><span class="op">)</span> <span class="op">)</span> <span class="op">)</span><span class="op">}</span></span>
<span>    <span class="co"># values &lt; the limit value and &gt; maxmin can be deducted from the linear relationship between these two</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">val</span> <span class="op">&lt;</span> <span class="va">lim</span> <span class="op">&amp;</span> <span class="va">val</span> <span class="op">&gt;</span> <span class="va">maxmin</span><span class="op">)</span> <span class="op">{</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">a.s</span> <span class="op">+</span> <span class="op">(</span><span class="va">val</span><span class="op">-</span><span class="va">maxmin</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span> <span class="op">(</span><span class="va">l.s</span><span class="op">-</span><span class="va">a.s</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">lim</span><span class="op">-</span><span class="va">maxmin</span><span class="op">)</span> <span class="op">)</span> <span class="op">)</span><span class="op">}</span></span>
<span>    <span class="co"># value equals or lower than maxmin</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">val</span> <span class="op">&lt;=</span> <span class="va">maxmin</span><span class="op">)</span> <span class="op">{</span><span class="va">x</span> <span class="op">&lt;-</span><span class="fl">0</span><span class="op">}</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="co"># values &lt;= the reference value equal 1</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">val</span> <span class="op">&lt;=</span> <span class="va">ref</span><span class="op">)</span> <span class="op">{</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">}</span></span>
<span>    <span class="co"># values &gt; the reference value and &lt;= the limit value can be deducted from the linear relationship between these two</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">val</span> <span class="op">&gt;</span> <span class="va">ref</span> <span class="op">&amp;</span> <span class="va">val</span> <span class="op">&lt;=</span> <span class="va">lim</span><span class="op">)</span> <span class="op">{</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="op">(</span> <span class="va">r.s</span> <span class="op">-</span> <span class="op">(</span> <span class="op">(</span><span class="va">r.s</span> <span class="op">-</span> <span class="va">l.s</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">val</span> <span class="op">-</span> <span class="va">ref</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">lim</span> <span class="op">-</span> <span class="va">ref</span><span class="op">)</span> <span class="op">)</span> <span class="op">)</span><span class="op">}</span></span>
<span>    <span class="co"># values &gt; the limit value and &lt; maxmin can be deducted from the linear relationship between these two</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">val</span> <span class="op">&gt;</span> <span class="va">lim</span><span class="op">)</span> <span class="op">{</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="op">(</span> <span class="va">l.s</span> <span class="op">-</span> <span class="op">(</span><span class="va">l.s</span> <span class="op">*</span> <span class="op">(</span><span class="va">val</span> <span class="op">-</span> <span class="va">lim</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">maxmin</span> <span class="op">-</span> <span class="va">lim</span><span class="op">)</span> <span class="op">)</span> <span class="op">)</span><span class="op">}</span></span>
<span>    <span class="co"># value equals or larger than maxmin</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">val</span> <span class="op">&gt;=</span> <span class="va">maxmin</span><span class="op">)</span> <span class="op">{</span><span class="va">x</span> <span class="op">&lt;-</span><span class="fl">0</span><span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
<p>We then can prepare a list of data frames to hold the results and perform the scaling according to the principles described in NINA report 1967 (Töpper and Jakobsson 2021)</p>
<div class="sourceCode" id="cb197"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#### calculating scaled and non-truncated values for the indicators based on the dataset ####</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">ANO.wetland</span><span class="op">)</span> <span class="op">)</span> <span class="op">{</span>  <span class="co">#</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">ANO.wetland</span><span class="op">$</span><span class="va">ano_flate_id</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">ANO.wetland</span><span class="op">$</span><span class="va">ano_punkt_id</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#    ANO.wetland$Hovedoekosystem_sirkel[i]</span></span>
<span><span class="co">#    ANO.wetland$Hovedoekosystem_rute[i]</span></span>
<span></span>
<span>    <span class="co"># if the ANO.hovedtype exists in the reference</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">ANO.wetland</span><span class="op">$</span><span class="va">hovedtype_rute</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">grunn</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">{</span></span>
<span>      </span>
<span>      <span class="co"># if there is any species present in current ANO point  </span></span>
<span>      <span class="kw">if</span> <span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ANO.sp.ind</span><span class="op">[</span><span class="va">ANO.sp.ind</span><span class="op">$</span><span class="va">ParentGlobalID</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">ANO.wetland</span><span class="op">$</span><span class="va">GlobalID</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,<span class="st">'Species'</span><span class="op">]</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">)</span> <span class="op">{</span></span>
<span>        </span>
<span></span>
<span>          </span>
<span>          <span class="co"># Light</span></span>
<span>          <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">ANO.sp.ind</span><span class="op">[</span><span class="va">ANO.sp.ind</span><span class="op">$</span><span class="va">ParentGlobalID</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">ANO.wetland</span><span class="op">$</span><span class="va">GlobalID</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'art_dekning'</span>,<span class="st">'Light'</span><span class="op">)</span><span class="op">]</span></span>
<span>          <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">'richness'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span>          <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">Light</span><span class="op">)</span>,<span class="op">]</span></span>
<span>          </span>
<span>          <span class="kw">if</span> <span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span> <span class="op">)</span> <span class="op">{</span></span>
<span>            </span>
<span>            <span class="va">val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>,<span class="st">'art_dekning'</span><span class="op">]</span> <span class="op">*</span> <span class="va">dat</span><span class="op">[</span>,<span class="st">'Light'</span><span class="op">]</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>,<span class="st">'art_dekning'</span><span class="op">]</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span>            <span class="co"># lower part of distribution</span></span>
<span>            <span class="va">ref</span> <span class="op">&lt;-</span> <span class="va">wetland.ref.cov.val</span><span class="op">[</span><span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">Ind</span><span class="op">==</span><span class="st">'Light1'</span> <span class="op">&amp;</span> <span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">grunn</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">"kartleggingsenhet_1m2"</span><span class="op">]</span><span class="op">)</span>,<span class="st">'Rv'</span><span class="op">]</span></span>
<span>            <span class="va">lim</span> <span class="op">&lt;-</span> <span class="va">wetland.ref.cov.val</span><span class="op">[</span><span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">Ind</span><span class="op">==</span><span class="st">'Light1'</span> <span class="op">&amp;</span> <span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">grunn</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">"kartleggingsenhet_1m2"</span><span class="op">]</span><span class="op">)</span>,<span class="st">'Gv'</span><span class="op">]</span></span>
<span>            <span class="va">maxmin</span> <span class="op">&lt;-</span> <span class="va">wetland.ref.cov.val</span><span class="op">[</span><span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">Ind</span><span class="op">==</span><span class="st">'Light1'</span> <span class="op">&amp;</span> <span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">grunn</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">"kartleggingsenhet_1m2"</span><span class="op">]</span><span class="op">)</span>,<span class="st">'maxmin'</span><span class="op">]</span></span>
<span>            <span class="co"># coercing x into results.wetland dataframe</span></span>
<span>            <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'scaled'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">'Light1'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">scal</span><span class="op">(</span><span class="op">)</span> </span>
<span>            <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'non-truncated'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">'Light1'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">scal.2</span><span class="op">(</span><span class="op">)</span> </span>
<span>            <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">'Light1'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">val</span> </span>
<span>            </span>
<span>            <span class="co"># upper part of distribution</span></span>
<span>            <span class="va">ref</span> <span class="op">&lt;-</span> <span class="va">wetland.ref.cov.val</span><span class="op">[</span><span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">Ind</span><span class="op">==</span><span class="st">'Light2'</span> <span class="op">&amp;</span> <span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">grunn</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">"kartleggingsenhet_1m2"</span><span class="op">]</span><span class="op">)</span>,<span class="st">'Rv'</span><span class="op">]</span></span>
<span>            <span class="va">lim</span> <span class="op">&lt;-</span> <span class="va">wetland.ref.cov.val</span><span class="op">[</span><span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">Ind</span><span class="op">==</span><span class="st">'Light2'</span> <span class="op">&amp;</span> <span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">grunn</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">"kartleggingsenhet_1m2"</span><span class="op">]</span><span class="op">)</span>,<span class="st">'Gv'</span><span class="op">]</span></span>
<span>            <span class="va">maxmin</span> <span class="op">&lt;-</span> <span class="va">wetland.ref.cov.val</span><span class="op">[</span><span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">Ind</span><span class="op">==</span><span class="st">'Light2'</span> <span class="op">&amp;</span> <span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">grunn</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">"kartleggingsenhet_1m2"</span><span class="op">]</span><span class="op">)</span>,<span class="st">'maxmin'</span><span class="op">]</span></span>
<span>            <span class="co"># coercing x into results.wetland dataframe</span></span>
<span>            <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'scaled'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">'Light2'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">scal</span><span class="op">(</span><span class="op">)</span> </span>
<span>            <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'non-truncated'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">'Light2'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">scal.2</span><span class="op">(</span><span class="op">)</span> </span>
<span>            <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">'Light2'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">val</span></span>
<span>          <span class="op">}</span></span>
<span>          </span>
<span>          </span>
<span>          <span class="co"># Moisture</span></span>
<span>          <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">ANO.sp.ind</span><span class="op">[</span><span class="va">ANO.sp.ind</span><span class="op">$</span><span class="va">ParentGlobalID</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">ANO.wetland</span><span class="op">$</span><span class="va">GlobalID</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'art_dekning'</span>,<span class="st">'Moisture'</span><span class="op">)</span><span class="op">]</span></span>
<span>          <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">'richness'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span>          <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">Moisture</span><span class="op">)</span>,<span class="op">]</span></span>
<span>          </span>
<span>          <span class="kw">if</span> <span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span> <span class="op">)</span> <span class="op">{</span></span>
<span>            </span>
<span>            <span class="va">val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>,<span class="st">'art_dekning'</span><span class="op">]</span> <span class="op">*</span> <span class="va">dat</span><span class="op">[</span>,<span class="st">'Moisture'</span><span class="op">]</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>,<span class="st">'art_dekning'</span><span class="op">]</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span>            <span class="co"># lower part of distribution</span></span>
<span>            <span class="va">ref</span> <span class="op">&lt;-</span> <span class="va">wetland.ref.cov.val</span><span class="op">[</span><span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">Ind</span><span class="op">==</span><span class="st">'Moist1'</span> <span class="op">&amp;</span> <span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">grunn</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">"kartleggingsenhet_1m2"</span><span class="op">]</span><span class="op">)</span>,<span class="st">'Rv'</span><span class="op">]</span></span>
<span>            <span class="va">lim</span> <span class="op">&lt;-</span> <span class="va">wetland.ref.cov.val</span><span class="op">[</span><span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">Ind</span><span class="op">==</span><span class="st">'Moist1'</span> <span class="op">&amp;</span> <span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">grunn</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">"kartleggingsenhet_1m2"</span><span class="op">]</span><span class="op">)</span>,<span class="st">'Gv'</span><span class="op">]</span></span>
<span>            <span class="va">maxmin</span> <span class="op">&lt;-</span> <span class="va">wetland.ref.cov.val</span><span class="op">[</span><span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">Ind</span><span class="op">==</span><span class="st">'Moist1'</span> <span class="op">&amp;</span> <span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">grunn</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">"kartleggingsenhet_1m2"</span><span class="op">]</span><span class="op">)</span>,<span class="st">'maxmin'</span><span class="op">]</span></span>
<span>            <span class="co"># coercing x into results.wetland dataframe</span></span>
<span>            <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'scaled'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">'Moist1'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">scal</span><span class="op">(</span><span class="op">)</span> </span>
<span>            <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'non-truncated'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">'Moist1'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">scal.2</span><span class="op">(</span><span class="op">)</span> </span>
<span>            <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">'Moist1'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">val</span> </span>
<span>            </span>
<span>            <span class="co"># upper part of distribution</span></span>
<span>            <span class="va">ref</span> <span class="op">&lt;-</span> <span class="va">wetland.ref.cov.val</span><span class="op">[</span><span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">Ind</span><span class="op">==</span><span class="st">'Moist2'</span> <span class="op">&amp;</span> <span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">grunn</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">"kartleggingsenhet_1m2"</span><span class="op">]</span><span class="op">)</span>,<span class="st">'Rv'</span><span class="op">]</span></span>
<span>            <span class="va">lim</span> <span class="op">&lt;-</span> <span class="va">wetland.ref.cov.val</span><span class="op">[</span><span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">Ind</span><span class="op">==</span><span class="st">'Moist2'</span> <span class="op">&amp;</span> <span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">grunn</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">"kartleggingsenhet_1m2"</span><span class="op">]</span><span class="op">)</span>,<span class="st">'Gv'</span><span class="op">]</span></span>
<span>            <span class="va">maxmin</span> <span class="op">&lt;-</span> <span class="va">wetland.ref.cov.val</span><span class="op">[</span><span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">Ind</span><span class="op">==</span><span class="st">'Moist2'</span> <span class="op">&amp;</span> <span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">grunn</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">"kartleggingsenhet_1m2"</span><span class="op">]</span><span class="op">)</span>,<span class="st">'maxmin'</span><span class="op">]</span></span>
<span>            <span class="co"># coercing x into results.wetland dataframe</span></span>
<span>            <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'scaled'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">'Moist2'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">scal</span><span class="op">(</span><span class="op">)</span> </span>
<span>            <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'non-truncated'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">'Moist2'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">scal.2</span><span class="op">(</span><span class="op">)</span> </span>
<span>            <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">'Moist2'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">val</span></span>
<span>          <span class="op">}</span></span>
<span>          </span>
<span>          </span>
<span>          <span class="co"># Soil_reaction_pH</span></span>
<span>          <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">ANO.sp.ind</span><span class="op">[</span><span class="va">ANO.sp.ind</span><span class="op">$</span><span class="va">ParentGlobalID</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">ANO.wetland</span><span class="op">$</span><span class="va">GlobalID</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'art_dekning'</span>,<span class="st">'Soil_reaction_pH'</span><span class="op">)</span><span class="op">]</span></span>
<span>          <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">'richness'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span>          <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">Soil_reaction_pH</span><span class="op">)</span>,<span class="op">]</span></span>
<span>          </span>
<span>          <span class="kw">if</span> <span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span> <span class="op">)</span> <span class="op">{</span></span>
<span>            </span>
<span>            <span class="va">val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>,<span class="st">'art_dekning'</span><span class="op">]</span> <span class="op">*</span> <span class="va">dat</span><span class="op">[</span>,<span class="st">'Soil_reaction_pH'</span><span class="op">]</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>,<span class="st">'art_dekning'</span><span class="op">]</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span>            <span class="co"># lower part of distribution</span></span>
<span>            <span class="va">ref</span> <span class="op">&lt;-</span> <span class="va">wetland.ref.cov.val</span><span class="op">[</span><span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">Ind</span><span class="op">==</span><span class="st">'pH1'</span> <span class="op">&amp;</span> <span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">grunn</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">"kartleggingsenhet_1m2"</span><span class="op">]</span><span class="op">)</span>,<span class="st">'Rv'</span><span class="op">]</span></span>
<span>            <span class="va">lim</span> <span class="op">&lt;-</span> <span class="va">wetland.ref.cov.val</span><span class="op">[</span><span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">Ind</span><span class="op">==</span><span class="st">'pH1'</span> <span class="op">&amp;</span> <span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">grunn</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">"kartleggingsenhet_1m2"</span><span class="op">]</span><span class="op">)</span>,<span class="st">'Gv'</span><span class="op">]</span></span>
<span>            <span class="va">maxmin</span> <span class="op">&lt;-</span> <span class="va">wetland.ref.cov.val</span><span class="op">[</span><span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">Ind</span><span class="op">==</span><span class="st">'pH1'</span> <span class="op">&amp;</span> <span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">grunn</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">"kartleggingsenhet_1m2"</span><span class="op">]</span><span class="op">)</span>,<span class="st">'maxmin'</span><span class="op">]</span></span>
<span>            <span class="co"># coercing x into results.wetland dataframe</span></span>
<span>            <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'scaled'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">'pH1'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">scal</span><span class="op">(</span><span class="op">)</span> </span>
<span>            <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'non-truncated'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">'pH1'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">scal.2</span><span class="op">(</span><span class="op">)</span> </span>
<span>            <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">'pH1'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">val</span> </span>
<span>            </span>
<span>            <span class="co"># upper part of distribution</span></span>
<span>            <span class="va">ref</span> <span class="op">&lt;-</span> <span class="va">wetland.ref.cov.val</span><span class="op">[</span><span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">Ind</span><span class="op">==</span><span class="st">'pH2'</span> <span class="op">&amp;</span> <span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">grunn</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">"kartleggingsenhet_1m2"</span><span class="op">]</span><span class="op">)</span>,<span class="st">'Rv'</span><span class="op">]</span></span>
<span>            <span class="va">lim</span> <span class="op">&lt;-</span> <span class="va">wetland.ref.cov.val</span><span class="op">[</span><span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">Ind</span><span class="op">==</span><span class="st">'pH2'</span> <span class="op">&amp;</span> <span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">grunn</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">"kartleggingsenhet_1m2"</span><span class="op">]</span><span class="op">)</span>,<span class="st">'Gv'</span><span class="op">]</span></span>
<span>            <span class="va">maxmin</span> <span class="op">&lt;-</span> <span class="va">wetland.ref.cov.val</span><span class="op">[</span><span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">Ind</span><span class="op">==</span><span class="st">'pH2'</span> <span class="op">&amp;</span> <span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">grunn</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">"kartleggingsenhet_1m2"</span><span class="op">]</span><span class="op">)</span>,<span class="st">'maxmin'</span><span class="op">]</span></span>
<span>            <span class="co"># coercing x into results.wetland dataframe</span></span>
<span>            <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'scaled'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">'pH2'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">scal</span><span class="op">(</span><span class="op">)</span> </span>
<span>            <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'non-truncated'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">'pH2'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">scal.2</span><span class="op">(</span><span class="op">)</span> </span>
<span>            <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">'pH2'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">val</span></span>
<span>          <span class="op">}</span></span>
<span>          </span>
<span>          </span>
<span>          <span class="co"># Nitrogen</span></span>
<span>          <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">ANO.sp.ind</span><span class="op">[</span><span class="va">ANO.sp.ind</span><span class="op">$</span><span class="va">ParentGlobalID</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">ANO.wetland</span><span class="op">$</span><span class="va">GlobalID</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'art_dekning'</span>,<span class="st">'Nitrogen'</span><span class="op">)</span><span class="op">]</span></span>
<span>          <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">'richness'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span>          <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">Nitrogen</span><span class="op">)</span>,<span class="op">]</span></span>
<span>          </span>
<span>          <span class="kw">if</span> <span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span> <span class="op">)</span> <span class="op">{</span></span>
<span>            </span>
<span>            <span class="va">val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>,<span class="st">'art_dekning'</span><span class="op">]</span> <span class="op">*</span> <span class="va">dat</span><span class="op">[</span>,<span class="st">'Nitrogen'</span><span class="op">]</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>,<span class="st">'art_dekning'</span><span class="op">]</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span>            <span class="co"># lower part of distribution</span></span>
<span>            <span class="va">ref</span> <span class="op">&lt;-</span> <span class="va">wetland.ref.cov.val</span><span class="op">[</span><span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">Ind</span><span class="op">==</span><span class="st">'Nitrogen1'</span> <span class="op">&amp;</span> <span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">grunn</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">"kartleggingsenhet_1m2"</span><span class="op">]</span><span class="op">)</span>,<span class="st">'Rv'</span><span class="op">]</span></span>
<span>            <span class="va">lim</span> <span class="op">&lt;-</span> <span class="va">wetland.ref.cov.val</span><span class="op">[</span><span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">Ind</span><span class="op">==</span><span class="st">'Nitrogen1'</span> <span class="op">&amp;</span> <span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">grunn</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">"kartleggingsenhet_1m2"</span><span class="op">]</span><span class="op">)</span>,<span class="st">'Gv'</span><span class="op">]</span></span>
<span>            <span class="va">maxmin</span> <span class="op">&lt;-</span> <span class="va">wetland.ref.cov.val</span><span class="op">[</span><span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">Ind</span><span class="op">==</span><span class="st">'Nitrogen1'</span> <span class="op">&amp;</span> <span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">grunn</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">"kartleggingsenhet_1m2"</span><span class="op">]</span><span class="op">)</span>,<span class="st">'maxmin'</span><span class="op">]</span></span>
<span>            <span class="co"># coercing x into results.wetland dataframe</span></span>
<span>            <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'scaled'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">'Nitrogen1'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">scal</span><span class="op">(</span><span class="op">)</span> </span>
<span>            <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'non-truncated'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">'Nitrogen1'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">scal.2</span><span class="op">(</span><span class="op">)</span> </span>
<span>            <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">'Nitrogen1'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">val</span> </span>
<span>            </span>
<span>            <span class="co"># upper part of distribution</span></span>
<span>            <span class="va">ref</span> <span class="op">&lt;-</span> <span class="va">wetland.ref.cov.val</span><span class="op">[</span><span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">Ind</span><span class="op">==</span><span class="st">'Nitrogen2'</span> <span class="op">&amp;</span> <span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">grunn</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">"kartleggingsenhet_1m2"</span><span class="op">]</span><span class="op">)</span>,<span class="st">'Rv'</span><span class="op">]</span></span>
<span>            <span class="va">lim</span> <span class="op">&lt;-</span> <span class="va">wetland.ref.cov.val</span><span class="op">[</span><span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">Ind</span><span class="op">==</span><span class="st">'Nitrogen2'</span> <span class="op">&amp;</span> <span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">grunn</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">"kartleggingsenhet_1m2"</span><span class="op">]</span><span class="op">)</span>,<span class="st">'Gv'</span><span class="op">]</span></span>
<span>            <span class="va">maxmin</span> <span class="op">&lt;-</span> <span class="va">wetland.ref.cov.val</span><span class="op">[</span><span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">Ind</span><span class="op">==</span><span class="st">'Nitrogen2'</span> <span class="op">&amp;</span> <span class="va">wetland.ref.cov.val</span><span class="op">$</span><span class="va">grunn</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">"kartleggingsenhet_1m2"</span><span class="op">]</span><span class="op">)</span>,<span class="st">'maxmin'</span><span class="op">]</span></span>
<span>            <span class="co"># coercing x into results.wetland dataframe</span></span>
<span>            <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'scaled'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">'Nitrogen2'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">scal</span><span class="op">(</span><span class="op">)</span> </span>
<span>            <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'non-truncated'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">'Nitrogen2'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">scal.2</span><span class="op">(</span><span class="op">)</span> </span>
<span>            <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span>,<span class="st">'Nitrogen2'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">val</span></span>
<span>          <span class="op">}</span></span>
<span>          </span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">}</span></span>
<span>      </span>
<span></span>
<span>    </span>
<span>  <span class="op">}</span>, error<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"ERROR :"</span>,<span class="fu"><a href="https://rdrr.io/r/base/conditions.html">conditionMessage</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># for using both sides of the plant indicators</span></span>
<span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'2-sided'</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'non-truncated'</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># remove values &gt;1 for 2-sided indicators</span></span>
<span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'2-sided'</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Light1</span><span class="op">[</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'2-sided'</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Light1</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'2-sided'</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Light2</span><span class="op">[</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'2-sided'</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Light2</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'2-sided'</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Moist1</span><span class="op">[</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'2-sided'</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Moist1</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'2-sided'</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Moist2</span><span class="op">[</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'2-sided'</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Moist2</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'2-sided'</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">pH1</span><span class="op">[</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'2-sided'</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">pH1</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'2-sided'</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">pH2</span><span class="op">[</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'2-sided'</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">pH2</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'2-sided'</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Nitrogen1</span><span class="op">[</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'2-sided'</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Nitrogen1</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'2-sided'</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Nitrogen2</span><span class="op">[</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'2-sided'</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Nitrogen2</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></code></pre></div>
<div class="sourceCode" id="cb198"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">results.wetland</span><span class="op">[[</span><span class="st">'2-sided'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                 GlobalID</span></span>
<span><span class="co">#&gt; 1 {36BAE83E-F412-4C90-8B56-DE6B4225BB17}</span></span>
<span><span class="co">#&gt; 2 {662B047A-411B-42F1-8F2F-E24602CBF350}</span></span>
<span><span class="co">#&gt; 3 {F003E630-94CD-4FFF-839B-772299BF697A}</span></span>
<span><span class="co">#&gt; 4 {F8239C33-99BD-4EEE-85A9-04A10772858D}</span></span>
<span><span class="co">#&gt; 5 {95E184F4-9560-4ADC-A7A9-75AD9A97D654}</span></span>
<span><span class="co">#&gt; 6 {6C11D423-9559-4C61-9036-C1309E0C6328}</span></span>
<span><span class="co">#&gt;      registeringsdato klokkeslett_start ano_flate_id</span></span>
<span><span class="co">#&gt; 1 2019-08-16 11:59:59             13:19      ANO0003</span></span>
<span><span class="co">#&gt; 2 2019-08-16 11:59:59             15:38      ANO0003</span></span>
<span><span class="co">#&gt; 3 2019-08-16 11:59:59             15:07      ANO0003</span></span>
<span><span class="co">#&gt; 4 2019-08-16 11:59:59             13:58      ANO0003</span></span>
<span><span class="co">#&gt; 5 2019-08-16 11:59:59             12:06      ANO0003</span></span>
<span><span class="co">#&gt; 6 2019-08-15 11:59:59             15:43      ANO0003</span></span>
<span><span class="co">#&gt;   ano_punkt_id         ssb_id program</span></span>
<span><span class="co">#&gt; 1   ANO0003_35 20940006559500     ANO</span></span>
<span><span class="co">#&gt; 2   ANO0003_44 20940006559500     ANO</span></span>
<span><span class="co">#&gt; 3   ANO0003_64 20940006559500     ANO</span></span>
<span><span class="co">#&gt; 4   ANO0003_55 20940006559500     ANO</span></span>
<span><span class="co">#&gt; 5   ANO0003_15 20940006559500     ANO</span></span>
<span><span class="co">#&gt; 6   ANO0003_51 20940006559500     ANO</span></span>
<span><span class="co">#&gt;                                                                   instruks</span></span>
<span><span class="co">#&gt; 1 https://nedlasting.miljodirektoratet.no/naturovervaking/ano_instruks.pdf</span></span>
<span><span class="co">#&gt; 2 https://nedlasting.miljodirektoratet.no/naturovervaking/ano_instruks.pdf</span></span>
<span><span class="co">#&gt; 3 https://nedlasting.miljodirektoratet.no/naturovervaking/ano_instruks.pdf</span></span>
<span><span class="co">#&gt; 4 https://nedlasting.miljodirektoratet.no/naturovervaking/ano_instruks.pdf</span></span>
<span><span class="co">#&gt; 5 https://nedlasting.miljodirektoratet.no/naturovervaking/ano_instruks.pdf</span></span>
<span><span class="co">#&gt; 6 https://nedlasting.miljodirektoratet.no/naturovervaking/ano_instruks.pdf</span></span>
<span><span class="co">#&gt;    aar      dataansvarlig_mdir                   dataeier</span></span>
<span><span class="co">#&gt; 1 2019 Ole Einar Butli Hårstad Miljødirektoratet, VAL/VMK</span></span>
<span><span class="co">#&gt; 2 2019 Ole Einar Butli Hårstad Miljødirektoratet, VAL/VMK</span></span>
<span><span class="co">#&gt; 3 2019 Ole Einar Butli Hårstad Miljødirektoratet, VAL/VMK</span></span>
<span><span class="co">#&gt; 4 2019 Ole Einar Butli Hårstad Miljødirektoratet, VAL/VMK</span></span>
<span><span class="co">#&gt; 5 2019 Ole Einar Butli Hårstad Miljødirektoratet, VAL/VMK</span></span>
<span><span class="co">#&gt; 6 2019 Ole Einar Butli Hårstad Miljødirektoratet, VAL/VMK</span></span>
<span><span class="co">#&gt;        vaer hovedoekosystem_punkt</span></span>
<span><span class="co">#&gt; 1 overskyet              vaatmark</span></span>
<span><span class="co">#&gt; 2       sol              vaatmark</span></span>
<span><span class="co">#&gt; 3       sol              vaatmark</span></span>
<span><span class="co">#&gt; 4       sol              vaatmark</span></span>
<span><span class="co">#&gt; 5       sol              vaatmark</span></span>
<span><span class="co">#&gt; 6    nedbør              vaatmark</span></span>
<span><span class="co">#&gt;   andel_hovedoekosystem_punkt utilgjengelig_punkt</span></span>
<span><span class="co">#&gt; 1                          NA                &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2                          NA                &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3                          NA                &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4                          NA                &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5                          NA                &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6                          NA                &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   utilgjengelig_begrunnelse  gps noeyaktighet</span></span>
<span><span class="co">#&gt; 1                      &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2                      &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3                      &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4                      &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5                      &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6                      &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   kommentar_posisjon klokkeslett_karplanter_start</span></span>
<span><span class="co">#&gt; 1               &lt;NA&gt;                         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2               &lt;NA&gt;                         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3               &lt;NA&gt;                         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4               &lt;NA&gt;                         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5               &lt;NA&gt;                         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6               &lt;NA&gt;                         &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   art_alle_registrert karplanter_dekning</span></span>
<span><span class="co">#&gt; 1                &lt;NA&gt;               85.1</span></span>
<span><span class="co">#&gt; 2                &lt;NA&gt;               81.0</span></span>
<span><span class="co">#&gt; 3                &lt;NA&gt;               79.0</span></span>
<span><span class="co">#&gt; 4                &lt;NA&gt;               51.1</span></span>
<span><span class="co">#&gt; 5                &lt;NA&gt;               71.0</span></span>
<span><span class="co">#&gt; 6                &lt;NA&gt;               11.3</span></span>
<span><span class="co">#&gt;   klokkeslett_karplanter_slutt karplanter_feltsjikt</span></span>
<span><span class="co">#&gt; 1                         &lt;NA&gt;                   NA</span></span>
<span><span class="co">#&gt; 2                         &lt;NA&gt;                   NA</span></span>
<span><span class="co">#&gt; 3                         &lt;NA&gt;                   NA</span></span>
<span><span class="co">#&gt; 4                         &lt;NA&gt;                   NA</span></span>
<span><span class="co">#&gt; 5                         &lt;NA&gt;                   NA</span></span>
<span><span class="co">#&gt; 6                         &lt;NA&gt;                   NA</span></span>
<span><span class="co">#&gt;   moser_dekning torvmoser_dekning lav_dekning stroe_dekning</span></span>
<span><span class="co">#&gt; 1            20                20           0            60</span></span>
<span><span class="co">#&gt; 2             5                 0           0            45</span></span>
<span><span class="co">#&gt; 3            85                75           0            15</span></span>
<span><span class="co">#&gt; 4            80                60           0            75</span></span>
<span><span class="co">#&gt; 5            80                80           0            23</span></span>
<span><span class="co">#&gt; 6            85                85           0             1</span></span>
<span><span class="co">#&gt;   jord_grus_stein_berg_dekning stubber_kvister_dekning</span></span>
<span><span class="co">#&gt; 1                           NA                      NA</span></span>
<span><span class="co">#&gt; 2                           NA                      NA</span></span>
<span><span class="co">#&gt; 3                           NA                      NA</span></span>
<span><span class="co">#&gt; 4                           NA                      NA</span></span>
<span><span class="co">#&gt; 5                           NA                      NA</span></span>
<span><span class="co">#&gt; 6                           NA                      NA</span></span>
<span><span class="co">#&gt;   alger_fjell_dekning</span></span>
<span><span class="co">#&gt; 1                  NA</span></span>
<span><span class="co">#&gt; 2                  NA</span></span>
<span><span class="co">#&gt; 3                  NA</span></span>
<span><span class="co">#&gt; 4                  NA</span></span>
<span><span class="co">#&gt; 5                  NA</span></span>
<span><span class="co">#&gt; 6                  NA</span></span>
<span><span class="co">#&gt;                                 kommentar_ruteanalyse</span></span>
<span><span class="co">#&gt; 1                                                &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2                                                &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3                                                &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4 har noen arter som er i V1C2 men bare veldig lokalt</span></span>
<span><span class="co">#&gt; 5                                                &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6                                                &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   fastmerker kommentar_fastmerker kartleggingsenhet_1m2</span></span>
<span><span class="co">#&gt; 1       &lt;NA&gt;                 &lt;NA&gt;                V1-C-5</span></span>
<span><span class="co">#&gt; 2       &lt;NA&gt;                 &lt;NA&gt;                V1-C-1</span></span>
<span><span class="co">#&gt; 3       &lt;NA&gt;                 &lt;NA&gt;                V1-C-1</span></span>
<span><span class="co">#&gt; 4       &lt;NA&gt;                 &lt;NA&gt;                V1-C-1</span></span>
<span><span class="co">#&gt; 5       &lt;NA&gt;                 &lt;NA&gt;                V1-C-1</span></span>
<span><span class="co">#&gt; 6       &lt;NA&gt;                 &lt;NA&gt;                V1-C-1</span></span>
<span><span class="co">#&gt;       hovedtype_1m2                      ke_beskrivelse_1m2</span></span>
<span><span class="co">#&gt; 1 Åpen jordvannsmyr svært og temmelig kalkfattige myrkanter</span></span>
<span><span class="co">#&gt; 2 Åpen jordvannsmyr svært og temmelig kalkfattige myrflater</span></span>
<span><span class="co">#&gt; 3 Åpen jordvannsmyr svært og temmelig kalkfattige myrflater</span></span>
<span><span class="co">#&gt; 4 Åpen jordvannsmyr svært og temmelig kalkfattige myrflater</span></span>
<span><span class="co">#&gt; 5 Åpen jordvannsmyr svært og temmelig kalkfattige myrflater</span></span>
<span><span class="co">#&gt; 6 Åpen jordvannsmyr svært og temmelig kalkfattige myrflater</span></span>
<span><span class="co">#&gt;   kartleggingsenhet_250m2 hovedtype_250m2</span></span>
<span><span class="co">#&gt; 1                    &lt;NA&gt;            &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2                    &lt;NA&gt;            &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3                    &lt;NA&gt;            &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4                    &lt;NA&gt;            &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5                    &lt;NA&gt;            &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6                    &lt;NA&gt;            &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   ke_beskrivelse_250m2 andel_kartleggingsenhet_250m2</span></span>
<span><span class="co">#&gt; 1                 &lt;NA&gt;                            NA</span></span>
<span><span class="co">#&gt; 2                 &lt;NA&gt;                            NA</span></span>
<span><span class="co">#&gt; 3                 &lt;NA&gt;                            NA</span></span>
<span><span class="co">#&gt; 4                 &lt;NA&gt;                            NA</span></span>
<span><span class="co">#&gt; 5                 &lt;NA&gt;                            NA</span></span>
<span><span class="co">#&gt; 6                 &lt;NA&gt;                            NA</span></span>
<span><span class="co">#&gt;   groeftingsintensitet bruksintensitet beitetrykk</span></span>
<span><span class="co">#&gt; 1                    1               1         NA</span></span>
<span><span class="co">#&gt; 2                    1               1         NA</span></span>
<span><span class="co">#&gt; 3                    1               1         NA</span></span>
<span><span class="co">#&gt; 4                    1               1         NA</span></span>
<span><span class="co">#&gt; 5                    1               1         NA</span></span>
<span><span class="co">#&gt; 6                    1               1         NA</span></span>
<span><span class="co">#&gt;   slatteintensitet tungekjoretoy slitasje forekomst_ntyp</span></span>
<span><span class="co">#&gt; 1                1             0        0            nei</span></span>
<span><span class="co">#&gt; 2                1             0        0            nei</span></span>
<span><span class="co">#&gt; 3                1             0        0            nei</span></span>
<span><span class="co">#&gt; 4                1             0        0            nei</span></span>
<span><span class="co">#&gt; 5                1             0        0            nei</span></span>
<span><span class="co">#&gt; 6                1             0        0            nei</span></span>
<span><span class="co">#&gt;   ntyp</span></span>
<span><span class="co">#&gt; 1 &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2 &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3 &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4 &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5 &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;                                                    kommentar_naturtyperegistering</span></span>
<span><span class="co">#&gt; 1                         en del gjengroing med bjørk og einer, noen store furuer</span></span>
<span><span class="co">#&gt; 2                                                                            &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3                        40% bærlyngskog T4C5, rute i overgang mellom myr og skog</span></span>
<span><span class="co">#&gt; 4                                                   noen store furuer, litt bjørk</span></span>
<span><span class="co">#&gt; 5 delvis myr, ganske mye lyng, virker som det gror igjen med bjørk, einer og furu</span></span>
<span><span class="co">#&gt; 6                                             rute ligger i en streng i fattigmyr</span></span>
<span><span class="co">#&gt;   side_5_note krypende_vier_dekning</span></span>
<span><span class="co">#&gt; 1        &lt;NA&gt;                     0</span></span>
<span><span class="co">#&gt; 2        &lt;NA&gt;                     0</span></span>
<span><span class="co">#&gt; 3        &lt;NA&gt;                     0</span></span>
<span><span class="co">#&gt; 4        &lt;NA&gt;                     0</span></span>
<span><span class="co">#&gt; 5        &lt;NA&gt;                     0</span></span>
<span><span class="co">#&gt; 6        &lt;NA&gt;                     0</span></span>
<span><span class="co">#&gt;   ikke_krypende_vier_dekning vedplanter_total_dekning</span></span>
<span><span class="co">#&gt; 1                          1                       30</span></span>
<span><span class="co">#&gt; 2                          0                        7</span></span>
<span><span class="co">#&gt; 3                          0                       45</span></span>
<span><span class="co">#&gt; 4                          3                       17</span></span>
<span><span class="co">#&gt; 5                          0                       53</span></span>
<span><span class="co">#&gt; 6                          0                        5</span></span>
<span><span class="co">#&gt;   busker_dekning tresjikt_dekning treslag_registrert</span></span>
<span><span class="co">#&gt; 1             12               15               &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2              1                3               &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3             12                8               &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4              8               12               &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5             13                8               &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6              2                0               &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   roesslyng_dekning roesslyngblad pa_dekning pa_note</span></span>
<span><span class="co">#&gt; 1                NA          &lt;NA&gt;         NA    &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2                NA          &lt;NA&gt;         NA    &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3                NA          &lt;NA&gt;         NA    &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4                NA          &lt;NA&gt;         NA    &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5                NA          &lt;NA&gt;         NA    &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6                NA          &lt;NA&gt;         NA    &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   pa_registrert fa_total_dekning fa_registrert</span></span>
<span><span class="co">#&gt; 1          &lt;NA&gt;                0          &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2          &lt;NA&gt;                0          &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3          &lt;NA&gt;                0          &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4          &lt;NA&gt;                0          &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5          &lt;NA&gt;                0          &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6          &lt;NA&gt;                0          &lt;NA&gt;</span></span>
<span><span class="co">#&gt;        kommentar_250m2_flate klokkeslett_slutt</span></span>
<span><span class="co">#&gt; 1          litt nakent berg              13:33</span></span>
<span><span class="co">#&gt; 2                       &lt;NA&gt;             15:45</span></span>
<span><span class="co">#&gt; 3                       &lt;NA&gt;             15:17</span></span>
<span><span class="co">#&gt; 4                       &lt;NA&gt;             14:12</span></span>
<span><span class="co">#&gt; 5 en bekk går gjennom flaten             12:19</span></span>
<span><span class="co">#&gt; 6                       &lt;NA&gt;             15:50</span></span>
<span><span class="co">#&gt;                                                                                             vedlegg_url</span></span>
<span><span class="co">#&gt; 1 https://nin-felles-test.miljodirektoratet.no/api/Overvaking/list/36bae83e-f412-4c90-8b56-de6b4225bb17</span></span>
<span><span class="co">#&gt; 2 https://nin-felles-test.miljodirektoratet.no/api/Overvaking/list/662b047a-411b-42f1-8f2f-e24602cbf350</span></span>
<span><span class="co">#&gt; 3 https://nin-felles-test.miljodirektoratet.no/api/Overvaking/list/f003e630-94cd-4fff-839b-772299bf697a</span></span>
<span><span class="co">#&gt; 4 https://nin-felles-test.miljodirektoratet.no/api/Overvaking/list/f8239c33-99bd-4eee-85a9-04a10772858d</span></span>
<span><span class="co">#&gt; 5 https://nin-felles-test.miljodirektoratet.no/api/Overvaking/list/95e184f4-9560-4adc-a7a9-75ad9a97d654</span></span>
<span><span class="co">#&gt; 6 https://nin-felles-test.miljodirektoratet.no/api/Overvaking/list/6c11d423-9559-4c61-9036-c1309e0c6328</span></span>
<span><span class="co">#&gt;                    creator        creationdate</span></span>
<span><span class="co">#&gt; 1 chrpot_miljodirektoratet 2019-09-09 10:54:17</span></span>
<span><span class="co">#&gt; 2 chrpot_miljodirektoratet 2019-09-09 10:56:19</span></span>
<span><span class="co">#&gt; 3 chrpot_miljodirektoratet 2019-09-09 10:57:21</span></span>
<span><span class="co">#&gt; 4 chrpot_miljodirektoratet 2019-09-09 10:58:29</span></span>
<span><span class="co">#&gt; 5 chrpot_miljodirektoratet 2019-09-09 10:59:26</span></span>
<span><span class="co">#&gt; 6 chrpot_miljodirektoratet 2019-09-09 10:59:58</span></span>
<span><span class="co">#&gt;                     editor            editdate</span></span>
<span><span class="co">#&gt; 1 chrpot_miljodirektoratet 2019-09-09 10:54:17</span></span>
<span><span class="co">#&gt; 2 chrpot_miljodirektoratet 2019-09-09 10:56:19</span></span>
<span><span class="co">#&gt; 3 chrpot_miljodirektoratet 2019-09-09 10:57:21</span></span>
<span><span class="co">#&gt; 4 chrpot_miljodirektoratet 2019-09-09 10:58:29</span></span>
<span><span class="co">#&gt; 5 chrpot_miljodirektoratet 2019-09-09 10:59:26</span></span>
<span><span class="co">#&gt; 6 chrpot_miljodirektoratet 2019-09-09 10:59:58</span></span>
<span><span class="co">#&gt;   hovedtype_rute    Light1    Light2    Moist1    Moist2</span></span>
<span><span class="co">#&gt; 1             V1        NA 0.8862960        NA 0.5304041</span></span>
<span><span class="co">#&gt; 2             V1 0.5888900        NA        NA 0.9309185</span></span>
<span><span class="co">#&gt; 3             V1 0.5834686        NA 0.6960238        NA</span></span>
<span><span class="co">#&gt; 4             V1        NA 0.9386198        NA 0.8013800</span></span>
<span><span class="co">#&gt; 5             V1 0.7360043        NA 0.6614711        NA</span></span>
<span><span class="co">#&gt; 6             V1        NA 0.9581721        NA 0.8824488</span></span>
<span><span class="co">#&gt;         pH1       pH2 Nitrogen1 Nitrogen2</span></span>
<span><span class="co">#&gt; 1 0.7102018        NA        NA 0.8024127</span></span>
<span><span class="co">#&gt; 2        NA 0.9748303        NA 0.6355716</span></span>
<span><span class="co">#&gt; 3        NA 0.8994699        NA 0.6743312</span></span>
<span><span class="co">#&gt; 4        NA 0.5594912        NA 0.5791890</span></span>
<span><span class="co">#&gt; 5 0.9750870        NA        NA 0.8390342</span></span>
<span><span class="co">#&gt; 6        NA 0.8547261        NA 0.9476639</span></span></code></pre></div>
</div>
</div>
<div id="scaled-value-analyses" class="section level4" number="4.7.1.2">
<h4>
<span class="header-section-number">4.7.1.2</span> Scaled value analyses<a class="anchor" aria-label="anchor" href="#scaled-value-analyses"><i class="fas fa-link"></i></a>
</h4>
<p>In order to visualize the results we need to rearrange the results-objects from wide to long format (note that there is both a lower and an upper condition indicator for each of the functional plant indicators).</p>
<div class="sourceCode" id="cb199"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#### plotting scaled values by main ecosystem type ####</span></span>
<span><span class="co">## continuing with 2-sided</span></span>
<span><span class="va">res.wetland</span> <span class="op">&lt;-</span> <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'2-sided'</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># make long version of the scaled value part</span></span>
<span><span class="va">res.wetland</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">res.wetland</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Light1"</span>,<span class="st">"Light2"</span>,<span class="st">"Moist1"</span>,<span class="st">"Moist2"</span>,<span class="st">"pH1"</span>,<span class="st">"pH2"</span>,<span class="st">"Nitrogen1"</span>,<span class="st">"Nitrogen2"</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"fp_ind"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"scaled_value"</span>,</span>
<span>    values_drop_na <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># add original values as well</span></span>
<span><span class="va">res.wetland</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">res.wetland</span> <span class="op">%&gt;%</span> <span class="fu">add_column</span><span class="op">(</span>original <span class="op">=</span> <span class="va">results.wetland</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span> <span class="op">%&gt;%</span> </span>
<span>                               <span class="fu">pivot_longer</span><span class="op">(</span></span>
<span>                                 cols <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Light1"</span>,<span class="st">"Light2"</span>,<span class="st">"Moist1"</span>,<span class="st">"Moist2"</span>,<span class="st">"pH1"</span>,<span class="st">"pH2"</span>,<span class="st">"Nitrogen1"</span>,<span class="st">"Nitrogen2"</span><span class="op">)</span>,</span>
<span>                                 names_to <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                                 values_to <span class="op">=</span> <span class="st">"original"</span>,</span>
<span>                                 values_drop_na <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>                               <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>                               <span class="fu">pull</span><span class="op">(</span><span class="va">original</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="ecosystem-sub-types" class="section level3" number="4.7.2">
<h3>
<span class="header-section-number">4.7.2</span> Ecosystem sub-types<a class="anchor" aria-label="anchor" href="#ecosystem-sub-types"><i class="fas fa-link"></i></a>
</h3>
<div class="inline-figure">And we can show the resulting scaled values as Violin plots for each indicator and main ecosystem type
<img src="functional_plant_indicators_wetland_files/figure-html/unnamed-chunk-20-1.png" width="672">
The functional signature from the plant communities in wetland ecosystems looks largely good, except for V2 (swamp forests), which show rather low index scores for the lower pH and Nitrogen indicators, i.e. suggesting too acidic conditions and too low nitrogen availability.</div>
<p>We can look at V2 specifically to see if this is the case for all sub-types.</p>
<div class="sourceCode" id="cb200"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># making the plot for V2 only</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">hovedtype_rute</span><span class="op">==</span><span class="st">"V2"</span>,<span class="op">]</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">kartleggingsenhet_1m2</span><span class="op">)</span>, y<span class="op">=</span><span class="va">scaled_value</span>, fill<span class="op">=</span><span class="va">fp_ind</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">0.6</span>, linetype<span class="op">=</span><span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#  geom_boxplot(width=0.2, color="grey") +</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size<span class="op">=</span><span class="fl">0.7</span>, shape<span class="op">=</span><span class="fl">16</span>, color<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">fp_ind</span>,levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Light1"</span>,<span class="st">"Moist1"</span>,<span class="st">"pH1"</span>,<span class="st">"Nitrogen1"</span>,<span class="st">"Light2"</span>,<span class="st">"Moist2"</span>,<span class="st">"pH2"</span>,<span class="st">"Nitrogen2"</span><span class="op">)</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Main ecosystem type"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Scaled indicator value"</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Warning: Removed 556 rows containing non-finite values</span></span>
<span><span class="co">#&gt; (`stat_ydensity()`).</span></span>
<span><span class="co">#&gt; Warning: Groups with fewer than two data points have been dropped.</span></span>
<span><span class="co">#&gt; Groups with fewer than two data points have been dropped.</span></span>
<span><span class="co">#&gt; Warning: Removed 556 rows containing missing values</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<div class="inline-figure">
<img src="functional_plant_indicators_wetland_files/figure-html/unnamed-chunk-21-1.png" width="672">
The deviations towards low pH and low nitrogen are mainly an issue for V2-C1, limestone-poor swamp forests.</div>
</div>
<div id="indicator-index-maps" class="section level3" number="4.7.3">
<h3>
<span class="header-section-number">4.7.3</span> Indicator index maps<a class="anchor" aria-label="anchor" href="#indicator-index-maps"><i class="fas fa-link"></i></a>
</h3>
<p>We can also show the results as a map, for instance for pH1 (the lower pH indicator), either by directly plotting the data onto the map…</p>
<pre><code>#&gt; Reading layer `outlineOfNorway_EPSG25833' from data source 
#&gt;   `/data/scratch/Matt_bookdown__debug/ecosystemCondition/data/outlineOfNorway_EPSG25833.shp' 
#&gt;   using driver `ESRI Shapefile'
#&gt; Simple feature collection with 1 feature and 2 fields
#&gt; Geometry type: MULTIPOLYGON
#&gt; Dimension:     XY
#&gt; Bounding box:  xmin: -113472.7 ymin: 6448359 xmax: 1114618 ymax: 7939917
#&gt; Projected CRS: ETRS89 / UTM zone 33N
#&gt; Reading layer `regions' from data source 
#&gt;   `/data/scratch/Matt_bookdown__debug/ecosystemCondition/data/regions.shp' 
#&gt;   using driver `ESRI Shapefile'
#&gt; Simple feature collection with 5 features and 2 fields
#&gt; Geometry type: POLYGON
#&gt; Dimension:     XY
#&gt; Bounding box:  xmin: -99551.21 ymin: 6426048 xmax: 1121941 ymax: 7962744
#&gt; Projected CRS: ETRS89 / UTM zone 33N
#&gt; [1] "Nord-Norge"      "Midt-Norge"      "Ã\u0098stlandet"
#&gt; [4] "Vestlandet"      "SÃ¸rlandet"</code></pre>
<div class="inline-figure">
<img src="functional_plant_indicators_wetland_files/figure-html/unnamed-chunk-22-1.png" width="672">
…but here the colors and values of the data points on the map are hard to make out.</div>
</div>
<div id="regions---maps-and-statistics" class="section level3" number="4.7.4">
<h3>
<span class="header-section-number">4.7.4</span> Regions - maps and statistics<a class="anchor" aria-label="anchor" href="#regions---maps-and-statistics"><i class="fas fa-link"></i></a>
</h3>
<p>Alternatively we can calculate and show the region-wise means and their related standard errors. But note that calculating a simple mean would be inappropriate for these data. This is because:
(i) the scaled data are bound between 0 and 1, and thus follow a beta-distribution rather than a Gaussian one
(ii) the ANO dataset has a nested structure</p>
<p>Therefore, we need to (i) use a beta-model, that (ii) can account for the nested structure of the data.
Here, we apply the following function using either a glmmTMB null-model with a beta-distribution, logit link, and the nesting as a random intercept, or a simple betareg null-model with logit link if the nesting is not extensive enough for a mixed model.</p>
<div class="sourceCode" id="cb202"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">betareg</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/glmmTMB/glmmTMB">glmmTMB</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">expit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">L</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">L</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">L</span><span class="op">)</span><span class="op">)</span> <span class="co"># since the beta-models use a logit link, we need to calculate the estimates back to the identity scale</span></span>
<span></span>
<span><span class="co"># the function performs a glmmTMB if there's &gt;= 5 random levels in the nesting structure</span></span>
<span><span class="co"># if that is not the case, then the function performs a betareg if theres &gt;= 2 observations</span></span>
<span><span class="co"># if that is not the case either, then the function returns the value of the single observation with NA standard error</span></span>
<span></span>
<span><span class="va">indmean.beta</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="fu">st_geometry</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y"</span>,<span class="st">"ran"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">2</span> <span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="kw">if</span> <span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;=</span><span class="fl">5</span> <span class="op">)</span> <span class="op">{</span></span>
<span>      </span>
<span>      <span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/glmmTMB.html">glmmTMB</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">ran</span><span class="op">)</span>, family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/glmmTMB/man/nbinom2.html">beta_family</a></span><span class="op">(</span><span class="op">)</span>, data<span class="op">=</span><span class="va">df</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>        <span class="fu">expit</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span> <span class="va">mod1</span> <span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">cond</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>        </span>
<span>        <span class="fu">expit</span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span> <span class="va">mod1</span> <span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">cond</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> </span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span> <span class="va">mod1</span> <span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">cond</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">)</span><span class="op">-</span></span>
<span>          <span class="fu">expit</span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span> <span class="va">mod1</span> <span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">cond</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span>,</span>
<span>        </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span> <span class="va">mod1</span> <span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">cond</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span> <span class="va">mod1</span> <span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">cond</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>      <span class="op">)</span><span class="op">)</span></span>
<span>      </span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      </span>
<span>      <span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/betareg/man/betareg.html">betareg</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, data<span class="op">=</span><span class="va">df</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>        <span class="fu">expit</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span> <span class="va">mod2</span> <span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>        <span class="fu">expit</span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span> <span class="va">mod2</span> <span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> </span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span> <span class="va">mod2</span> <span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">)</span><span class="op">-</span></span>
<span>          <span class="fu">expit</span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span> <span class="va">mod2</span> <span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span> <span class="va">mod2</span> <span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span> <span class="va">mod2</span> <span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>      <span class="op">)</span><span class="op">)</span></span>
<span>      </span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">y</span>,<span class="cn">NA</span>,<span class="fl">1</span>,<span class="cn">NA</span>,<span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="op">}</span></span>
<span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb203"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">res.wetland2</span> <span class="op">=</span> <span class="fu">st_join</span><span class="op">(</span><span class="va">res.wetland2</span>, <span class="va">regnor</span>, left <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">regnor</span> <span class="op">&lt;-</span> <span class="va">regnor</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    pH1.reg.mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu">indmean.beta</span><span class="op">(</span>df<span class="op">=</span><span class="va">res.wetland2</span><span class="op">[</span><span class="va">res.wetland2</span><span class="op">$</span><span class="va">region</span><span class="op">==</span><span class="st">"Northern Norway"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pH1"</span>,<span class="st">"ano_flate_id"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                                 <span class="fu">indmean.beta</span><span class="op">(</span>df<span class="op">=</span><span class="va">res.wetland2</span><span class="op">[</span><span class="va">res.wetland2</span><span class="op">$</span><span class="va">region</span><span class="op">==</span><span class="st">"Central Norway"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pH1"</span>,<span class="st">"ano_flate_id"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                                 <span class="fu">indmean.beta</span><span class="op">(</span>df<span class="op">=</span><span class="va">res.wetland2</span><span class="op">[</span><span class="va">res.wetland2</span><span class="op">$</span><span class="va">region</span><span class="op">==</span><span class="st">"Eastern Norway"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pH1"</span>,<span class="st">"ano_flate_id"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                                 <span class="fu">indmean.beta</span><span class="op">(</span>df<span class="op">=</span><span class="va">res.wetland2</span><span class="op">[</span><span class="va">res.wetland2</span><span class="op">$</span><span class="va">region</span><span class="op">==</span><span class="st">"Western Norway"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pH1"</span>,<span class="st">"ano_flate_id"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                                 <span class="fu">indmean.beta</span><span class="op">(</span>df<span class="op">=</span><span class="va">res.wetland2</span><span class="op">[</span><span class="va">res.wetland2</span><span class="op">$</span><span class="va">region</span><span class="op">==</span><span class="st">"Southern Norway"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pH1"</span>,<span class="st">"ano_flate_id"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="op">)</span>,</span>
<span>    pH1.reg.se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu">indmean.beta</span><span class="op">(</span>df<span class="op">=</span><span class="va">res.wetland2</span><span class="op">[</span><span class="va">res.wetland2</span><span class="op">$</span><span class="va">region</span><span class="op">==</span><span class="st">"Northern Norway"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pH1"</span>,<span class="st">"ano_flate_id"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>                               <span class="fu">indmean.beta</span><span class="op">(</span>df<span class="op">=</span><span class="va">res.wetland2</span><span class="op">[</span><span class="va">res.wetland2</span><span class="op">$</span><span class="va">region</span><span class="op">==</span><span class="st">"Central Norway"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pH1"</span>,<span class="st">"ano_flate_id"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>                               <span class="fu">indmean.beta</span><span class="op">(</span>df<span class="op">=</span><span class="va">res.wetland2</span><span class="op">[</span><span class="va">res.wetland2</span><span class="op">$</span><span class="va">region</span><span class="op">==</span><span class="st">"Eastern Norway"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pH1"</span>,<span class="st">"ano_flate_id"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>                               <span class="fu">indmean.beta</span><span class="op">(</span>df<span class="op">=</span><span class="va">res.wetland2</span><span class="op">[</span><span class="va">res.wetland2</span><span class="op">$</span><span class="va">region</span><span class="op">==</span><span class="st">"Western Norway"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pH1"</span>,<span class="st">"ano_flate_id"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>                               <span class="fu">indmean.beta</span><span class="op">(</span>df<span class="op">=</span><span class="va">res.wetland2</span><span class="op">[</span><span class="va">res.wetland2</span><span class="op">$</span><span class="va">region</span><span class="op">==</span><span class="st">"Southern Norway"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pH1"</span>,<span class="st">"ano_flate_id"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>    <span class="op">)</span>,</span>
<span>    pH1.reg.n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">res.wetland2</span><span class="op">[</span><span class="va">res.wetland2</span><span class="op">$</span><span class="va">region</span><span class="op">==</span><span class="st">"Northern Norway"</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">res.wetland2</span><span class="op">$</span><span class="va">pH1</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span>,</span>
<span>                              <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">res.wetland2</span><span class="op">[</span><span class="va">res.wetland2</span><span class="op">$</span><span class="va">region</span><span class="op">==</span><span class="st">"Central Norway"</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">res.wetland2</span><span class="op">$</span><span class="va">pH1</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span>,</span>
<span>                              <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">res.wetland2</span><span class="op">[</span><span class="va">res.wetland2</span><span class="op">$</span><span class="va">region</span><span class="op">==</span><span class="st">"Eastern Norway"</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">res.wetland2</span><span class="op">$</span><span class="va">pH1</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span>,</span>
<span>                              <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">res.wetland2</span><span class="op">[</span><span class="va">res.wetland2</span><span class="op">$</span><span class="va">region</span><span class="op">==</span><span class="st">"Western Norway"</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">res.wetland2</span><span class="op">$</span><span class="va">pH1</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span>,</span>
<span>                              <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">res.wetland2</span><span class="op">[</span><span class="va">res.wetland2</span><span class="op">$</span><span class="va">region</span><span class="op">==</span><span class="st">"Southern Norway"</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">res.wetland2</span><span class="op">$</span><span class="va">pH1</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## scaled value maps for pH1 (lower indicator)</span></span>
<span><span class="co"># mean</span></span>
<span><span class="fu">tm_shape</span><span class="op">(</span><span class="va">regnor</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_polygons</span><span class="op">(</span>col<span class="op">=</span><span class="st">"pH1.reg.mean"</span>, title<span class="op">=</span><span class="st">"pH (lower), mean"</span>, style<span class="op">=</span><span class="st">"quantile"</span>, palette<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu">get_brewer_pal</span><span class="op">(</span>palette<span class="op">=</span><span class="st">"OrRd"</span>, n<span class="op">=</span><span class="fl">5</span>, plot<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_text</span><span class="op">(</span><span class="st">"pH1.reg.n"</span>,col<span class="op">=</span><span class="st">"black"</span>,bg.color<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure">
<img src="functional_plant_indicators_wetland_files/figure-html/unnamed-chunk-24-1.png" width="672">
Mean index value by region for the lower pH indicator (i.e. index shows deviations towards a more acidic environment). Numbers in grey fields show the number of observations in the respective region.</div>
<div class="sourceCode" id="cb204"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># se</span></span>
<span><span class="fu">tm_shape</span><span class="op">(</span><span class="va">regnor</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_polygons</span><span class="op">(</span>col<span class="op">=</span><span class="st">"pH1.reg.se"</span>, title<span class="op">=</span><span class="st">"pH (lower), sd"</span>, style<span class="op">=</span><span class="st">"quantile"</span>, palette<span class="op">=</span><span class="fu">get_brewer_pal</span><span class="op">(</span>palette<span class="op">=</span><span class="st">"OrRd"</span>, n<span class="op">=</span><span class="fl">5</span>, plot<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_text</span><span class="op">(</span><span class="st">"pH1.reg.n"</span>,col<span class="op">=</span><span class="st">"black"</span>,bg.color<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure">
<img src="functional_plant_indicators_wetland_files/figure-html/unnamed-chunk-25-1.png" width="672">
Standard error to the mean index value by region for the lower pH indicator. Numbers in grey fields show the number of observations in the respective region.</div>
</div>
<div id="unscaled-values-vs.-reference" class="section level3" number="4.7.5">
<h3>
<span class="header-section-number">4.7.5</span> unscaled values vs. reference<a class="anchor" aria-label="anchor" href="#unscaled-values-vs.-reference"><i class="fas fa-link"></i></a>
</h3>
<p>We can also compare the unscaled values to the reference distribution in order to identify ecosystem types and functional plant indicators showing a deviation from the expectation. Since pH and nitrogen show some deviation of the lower pH indicator we exemplify this with these indicators for unscaled values.</p>
<div class="sourceCode" id="cb205"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">)</span></span>
<span><span class="co">#&gt;      V1  V1-C-1  V1-C-2  V1-C-3  V1-C-4  V1-C-5  V1-C-6 </span></span>
<span><span class="co">#&gt;       8    2144    1224     448     160    2424    1248 </span></span>
<span><span class="co">#&gt;  V1-C-7  V1-C-8 V10-C-1 V10-C-3 V11-C-1     V12 V12-C-1 </span></span>
<span><span class="co">#&gt;     320      48      40       8      16      16     152 </span></span>
<span><span class="co">#&gt; V12-C-2      V2  V2-C-1  V2-C-2  V2-C-3      V3  V3-C-1 </span></span>
<span><span class="co">#&gt;       8       8     832     224      32      40     440 </span></span>
<span><span class="co">#&gt;  V3-C-2      V4  V4-C-1  V4-C-2  V4-C-4  V6-C-1  V6-C-2 </span></span>
<span><span class="co">#&gt;     472       8      32      72       8      64       8 </span></span>
<span><span class="co">#&gt;  V6-C-3  V6-C-4  V6-C-5  V6-C-7  V6-C-9  V8-C-1  V8-C-2 </span></span>
<span><span class="co">#&gt;      72      40       8       8       8      16       8 </span></span>
<span><span class="co">#&gt;  V9-C-1  V9-C-2  V9-C-3 </span></span>
<span><span class="co">#&gt;      80      16      16</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 38</span></span>
<span><span class="co"># 16 NiN-types to plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Soil_reaction_pH'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "V3-C1a" "V3-C1b" "V3-C1c" "V3-C1d" "V3-C1e" "V1-C1a"</span></span>
<span><span class="co">#&gt;  [7] "V1-C1b" "V1-C1c" "V1-C1d" "V1-C1e" "V1-C2a" "V1-C2b"</span></span>
<span><span class="co">#&gt; [13] "V1-C2c" "V1-C2d" "V1-C3a" "V1-C3b" "V1-C3c" "V1-C3d"</span></span>
<span><span class="co">#&gt; [19] "V1-C4a" "V1-C4b" "V1-C4c" "V1-C4d" "V1-C4e" "V1-C4f"</span></span>
<span><span class="co">#&gt; [25] "V1-C4g" "V1-C4h" "V3-C2"  "V1-C5"  "V1-C6a" "V1-C6b"</span></span>
<span><span class="co">#&gt; [31] "V1-C7a" "V1-C7b" "V1-C8a" "V1-C8b" "V2-C1a" "V2-C1b"</span></span>
<span><span class="co">#&gt; [37] "V2-C2a" "V2-C2b" "V2-C3a" "V2-C3b" "V4-C2"  "V4-C3" </span></span>
<span><span class="co">#&gt; [43] "V8-C1"  "V8-C2"  "V8-C3"</span></span>
<span></span>
<span><span class="co">### pH</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## V1s</span></span>
<span><span class="co"># V1-C-1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Soil_reaction_pH'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V1-C1a"</span>,<span class="st">"V1-C1b"</span>,<span class="st">"V1-C1c"</span>,<span class="st">"V1-C1d"</span>,<span class="st">"V1-C1e"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V1-C1'</span>,xlab<span class="op">=</span><span class="st">'pH value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-1"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>       type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-1"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-1"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># V1-C-2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Soil_reaction_pH'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V1-C2a"</span>,<span class="st">"V1-C2b"</span>,<span class="st">"V1-C2c"</span>,<span class="st">"V1-C2d"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V1-C2'</span>,xlab<span class="op">=</span><span class="st">'pH value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-2"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>       type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-2"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-2"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># V1-C-3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Soil_reaction_pH'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V1-C3a"</span>,<span class="st">"V1-C3b"</span>,<span class="st">"V1-C3c"</span>,<span class="st">"V1-C3d"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V1-C3'</span>,xlab<span class="op">=</span><span class="st">'pH value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-3"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>       type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-3"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-3"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># V1-C-4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Soil_reaction_pH'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V1-C4a"</span>,<span class="st">"V1-C4b"</span>,<span class="st">"V1-C4c"</span>,<span class="st">"V1-C4d"</span>,<span class="st">"V1-C4e"</span>,<span class="st">"V1-C4f"</span>,<span class="st">"V1-C4g"</span>,<span class="st">"V1-C4h"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V1-C4'</span>,xlab<span class="op">=</span><span class="st">'pH value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-4"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>       type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-4"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-4"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># V1-C-5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Soil_reaction_pH'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V1-C5"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V1-C5'</span>,xlab<span class="op">=</span><span class="st">'pH value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-5"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>       type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-5"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-5"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># V1-C-6</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Soil_reaction_pH'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V1-C6a"</span>,<span class="st">"V1-C6b"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V1-C6'</span>,xlab<span class="op">=</span><span class="st">'pH value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-6"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>       type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-6"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-6"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># V1-C-7</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Soil_reaction_pH'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V1-C7a"</span>,<span class="st">"V1-C7b"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V1-C7'</span>,xlab<span class="op">=</span><span class="st">'pH value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-7"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>       type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-7"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-7"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># V1-C-8</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Soil_reaction_pH'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V1-C8a"</span>,<span class="st">"V1-C8b"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V1-C8'</span>,xlab<span class="op">=</span><span class="st">'pH value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-8"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>       type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-8"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-8"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="functional_plant_indicators_wetland_files/figure-html/unnamed-chunk-26-1.png" width="672"></div>
<div class="sourceCode" id="cb206"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## V2s</span></span>
<span><span class="co"># V2-C-1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Soil_reaction_pH'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V2-C1a"</span>,<span class="st">"V2-C1b"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V2-C1'</span>,xlab<span class="op">=</span><span class="st">'pH value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V2-C-1"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>       type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V2-C-1"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V2-C-1"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># V2-C-2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Soil_reaction_pH'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V2-C2a"</span>,<span class="st">"V2-C2b"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V2-C2'</span>,xlab<span class="op">=</span><span class="st">'pH value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V2-C-2"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>       type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V2-C-2"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V2-C-2"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># V2-C-3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Soil_reaction_pH'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V2-C3a"</span>,<span class="st">"V2-C3b"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V2-C3'</span>,xlab<span class="op">=</span><span class="st">'pH value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V2-C-3"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>       type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V2-C-3"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V2-C-3"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## V3s</span></span>
<span><span class="co"># V3-C-1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Soil_reaction_pH'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V3-C1a"</span>,<span class="st">"V3-C1b"</span>,<span class="st">"V3-C1c"</span>,<span class="st">"V3-C1d"</span>,<span class="st">"V3-C1e"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V3-C1'</span>,xlab<span class="op">=</span><span class="st">'pH value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V3-C-1"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>       type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V3-C-1"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V3-C-1"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># V3-C-2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Soil_reaction_pH'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V3-C2"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V3-C2'</span>,xlab<span class="op">=</span><span class="st">'pH value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V3-C-2"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>       type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V3-C-2"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V3-C-2"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## V4s</span></span>
<span><span class="co"># V4-C-2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Soil_reaction_pH'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V4-C2"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V4-C2'</span>,xlab<span class="op">=</span><span class="st">'pH value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V4-C-2"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>       type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V4-C-2"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V4-C-2"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## V8s</span></span>
<span><span class="co"># V8-C-1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Soil_reaction_pH'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V8-C1"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V8-C1'</span>,xlab<span class="op">=</span><span class="st">'pH value'</span><span class="op">)</span></span>
<span><span class="co">#points(density(res.wetland[res.wetland$fp_ind=="pH1" &amp; res.wetland$fp_ind=="pH1" &amp; res.wetland$kartleggingsenhet_1m2=="V8-C-1",]$original,na.rm=T),</span></span>
<span><span class="co">#       type="l", col="red")</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V8-C-1"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V8-C-1"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># V8-C-2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Soil_reaction_pH'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V8-C2"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V8-C2'</span>,xlab<span class="op">=</span><span class="st">'pH value'</span><span class="op">)</span></span>
<span><span class="co">#points(density(res.wetland[res.wetland$fp_ind=="pH1" &amp; res.wetland$fp_ind=="pH1" &amp; res.wetland$kartleggingsenhet_1m2=="V8-C-2",]$original,na.rm=T),</span></span>
<span><span class="co">#       type="l", col="red")</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V8-C-2"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"pH1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V8-C-2"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"reference"</span>,<span class="st">"field data"</span><span class="op">)</span>, pch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">1</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">1</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="functional_plant_indicators_wetland_files/figure-html/unnamed-chunk-26-2.png" width="672"></div>
<div class="sourceCode" id="cb207"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co">### Nitrogen</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## V1s</span></span>
<span><span class="co"># V1-C-1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Nitrogen'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V1-C1a"</span>,<span class="st">"V1-C1b"</span>,<span class="st">"V1-C1c"</span>,<span class="st">"V1-C1d"</span>,<span class="st">"V1-C1e"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V1-C1'</span>,xlab<span class="op">=</span><span class="st">'Nitrogen value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-1"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>       type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-1"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-1"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># V1-C-2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Nitrogen'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V1-C2a"</span>,<span class="st">"V1-C2b"</span>,<span class="st">"V1-C2c"</span>,<span class="st">"V1-C2d"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V1-C2'</span>,xlab<span class="op">=</span><span class="st">'Nitrogen value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-2"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>       type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-2"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-2"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># V1-C-3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Nitrogen'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V1-C3a"</span>,<span class="st">"V1-C3b"</span>,<span class="st">"V1-C3c"</span>,<span class="st">"V1-C3d"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V1-C3'</span>,xlab<span class="op">=</span><span class="st">'Nitrogen value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-3"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>       type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-3"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-3"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># V1-C-4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Nitrogen'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V1-C4a"</span>,<span class="st">"V1-C4b"</span>,<span class="st">"V1-C4c"</span>,<span class="st">"V1-C4d"</span>,<span class="st">"V1-C4e"</span>,<span class="st">"V1-C4f"</span>,<span class="st">"V1-C4g"</span>,<span class="st">"V1-C4h"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V1-C4'</span>,xlab<span class="op">=</span><span class="st">'Nitrogen value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-4"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>       type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-4"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-4"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># V1-C-5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Nitrogen'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V1-C5"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V1-C5'</span>,xlab<span class="op">=</span><span class="st">'Nitrogen value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-5"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>       type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-5"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-5"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># V1-C-6</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Nitrogen'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V1-C6a"</span>,<span class="st">"V1-C6b"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V1-C6'</span>,xlab<span class="op">=</span><span class="st">'Nitrogen value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-6"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>       type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-6"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-6"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># V1-C-7</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Nitrogen'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V1-C7a"</span>,<span class="st">"V1-C7b"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V1-C7'</span>,xlab<span class="op">=</span><span class="st">'Nitrogen value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-7"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>       type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-7"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-7"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># V1-C-8</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Nitrogen'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V1-C8a"</span>,<span class="st">"V1-C8b"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V1-C8'</span>,xlab<span class="op">=</span><span class="st">'Nitrogen value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-8"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>       type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-8"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V1-C-8"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="functional_plant_indicators_wetland_files/figure-html/unnamed-chunk-26-3.png" width="672"></div>
<div class="sourceCode" id="cb208"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## V2s</span></span>
<span><span class="co"># V2-C-1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Nitrogen'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V2-C1a"</span>,<span class="st">"V2-C1b"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V2-C1'</span>,xlab<span class="op">=</span><span class="st">'Nitrogen value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V2-C-1"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>       type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V2-C-1"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V2-C-1"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># V2-C-2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Nitrogen'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V2-C2a"</span>,<span class="st">"V2-C2b"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V2-C2'</span>,xlab<span class="op">=</span><span class="st">'Nitrogen value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V2-C-2"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>       type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V2-C-2"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V2-C-2"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># V2-C-3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Nitrogen'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V2-C3a"</span>,<span class="st">"V2-C3b"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V2-C3'</span>,xlab<span class="op">=</span><span class="st">'Nitrogen value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V2-C-3"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>       type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V2-C-3"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V2-C-3"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## V3s</span></span>
<span><span class="co"># V3-C-1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Nitrogen'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V3-C1a"</span>,<span class="st">"V3-C1b"</span>,<span class="st">"V3-C1c"</span>,<span class="st">"V3-C1d"</span>,<span class="st">"V3-C1e"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V3-C1'</span>,xlab<span class="op">=</span><span class="st">'Nitrogen value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V3-C-1"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>       type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V3-C-1"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V3-C-1"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># V3-C-2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Nitrogen'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V3-C2"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V3-C2'</span>,xlab<span class="op">=</span><span class="st">'Nitrogen value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V3-C-2"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>       type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V3-C-2"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V3-C-2"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## V4s</span></span>
<span><span class="co"># V4-C-2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Nitrogen'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V4-C2"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V4-C2'</span>,xlab<span class="op">=</span><span class="st">'Nitrogen value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V4-C-2"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>       type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V4-C-2"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V4-C-2"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## V8s</span></span>
<span><span class="co"># V8-C-1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Nitrogen'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V8-C1"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V8-C1'</span>,xlab<span class="op">=</span><span class="st">'Nitrogen value'</span><span class="op">)</span></span>
<span><span class="co">#points(density(res.wetland[res.wetland$fp_ind=="Nitrogen1" &amp; res.wetland$fp_ind=="Nitrogen1" &amp; res.wetland$kartleggingsenhet_1m2=="V8-C-1",]$original,na.rm=T),</span></span>
<span><span class="co">#       type="l", col="red")</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V8-C-1"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V8-C-1"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># V8-C-2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wetland.ref.cov</span><span class="op">[[</span><span class="st">'Nitrogen'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V8-C2"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> ,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, main<span class="op">=</span><span class="st">'V8-C2'</span>,xlab<span class="op">=</span><span class="st">'Nitrogen value'</span><span class="op">)</span></span>
<span><span class="co">#points(density(res.wetland[res.wetland$fp_ind=="Nitrogen1" &amp; res.wetland$fp_ind=="Nitrogen1" &amp; res.wetland$kartleggingsenhet_1m2=="V8-C-2",]$original,na.rm=T),</span></span>
<span><span class="co">#       type="l", col="red")</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V8-C-2"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">res.wetland</span><span class="op">[</span><span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">fp_ind</span><span class="op">==</span><span class="st">"Nitrogen1"</span> <span class="op">&amp;</span> <span class="va">res.wetland</span><span class="op">$</span><span class="va">kartleggingsenhet_1m2</span><span class="op">==</span><span class="st">"V8-C-2"</span>,<span class="op">]</span><span class="op">$</span><span class="va">original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"reference"</span>,<span class="st">"field data"</span><span class="op">)</span>, pch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">1</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">1</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure">
<img src="functional_plant_indicators_wetland_files/figure-html/unnamed-chunk-26-4.png" width="672">
THe figure shows that deviations mainly occur in V2-C1, which represents limestone-poor swamp forests. According to the functional signature from the plant community composition many of the occurrences of this ecosystem type are too acidic and may have too low availability of nitrogen.</div>
</div>
<div id="eksport-file-final-product" class="section level3" number="4.7.6">
<h3>
<span class="header-section-number">4.7.6</span> Eksport file (final product)<a class="anchor" aria-label="anchor" href="#eksport-file-final-product"><i class="fas fa-link"></i></a>
</h3>
<!-- Export final file. Ideally a georeferenced shape or raster wit indicators values (raw and normalised), reference values and errors. -->

</div>
</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="alien-species.html"><span class="header-section-number">3</span> Alien species</a></div>
<div class="next"><a href="areal-av-isbreer.html"><span class="header-section-number">5</span> Areal av isbreer</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#Functional-plant-indicators-wetland"><span class="header-section-number">4</span> Functional plant indicators, wetland ecosystems (Moisture, Light, pH, Nitrogen)</a></li>
<li><a class="nav-link" href="#introduction-3"><span class="header-section-number">4.1</span> Introduction</a></li>
<li>
<a class="nav-link" href="#about-the-underlying-data-3"><span class="header-section-number">4.2</span> About the underlying data</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#representativity-in-time-and-space-3"><span class="header-section-number">4.2.1</span> Representativity in time and space</a></li>
<li><a class="nav-link" href="#temporal-coverage-3"><span class="header-section-number">4.2.2</span> Temporal coverage</a></li>
</ul>
</li>
<li><a class="nav-link" href="#collinearities-with-other-indicators-3"><span class="header-section-number">4.3</span> Collinearities with other indicators</a></li>
<li>
<a class="nav-link" href="#reference-state-and-values"><span class="header-section-number">4.4</span> Reference state and values</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#reference-state"><span class="header-section-number">4.4.1</span> Reference state</a></li>
<li><a class="nav-link" href="#reference-values-thresholds-for-defining-good-ecological-condition-minimum-andor-maximum-values-3"><span class="header-section-number">4.4.2</span> Reference values, thresholds for defining good ecological condition, minimum and/or maximum values</a></li>
</ul>
</li>
<li><a class="nav-link" href="#uncertainties-3"><span class="header-section-number">4.5</span> Uncertainties</a></li>
<li><a class="nav-link" href="#references-3"><span class="header-section-number">4.6</span> References</a></li>
<li>
<a class="nav-link" href="#analyses-3"><span class="header-section-number">4.7</span> Analyses</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#data-sets-2"><span class="header-section-number">4.7.1</span> Data sets</a></li>
<li><a class="nav-link" href="#ecosystem-sub-types"><span class="header-section-number">4.7.2</span> Ecosystem sub-types</a></li>
<li><a class="nav-link" href="#indicator-index-maps"><span class="header-section-number">4.7.3</span> Indicator index maps</a></li>
<li><a class="nav-link" href="#regions---maps-and-statistics"><span class="header-section-number">4.7.4</span> Regions - maps and statistics</a></li>
<li><a class="nav-link" href="#unscaled-values-vs.-reference"><span class="header-section-number">4.7.5</span> unscaled values vs. reference</a></li>
<li><a class="nav-link" href="#eksport-file-final-product"><span class="header-section-number">4.7.6</span> Eksport file (final product)</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/NINAnor/ecosystemCondition/blob/master/functional_plant_indicators_wetland.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/NINAnor/ecosystemCondition/edit/master/functional_plant_indicators_wetland.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Indicators for Ecosystem Condition in Norway</strong>" was written by Anders L. Kolstad. It was last built on 2023-05-29.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
